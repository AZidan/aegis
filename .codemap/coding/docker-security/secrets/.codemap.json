{
  "directory": "coding/docker-security/secrets",
  "files": {
    ".sops.yaml": {
      "hash": "6dd843c30739",
      "indexed_at": "2026-02-05T21:07:47.504845+00:00",
      "language": "yaml",
      "lines": 28,
      "symbols": [
        {
          "children": [
            {
              "docstring": ".*\\.enc$",
              "lines": [
                6,
                6
              ],
              "name": "path_regex",
              "type": "item"
            },
            {
              "docstring": "age1yhhu30v48zpsdenm82dc9s2k7w7zcw3vqktlf9fqxqg0qhrz33kq6e9x4h",
              "lines": [
                7,
                9
              ],
              "name": "age",
              "type": "key"
            },
            {
              "lines": [
                10,
                27
              ],
              "name": "encrypted_regex",
              "type": "multiline"
            },
            {
              "docstring": "_unencrypted",
              "lines": [
                28,
                29
              ],
              "name": "unencrypted_suffix",
              "type": "key"
            }
          ],
          "lines": [
            4,
            29
          ],
          "name": "creation_rules",
          "type": "section"
        }
      ]
    },
    "README.md": {
      "hash": "02e691841cf4",
      "indexed_at": "2026-02-05T21:07:47.503979+00:00",
      "language": "markdown",
      "lines": 262,
      "symbols": [
        {
          "children": [
            {
              "lines": [
                9,
                18
              ],
              "name": "1. Install Prerequisites",
              "type": "subsection"
            },
            {
              "lines": [
                19,
                30
              ],
              "name": "2. Generate Encryption Keys",
              "type": "subsection"
            },
            {
              "lines": [
                31,
                42
              ],
              "name": "3. Encrypt Existing Configs",
              "type": "subsection"
            },
            {
              "lines": [
                43,
                60
              ],
              "name": "4. Test in Isolated Environment",
              "type": "subsection"
            },
            {
              "docstring": "Once validated:",
              "lines": [
                61,
                81
              ],
              "name": "5. Promote to Production",
              "type": "subsection"
            }
          ],
          "lines": [
            7,
            81
          ],
          "name": "Quick Start",
          "type": "section"
        },
        {
          "children": [
            {
              "docstring": "Only sensitive JSON keys are encrypted (the rest stays readable): - `token`, `key`, `password`, `secret` - `apiKey`, `botToken`, `appToken` - `credent",
              "lines": [
                93,
                100
              ],
              "name": "Encrypted Fields",
              "type": "subsection"
            },
            {
              "docstring": "| File | Sensitive Keys | |------|---------------| | `openclaw.json` | `channels.telegram.botToken`, `channels.slack.*.botToken`, etc. | | `auth-profi",
              "lines": [
                101,
                108
              ],
              "name": "File Locations",
              "type": "subsection"
            }
          ],
          "lines": [
            82,
            108
          ],
          "name": "How It Works",
          "type": "section"
        },
        {
          "docstring": "Update `docker-compose.yml`:",
          "lines": [
            109,
            136
          ],
          "name": "Production Configuration",
          "type": "section"
        },
        {
          "docstring": "When you need to rotate encryption keys:",
          "lines": [
            137,
            152
          ],
          "name": "Key Rotation",
          "type": "section"
        },
        {
          "children": [
            {
              "docstring": "Add to `openclaw.json`:",
              "lines": [
                155,
                175
              ],
              "name": "Defense Layer 1: Path Deny List",
              "type": "subsection"
            },
            {
              "docstring": "The `redact-secrets` hook (in `extensions/redact-secrets/`) scans outgoing messages for credential patterns and replaces them with `[REDACTED]`.",
              "lines": [
                176,
                191
              ],
              "name": "Defense Layer 2: Output Filtering",
              "type": "subsection"
            },
            {
              "docstring": "Instead of storing tokens in JSON:",
              "lines": [
                192,
                207
              ],
              "name": "Defense Layer 3: Environment Variable Injection",
              "type": "subsection"
            }
          ],
          "lines": [
            153,
            207
          ],
          "name": "Runtime Security (Prompt Injection Defense)",
          "type": "section"
        },
        {
          "lines": [
            208,
            228
          ],
          "name": "Verification",
          "type": "section"
        },
        {
          "children": [
            {
              "docstring": "Ensure the key file exists and Docker secret is configured:",
              "lines": [
                231,
                237
              ],
              "name": "\"Age key not found\"",
              "type": "subsection"
            },
            {
              "docstring": "The age key might not match the encryption. Check:",
              "lines": [
                238,
                245
              ],
              "name": "\"Failed to decrypt\"",
              "type": "subsection"
            },
            {
              "docstring": "The script asks before deleting. Re-run:",
              "lines": [
                246,
                252
              ],
              "name": "Plaintext files remain after migration",
              "type": "subsection"
            }
          ],
          "lines": [
            229,
            252
          ],
          "name": "Troubleshooting",
          "type": "section"
        },
        {
          "docstring": "- [ ] `secrets/keys/age.key` is NOT in version control - [ ] `.enc` files show encrypted content (not plaintext) - [ ] No plaintext credential files o",
          "lines": [
            253,
            263
          ],
          "name": "Security Audit Checklist",
          "type": "section"
        }
      ]
    }
  },
  "generated_at": "2026-02-08T21:35:43.238288+00:00",
  "version": "1.0"
}