# =============================================================================
# Aegis Platform -- Styled DSL Component Specifications
# =============================================================================
# Complete screen definitions for the Aegis AI Multi-Agent SaaS Platform.
# This file is the single source of truth for all UI screens.
# The UI engineer builds every screen from this specification.
#
# Theme Reference: design-artifacts/theme.yaml
# User Flows Reference: design-artifacts/user-flows.md
# Tech Stack: Next.js 15+ / TypeScript / Tailwind CSS / Radix UI / shadcn
#
# Last Updated: 2026-02-05
# Document Owner: UX Design / DSL Generator
# =============================================================================

meta:
  version: "1.0.0"
  theme_ref: "design-artifacts/theme.yaml"
  total_screens: 21
  categories:
    - id: "platform_admin"
      label: "Platform Admin Dashboard"
      route_prefix: "/admin"
      screens: 8
    - id: "tenant_admin"
      label: "Tenant Admin Dashboard"
      route_prefix: "/dashboard"
      screens: 11
    - id: "auth"
      label: "Auth / Public"
      route_prefix: "/"
      screens: 2

# =============================================================================
# SHARED LAYOUTS
# =============================================================================
# Reusable layout shells applied to multiple screens.
# =============================================================================

layouts:

  sidebar_layout:
    id: "sidebar_layout"
    description: "Primary layout for authenticated dashboard screens. Fixed sidebar with scrollable main content area."
    structure:
      - type: "HStack"
        style:
          width: "100%"
          height: "100vh"
          background: "colors.neutral.25"
        children:
          - type: "sidebar_nav"
            id: "main_sidebar"
            style:
              width: "components.sidebar.width.expanded"
              width_collapsed: "components.sidebar.width.collapsed"
              height: "100vh"
              position: "fixed"
              left: "0"
              top: "0"
              background: "components.sidebar.bg"
              border_right: "components.sidebar.border_right"
              z_index: "z_index.sidebar"
              transition: "animations.presets.sidebar_expand"
              overflow_y: "auto"
            dark_mode:
              background: "dark_mode.components.sidebar.bg"
              border_right: "dark_mode.components.sidebar.border_right"
            responsive:
              md_down:
                position: "fixed"
                transform: "translateX(-100%)"
                width: "components.sidebar.width.expanded"
          - type: "VStack"
            id: "main_content_area"
            style:
              flex: "1"
              margin_left: "components.sidebar.width.expanded"
              min_height: "100vh"
              overflow_y: "auto"
              padding: "spacing.semantic.page_padding_y spacing.semantic.page_padding_x"
            responsive:
              md_down:
                margin_left: "0"
                padding: "spacing.4"

  centered_layout:
    id: "centered_layout"
    description: "Centered card layout for auth screens (login, signup, invite acceptance)."
    structure:
      - type: "VStack"
        style:
          width: "100%"
          min_height: "100vh"
          background: "colors.neutral.50"
          align_items: "center"
          justify_content: "center"
          padding: "spacing.6"
        dark_mode:
          background: "dark_mode.colors.bg.base"

  full_width_layout:
    id: "full_width_layout"
    description: "Full-width layout without sidebar for wizard flows and special pages."
    structure:
      - type: "VStack"
        style:
          width: "100%"
          min_height: "100vh"
          background: "colors.neutral.25"
        dark_mode:
          background: "dark_mode.colors.bg.base"

# =============================================================================
# SHARED COMPONENTS
# =============================================================================
# Reusable component blocks referenced across multiple screens.
# =============================================================================

shared_components:

  platform_admin_sidebar:
    id: "platform_admin_sidebar"
    type: "sidebar_nav"
    description: "Platform admin navigation sidebar with logo, nav items, and user menu."
    props:
      collapsible: true
      default_collapsed: false
    style:
      width: "components.sidebar.width.expanded"
      background: "components.sidebar.bg"
      border_right: "components.sidebar.border_right"
      padding: "spacing.4 spacing.2"
    children:
      - type: "HStack"
        id: "sidebar_logo"
        style:
          padding: "spacing.4 spacing.3"
          margin_bottom: "spacing.6"
          align_items: "center"
          gap: "spacing.3"
        children:
          - type: "Image"
            props:
              src: "/logo-icon.svg"
              alt: "Aegis"
              width: "32px"
              height: "32px"
          - type: "Text"
            props:
              content: "Aegis Admin"
            style:
              font_family: "typography.font_families.primary.css"
              font_size: "typography.scale.lg.size"
              font_weight: "typography.weights.bold"
              color: "colors.neutral.900"
              letter_spacing: "typography.scale.lg.letter_spacing"
      - type: "VStack"
        id: "nav_section_main"
        style:
          gap: "spacing.1"
        children:
          - type: "Text"
            props:
              content: "OVERVIEW"
            style:
              font_size: "components.sidebar.section_label.font_size"
              font_weight: "components.sidebar.section_label.font_weight"
              text_transform: "components.sidebar.section_label.text_transform"
              letter_spacing: "components.sidebar.section_label.letter_spacing"
              color: "components.sidebar.section_label.text"
              padding: "components.sidebar.section_label.padding"
          - type: "nav_item"
            props:
              icon: "LayoutDashboard"
              label: "Dashboard"
              href: "/admin"
            style:
              padding: "components.sidebar.item.padding"
              border_radius: "components.sidebar.item.border_radius"
              font_size: "components.sidebar.item.font_size"
              font_weight: "components.sidebar.item.font_weight"
              color: "components.sidebar.item.text"
            states:
              hover:
                background: "components.sidebar.item_hover.bg"
                color: "components.sidebar.item_hover.text"
              active:
                background: "components.sidebar.item_active.bg"
                color: "components.sidebar.item_active.text"
                font_weight: "components.sidebar.item_active.font_weight"
          - type: "nav_item"
            props:
              icon: "Building2"
              label: "Tenants"
              href: "/admin/tenants"
          - type: "nav_item"
            props:
              icon: "Activity"
              label: "System Health"
              href: "/admin/health"
      - type: "VStack"
        id: "nav_section_marketplace"
        style:
          gap: "spacing.1"
          margin_top: "spacing.4"
        children:
          - type: "Text"
            props:
              content: "MARKETPLACE"
            style:
              font_size: "components.sidebar.section_label.font_size"
              font_weight: "components.sidebar.section_label.font_weight"
              text_transform: "components.sidebar.section_label.text_transform"
              letter_spacing: "components.sidebar.section_label.letter_spacing"
              color: "components.sidebar.section_label.text"
              padding: "components.sidebar.section_label.padding"
          - type: "nav_item"
            props:
              icon: "PackageCheck"
              label: "Skill Review"
              href: "/admin/skills/review"
              badge_count: "pending_reviews_count"
      - type: "VStack"
        id: "sidebar_footer"
        style:
          margin_top: "auto"
          padding_top: "spacing.4"
          border_top: "borders.width.thin solid colors.neutral.200"
        children:
          - type: "dropdown_menu"
            id: "admin_user_menu"
            props:
              trigger_type: "user_avatar"
              user_name: "{{current_user.name}}"
              user_email: "{{current_user.email}}"
              items:
                - label: "Settings"
                  icon: "Settings"
                  action: "navigate:/admin/settings"
                - label: "Sign Out"
                  icon: "LogOut"
                  action: "auth:logout"

  tenant_admin_sidebar:
    id: "tenant_admin_sidebar"
    type: "sidebar_nav"
    description: "Tenant admin navigation sidebar."
    props:
      collapsible: true
      default_collapsed: false
    style:
      width: "components.sidebar.width.expanded"
      background: "components.sidebar.bg"
      border_right: "components.sidebar.border_right"
      padding: "spacing.4 spacing.2"
    children:
      - type: "HStack"
        id: "sidebar_logo"
        style:
          padding: "spacing.4 spacing.3"
          margin_bottom: "spacing.6"
          align_items: "center"
          gap: "spacing.3"
        children:
          - type: "Image"
            props:
              src: "/logo-icon.svg"
              alt: "Aegis"
              width: "32px"
              height: "32px"
          - type: "Text"
            props:
              content: "{{tenant.company_name}}"
            style:
              font_family: "typography.font_families.primary.css"
              font_size: "typography.scale.lg.size"
              font_weight: "typography.weights.semibold"
              color: "colors.neutral.900"
              overflow: "hidden"
              text_overflow: "ellipsis"
              white_space: "nowrap"
      - type: "VStack"
        id: "nav_main"
        style:
          gap: "spacing.1"
        children:
          - type: "Text"
            props:
              content: "WORKSPACE"
            style:
              font_size: "components.sidebar.section_label.font_size"
              font_weight: "components.sidebar.section_label.font_weight"
              text_transform: "components.sidebar.section_label.text_transform"
              letter_spacing: "components.sidebar.section_label.letter_spacing"
              color: "components.sidebar.section_label.text"
              padding: "components.sidebar.section_label.padding"
          - type: "nav_item"
            props:
              icon: "LayoutDashboard"
              label: "Dashboard"
              href: "/dashboard"
          - type: "nav_item"
            props:
              icon: "Bot"
              label: "Agents"
              href: "/dashboard/agents"
          - type: "nav_item"
            props:
              icon: "Puzzle"
              label: "Skill Marketplace"
              href: "/dashboard/skills"
      - type: "VStack"
        id: "nav_management"
        style:
          gap: "spacing.1"
          margin_top: "spacing.4"
        children:
          - type: "Text"
            props:
              content: "MANAGEMENT"
            style:
              font_size: "components.sidebar.section_label.font_size"
              font_weight: "components.sidebar.section_label.font_weight"
              text_transform: "components.sidebar.section_label.text_transform"
              letter_spacing: "components.sidebar.section_label.letter_spacing"
              color: "components.sidebar.section_label.text"
              padding: "components.sidebar.section_label.padding"
          - type: "nav_item"
            props:
              icon: "Users"
              label: "Team Members"
              href: "/dashboard/team"
          - type: "nav_item"
            props:
              icon: "ScrollText"
              label: "Audit Log"
              href: "/dashboard/audit"
          - type: "nav_item"
            props:
              icon: "Settings"
              label: "Settings"
              href: "/dashboard/settings"
      - type: "VStack"
        id: "sidebar_footer"
        style:
          margin_top: "auto"
          padding_top: "spacing.4"
          border_top: "borders.width.thin solid colors.neutral.200"
        children:
          - type: "dropdown_menu"
            id: "tenant_user_menu"
            props:
              trigger_type: "user_avatar"
              user_name: "{{current_user.name}}"
              user_email: "{{current_user.email}}"
              user_role: "{{current_user.role}}"
              items:
                - label: "Profile"
                  icon: "User"
                  action: "navigate:/dashboard/settings#profile"
                - label: "Sign Out"
                  icon: "LogOut"
                  action: "auth:logout"

  page_header_component:
    id: "page_header_template"
    type: "page_header"
    description: "Standard page header with title, breadcrumbs, description, and action buttons."
    style:
      margin_bottom: "spacing.semantic.section_gap"
    children:
      - type: "breadcrumbs"
        style:
          margin_bottom: "spacing.2"
          font_size: "typography.scale.sm.size"
          color: "colors.neutral.500"
          gap: "spacing.1.5"
      - type: "HStack"
        style:
          justify_content: "space-between"
          align_items: "center"
          flex_wrap: "wrap"
          gap: "spacing.4"
        children:
          - type: "VStack"
            style:
              gap: "spacing.1"
            children:
              - type: "Text"
                id: "page_title"
                style:
                  font_size: "typography.headings.h1.size"
                  font_weight: "typography.headings.h1.weight"
                  letter_spacing: "typography.headings.h1.tracking"
                  color: "colors.neutral.900"
                  dark_mode_color: "dark_mode.colors.text.primary"
              - type: "Text"
                id: "page_description"
                style:
                  font_size: "typography.scale.sm.size"
                  color: "colors.neutral.500"
                  dark_mode_color: "dark_mode.colors.text.secondary"
          - type: "HStack"
            id: "page_actions"
            style:
              gap: "spacing.3"

# =============================================================================
# SCREENS
# =============================================================================

screens:

  # ===========================================================================
  # SCREEN 1: Platform Admin Login
  # ===========================================================================
  - id: "platform_admin_login"
    name: "Platform Admin Login"
    route: "/admin/login"
    layout: "centered"
    auth_required: false
    role_required: "public"
    screen_id: "PA-01"
    flow_ref: "1.1"

    components:
      - type: "VStack"
        id: "login_container"
        style:
          width: "100%"
          max_width: "400px"
          padding: "spacing.10"
          background: "colors.neutral.white"
          border_radius: "borders.radius.xl"
          shadow: "shadows.lg"
          gap: "spacing.8"
        dark_mode:
          background: "dark_mode.colors.bg.raised"
          border: "dark_mode.components.card.border"
        children:
          - type: "VStack"
            id: "login_header"
            style:
              align_items: "center"
              gap: "spacing.4"
            children:
              - type: "Image"
                props:
                  src: "/logo-full.svg"
                  alt: "Aegis Platform"
                  width: "140px"
              - type: "VStack"
                style:
                  align_items: "center"
                  gap: "spacing.1"
                children:
                  - type: "Text"
                    props:
                      content: "Admin Console"
                    style:
                      font_size: "typography.headings.h2.size"
                      font_weight: "typography.headings.h2.weight"
                      color: "colors.neutral.900"
                  - type: "Text"
                    props:
                      content: "Sign in to manage the platform"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"

          - type: "form"
            id: "login_form"
            props:
              on_submit: "auth:admin_login"
            style:
              gap: "spacing.semantic.form_gap"
            children:
              - type: "form_field"
                id: "email_field"
                props:
                  label: "Email Address"
                  type: "email"
                  placeholder: "admin@aegis.ai"
                  required: true
                  auto_focus: true
                  autocomplete: "email"
                style:
                  label:
                    font_size: "typography.scale.sm.size"
                    font_weight: "typography.weights.medium"
                    color: "colors.neutral.700"
                    margin_bottom: "spacing.1.5"
                  input:
                    height: "components.input.sizes.md.height"
                    padding_x: "components.input.sizes.md.padding_x"
                    padding_y: "components.input.sizes.md.padding_y"
                    font_size: "components.input.sizes.md.font_size"
                    background: "components.input.default.bg"
                    border: "components.input.default.border"
                    border_radius: "components.input.default.border_radius"
                    color: "components.input.default.text_color"
                    placeholder_color: "components.input.default.placeholder_color"
                    transition: "components.input.default.transition"
                  states:
                    hover:
                      border: "components.input.states.hover.border"
                    focus:
                      border: "components.input.states.focus.border"
                      shadow: "components.input.states.focus.shadow"
                    error:
                      border: "components.input.states.error.border"
                      shadow: "components.input.states.error.shadow"
                  error_text:
                    font_size: "typography.scale.xs.size"
                    color: "colors.semantic.error.dark"
                    margin_top: "spacing.1"

              - type: "form_field"
                id: "password_field"
                props:
                  label: "Password"
                  type: "password"
                  placeholder: "Enter your password"
                  required: true
                  autocomplete: "current-password"
                  show_toggle: true
                style:
                  label:
                    font_size: "typography.scale.sm.size"
                    font_weight: "typography.weights.medium"
                    color: "colors.neutral.700"
                    margin_bottom: "spacing.1.5"
                  input:
                    height: "components.input.sizes.md.height"
                    background: "components.input.default.bg"
                    border: "components.input.default.border"
                    border_radius: "components.input.default.border_radius"

              - type: "Button"
                id: "login_submit"
                props:
                  content: "Sign In"
                  type: "submit"
                  variant: "primary"
                  size: "lg"
                  full_width: true
                  loading_text: "Signing in..."
                style:
                  height: "components.button.sizes.lg.height"
                  padding_x: "components.button.sizes.lg.padding_x"
                  font_size: "components.button.sizes.lg.font_size"
                  font_weight: "typography.weights.semibold"
                  border_radius: "components.button.sizes.lg.border_radius"
                  background: "components.button.variants.primary.bg"
                  color: "components.button.variants.primary.text"
                  shadow: "components.button.variants.primary.shadow"
                  transition: "animations.presets.colors"
                states:
                  hover:
                    background: "components.button.variants.primary.bg_hover"
                    shadow: "components.button.variants.primary.shadow_hover"
                  active:
                    background: "components.button.variants.primary.bg_active"
                  disabled:
                    background: "components.button.variants.primary.bg_disabled"
                    cursor: "not-allowed"

          - type: "VStack"
            id: "mfa_section"
            props:
              visible_when: "login_state === 'mfa_required'"
            style:
              gap: "spacing.semantic.form_gap"
            children:
              - type: "Text"
                props:
                  content: "Two-Factor Authentication"
                style:
                  font_size: "typography.headings.h3.size"
                  font_weight: "typography.headings.h3.weight"
                  color: "colors.neutral.900"
                  text_align: "center"
              - type: "Text"
                props:
                  content: "Enter the 6-digit code from your authenticator app"
                style:
                  font_size: "typography.scale.sm.size"
                  color: "colors.neutral.500"
                  text_align: "center"
              - type: "form_field"
                id: "mfa_code_field"
                props:
                  type: "otp"
                  length: 6
                  auto_focus: true
                  auto_submit: true
                style:
                  input:
                    width: "48px"
                    height: "56px"
                    text_align: "center"
                    font_size: "typography.scale.xl.size"
                    font_weight: "typography.weights.semibold"
                    font_family: "typography.font_families.monospace.css"
                    border: "components.input.default.border"
                    border_radius: "components.input.default.border_radius"
                  gap: "spacing.2"
              - type: "Button"
                id: "mfa_submit"
                props:
                  content: "Verify"
                  variant: "primary"
                  size: "lg"
                  full_width: true

    actions:
      - event: "form:submit"
        target: "login_form"
        handler: "POST /api/admin/auth/login"
        on_success: "check_mfa_required"
        on_error: "show_toast:error"
      - event: "form:submit"
        target: "mfa_section"
        handler: "POST /api/admin/auth/mfa/verify"
        on_success: "navigate:/admin"
        on_error: "show_toast:error"

  # ===========================================================================
  # SCREEN 2: Platform Admin Dashboard Home
  # ===========================================================================
  - id: "platform_admin_dashboard"
    name: "Dashboard Home"
    route: "/admin"
    layout: "sidebar"
    auth_required: true
    role_required: "platform_admin"
    screen_id: "PA-02"
    flow_ref: "1.1, 1.2"
    sidebar_ref: "platform_admin_sidebar"

    data_sources:
      - id: "dashboard_stats"
        endpoint: "GET /api/admin/dashboard/stats"
        refresh: "30s"
      - id: "tenant_health"
        endpoint: "GET /api/admin/tenants?include=health&limit=20"
        refresh: "30s"
      - id: "recent_alerts"
        endpoint: "GET /api/admin/alerts?limit=5&sort=created_at:desc"
        refresh: "30s"
      - id: "recent_activity"
        endpoint: "GET /api/admin/audit?limit=10&sort=created_at:desc"
        refresh: "60s"

    components:
      - type: "page_header"
        id: "dashboard_header"
        props:
          title: "Platform Overview"
          description: "Monitor tenants, system health, and platform activity."
        style:
          margin_bottom: "spacing.semantic.section_gap"
        children:
          - type: "breadcrumbs"
            props:
              items:
                - label: "Admin"
                  href: "/admin"
          - type: "HStack"
            id: "header_actions"
            style:
              gap: "spacing.3"
            children:
              - type: "Button"
                props:
                  content: "Provision Tenant"
                  variant: "primary"
                  size: "md"
                  icon_left: "Plus"
                  href: "/admin/tenants/new"
                style:
                  background: "components.button.variants.primary.bg"
                  color: "components.button.variants.primary.text"
                  height: "components.button.sizes.md.height"
                  padding_x: "components.button.sizes.md.padding_x"
                  font_size: "components.button.sizes.md.font_size"
                  font_weight: "typography.weights.semibold"
                  border_radius: "components.button.sizes.md.border_radius"

      - type: "HStack"
        id: "stats_row"
        style:
          gap: "spacing.semantic.card_gap"
          margin_bottom: "spacing.semantic.section_gap"
          flex_wrap: "wrap"
        responsive:
          lg:
            grid_template_columns: "repeat(4, 1fr)"
            display: "grid"
          md:
            grid_template_columns: "repeat(2, 1fr)"
            display: "grid"
          sm:
            grid_template_columns: "1fr"
            display: "grid"
        children:
          - type: "metric_card"
            id: "total_tenants_stat"
            props:
              label: "Total Tenants"
              value: "{{dashboard_stats.total_tenants}}"
              trend_value: "{{dashboard_stats.tenants_trend}}"
              trend_direction: "{{dashboard_stats.tenants_trend_direction}}"
              icon: "Building2"
            style:
              background: "components.metric_card.bg"
              border: "components.metric_card.border"
              border_radius: "components.metric_card.border_radius"
              padding: "components.metric_card.padding"
            children:
              - type: "Text"
                props:
                  content: "{{label}}"
                style:
                  font_size: "components.metric_card.label.font_size"
                  font_weight: "components.metric_card.label.font_weight"
                  color: "components.metric_card.label.color"
                  text_transform: "components.metric_card.label.text_transform"
                  letter_spacing: "components.metric_card.label.letter_spacing"
              - type: "Text"
                props:
                  content: "{{value}}"
                style:
                  font_size: "components.metric_card.value.font_size"
                  font_weight: "components.metric_card.value.font_weight"
                  color: "components.metric_card.value.color"

          - type: "metric_card"
            id: "active_agents_stat"
            props:
              label: "Active Agents"
              value: "{{dashboard_stats.active_agents}}"
              trend_value: "{{dashboard_stats.agents_trend}}"
              icon: "Bot"

          - type: "metric_card"
            id: "api_calls_stat"
            props:
              label: "API Calls (24h)"
              value: "{{dashboard_stats.api_calls_24h}}"
              trend_value: "{{dashboard_stats.api_calls_trend}}"
              icon: "Zap"

          - type: "metric_card"
            id: "system_health_stat"
            props:
              label: "System Health"
              value: "{{dashboard_stats.health_score}}%"
              icon: "HeartPulse"
              value_color_condition:
                gte_90: "colors.semantic.success.main"
                gte_70: "colors.semantic.warning.main"
                lt_70: "colors.semantic.error.main"

      - type: "HStack"
        id: "main_content_grid"
        style:
          gap: "spacing.semantic.card_gap"
          align_items: "flex-start"
        responsive:
          lg:
            grid_template_columns: "2fr 1fr"
            display: "grid"
          md_down:
            display: "flex"
            flex_direction: "column"
        children:
          - type: "VStack"
            id: "left_column"
            style:
              gap: "spacing.semantic.card_gap"
            children:
              - type: "card"
                id: "tenant_health_grid"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  shadow: "components.card.variants.default.shadow"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      align_items: "center"
                      margin_bottom: "spacing.5"
                    children:
                      - type: "Text"
                        props:
                          content: "Container Health"
                        style:
                          font_size: "typography.headings.h3.size"
                          font_weight: "typography.headings.h3.weight"
                          color: "colors.neutral.900"
                      - type: "Button"
                        props:
                          content: "View All"
                          variant: "link"
                          size: "sm"
                          href: "/admin/tenants"
                        style:
                          color: "colors.primary.500"
                          font_size: "typography.scale.sm.size"

                  - type: "card_grid"
                    id: "health_cards"
                    props:
                      data_source: "tenant_health"
                      empty_state:
                        icon: "Building2"
                        title: "No tenants yet"
                        description: "Provision your first tenant to get started."
                        action_label: "Provision Tenant"
                        action_href: "/admin/tenants/new"
                    style:
                      display: "grid"
                      grid_template_columns: "repeat(auto-fill, minmax(200px, 1fr))"
                      gap: "spacing.3"
                    item_template:
                      type: "card"
                      style:
                        background: "components.card.variants.interactive.bg"
                        border: "components.card.variants.interactive.border"
                        border_radius: "components.card.variants.interactive.border_radius"
                        padding: "components.card.variants.interactive.padding"
                        cursor: "components.card.variants.interactive.cursor"
                        transition: "animations.presets.default"
                      states:
                        hover:
                          shadow: "components.card.variants.interactive.hover_shadow"
                          border: "components.card.variants.interactive.hover_border"
                      actions:
                        - event: "click"
                          handler: "navigate:/admin/tenants/{{item.id}}"
                      children:
                        - type: "HStack"
                          style:
                            justify_content: "space-between"
                            align_items: "flex-start"
                          children:
                            - type: "VStack"
                              style:
                                gap: "spacing.1"
                              children:
                                - type: "Text"
                                  props:
                                    content: "{{item.company_name}}"
                                  style:
                                    font_size: "typography.scale.sm.size"
                                    font_weight: "typography.weights.semibold"
                                    color: "colors.neutral.900"
                                - type: "Text"
                                  props:
                                    content: "{{item.agent_count}} agents"
                                  style:
                                    font_size: "typography.scale.xs.size"
                                    color: "colors.neutral.500"
                            - type: "status_badge"
                              props:
                                status: "{{item.health_status}}"
                                variant: "dot"
                              style:
                                dot_healthy: "colors.container_health.healthy"
                                dot_degraded: "colors.container_health.degraded"
                                dot_down: "colors.container_health.down"
                                dot_unknown: "colors.container_health.unknown"
                                dot_size: "components.badge.dot.size"
                                dot_border_radius: "components.badge.dot.border_radius"

          - type: "VStack"
            id: "right_column"
            style:
              gap: "spacing.semantic.card_gap"
            children:
              - type: "card"
                id: "recent_alerts_card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  shadow: "components.card.variants.default.shadow"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      align_items: "center"
                      margin_bottom: "spacing.4"
                    children:
                      - type: "Text"
                        props:
                          content: "Recent Alerts"
                        style:
                          font_size: "typography.headings.h3.size"
                          font_weight: "typography.headings.h3.weight"
                          color: "colors.neutral.900"
                      - type: "Button"
                        props:
                          content: "View All"
                          variant: "link"
                          size: "sm"
                          href: "/admin/alerts"
                  - type: "activity_feed"
                    id: "alerts_feed"
                    props:
                      data_source: "recent_alerts"
                      empty_state:
                        icon: "CheckCircle"
                        title: "All clear"
                        description: "No recent alerts."
                    style:
                      gap: "spacing.3"
                    item_template:
                      type: "HStack"
                      style:
                        gap: "spacing.3"
                        padding: "spacing.2 0"
                        border_bottom: "borders.width.thin solid colors.neutral.100"
                      children:
                        - type: "status_badge"
                          props:
                            severity: "{{item.severity}}"
                          style:
                            dot_size: "10px"
                        - type: "VStack"
                          style:
                            gap: "spacing.0.5"
                            flex: "1"
                          children:
                            - type: "Text"
                              props:
                                content: "{{item.message}}"
                              style:
                                font_size: "typography.scale.sm.size"
                                color: "colors.neutral.800"
                            - type: "Text"
                              props:
                                content: "{{item.created_at | relative_time}}"
                              style:
                                font_size: "typography.scale.xs.size"
                                color: "colors.neutral.400"
                                font_family: "typography.font_families.monospace.css"

              - type: "card"
                id: "recent_activity_card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  shadow: "components.card.variants.default.shadow"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Recent Activity"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "activity_feed"
                    id: "activity_feed"
                    props:
                      data_source: "recent_activity"
                    style:
                      gap: "spacing.3"
                    item_template:
                      type: "HStack"
                      style:
                        gap: "spacing.3"
                        padding: "spacing.2 0"
                      children:
                        - type: "avatar"
                          props:
                            name: "{{item.actor}}"
                            size: "32px"
                        - type: "VStack"
                          style:
                            gap: "spacing.0.5"
                          children:
                            - type: "Text"
                              props:
                                content: "{{item.description}}"
                              style:
                                font_size: "typography.scale.sm.size"
                                color: "colors.neutral.700"
                            - type: "Text"
                              props:
                                content: "{{item.created_at | relative_time}}"
                              style:
                                font_size: "typography.scale.xs.size"
                                color: "colors.neutral.400"

  # ===========================================================================
  # SCREEN 3: Tenant List
  # ===========================================================================
  - id: "platform_admin_tenant_list"
    name: "Tenant List"
    route: "/admin/tenants"
    layout: "sidebar"
    auth_required: true
    role_required: "platform_admin"
    screen_id: "PA-03"
    flow_ref: "1.1"
    sidebar_ref: "platform_admin_sidebar"

    data_sources:
      - id: "tenants"
        endpoint: "GET /api/admin/tenants"
        params:
          page: "{{pagination.page}}"
          limit: 20
          sort: "{{sort.field}}:{{sort.direction}}"
          search: "{{search.query}}"
          status: "{{filters.status}}"
          plan: "{{filters.plan}}"
        refresh: "30s"

    components:
      - type: "page_header"
        props:
          title: "Tenants"
          description: "Manage all tenant environments and their configurations."
          breadcrumbs:
            - label: "Admin"
              href: "/admin"
            - label: "Tenants"
        children:
          - type: "HStack"
            id: "header_actions"
            style:
              gap: "spacing.3"
            children:
              - type: "Button"
                props:
                  content: "Provision Tenant"
                  variant: "primary"
                  size: "md"
                  icon_left: "Plus"
                  href: "/admin/tenants/new"

      - type: "card"
        id: "tenant_list_card"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "0"
        children:
          - type: "HStack"
            id: "table_toolbar"
            style:
              padding: "spacing.4"
              gap: "spacing.3"
              border_bottom: "borders.width.thin solid colors.neutral.200"
              flex_wrap: "wrap"
            children:
              - type: "search_bar"
                id: "tenant_search"
                props:
                  placeholder: "Search tenants by name or email..."
                  icon: "Search"
                  debounce_ms: 300
                style:
                  flex: "1"
                  min_width: "240px"
                  input:
                    height: "components.input.sizes.sm.height"
                    font_size: "components.input.sizes.sm.font_size"
                    padding_left: "spacing.8"
                    background: "components.input.default.bg"
                    border: "components.input.default.border"
                    border_radius: "components.input.default.border_radius"
              - type: "HStack"
                id: "filter_group"
                style:
                  gap: "spacing.2"
                children:
                  - type: "select"
                    id: "status_filter"
                    props:
                      placeholder: "All Statuses"
                      options:
                        - label: "Active"
                          value: "active"
                        - label: "Provisioning"
                          value: "provisioning"
                        - label: "Suspended"
                          value: "suspended"
                        - label: "Failed"
                          value: "failed"
                    style:
                      height: "components.input.sizes.sm.height"
                      font_size: "components.input.sizes.sm.font_size"
                      min_width: "140px"
                  - type: "select"
                    id: "plan_filter"
                    props:
                      placeholder: "All Plans"
                      options:
                        - label: "Starter"
                          value: "starter"
                        - label: "Growth"
                          value: "growth"
                        - label: "Enterprise"
                          value: "enterprise"
                    style:
                      height: "components.input.sizes.sm.height"
                      font_size: "components.input.sizes.sm.font_size"
                      min_width: "130px"

          - type: "data_table"
            id: "tenants_table"
            props:
              data_source: "tenants"
              sortable: true
              selectable: false
              paginated: true
              page_size: 20
              empty_state:
                icon: "Building2"
                title: "No tenants found"
                description: "No tenants match your search criteria."
              columns:
                - id: "company_name"
                  header: "Company"
                  sortable: true
                  width: "auto"
                  cell_type: "text_with_subtitle"
                  primary: "{{row.company_name}}"
                  secondary: "{{row.admin_email}}"
                - id: "status"
                  header: "Status"
                  sortable: true
                  width: "120px"
                  cell_type: "status_badge"
                  variant_map:
                    active: "success"
                    provisioning: "info"
                    suspended: "warning"
                    failed: "error"
                - id: "plan"
                  header: "Plan"
                  sortable: true
                  width: "100px"
                  cell_type: "badge"
                  variant: "outline"
                - id: "agent_count"
                  header: "Agents"
                  sortable: true
                  width: "80px"
                  cell_type: "text"
                  align: "center"
                - id: "health"
                  header: "Health"
                  sortable: true
                  width: "80px"
                  cell_type: "health_dot"
                  dot_color_map:
                    healthy: "colors.container_health.healthy"
                    degraded: "colors.container_health.degraded"
                    down: "colors.container_health.down"
                    unknown: "colors.container_health.unknown"
                - id: "created_at"
                  header: "Created"
                  sortable: true
                  width: "120px"
                  cell_type: "date"
                  format: "MMM d, yyyy"
                - id: "actions"
                  header: ""
                  width: "60px"
                  cell_type: "actions_menu"
                  items:
                    - label: "View Details"
                      icon: "Eye"
                      action: "navigate:/admin/tenants/{{row.id}}"
                    - label: "Edit Configuration"
                      icon: "Settings"
                      action: "navigate:/admin/tenants/{{row.id}}?tab=config"
                    - type: "separator"
                    - label: "Suspend Tenant"
                      icon: "Pause"
                      action: "confirm_then:PUT /api/admin/tenants/{{row.id}}/suspend"
                      variant: "destructive"
                      visible_when: "row.status === 'active'"
            style:
              header:
                background: "components.table.header.bg"
                color: "components.table.header.text"
                font_size: "components.table.header.font_size"
                font_weight: "components.table.header.font_weight"
                text_transform: "components.table.header.text_transform"
                letter_spacing: "components.table.header.letter_spacing"
                padding: "components.table.header.padding"
                border_bottom: "components.table.header.border_bottom"
              row:
                background: "components.table.row.bg"
                padding: "components.table.row.padding"
                border_bottom: "components.table.row.border_bottom"
                font_size: "components.table.row.font_size"
                color: "components.table.row.text"
                transition: "components.table.row.transition"
              row_hover:
                background: "components.table.row.bg_hover"
              cell:
                text_primary: "components.table.cell.text_primary"
                text_secondary: "components.table.cell.text_secondary"
            dark_mode:
              header:
                background: "dark_mode.components.table.header_bg"
                color: "dark_mode.components.table.header_text"
              row:
                background: "dark_mode.components.table.row_bg"
                border_bottom_color: "dark_mode.components.table.border"
              row_hover:
                background: "dark_mode.components.table.row_hover_bg"

    actions:
      - event: "row:click"
        target: "tenants_table"
        handler: "navigate:/admin/tenants/{{row.id}}"

  # ===========================================================================
  # SCREEN 4: Tenant Provisioning Wizard
  # ===========================================================================
  - id: "platform_admin_provision_wizard"
    name: "Tenant Provisioning Wizard"
    route: "/admin/tenants/new"
    layout: "sidebar"
    auth_required: true
    role_required: "platform_admin"
    screen_id: "PA-04"
    flow_ref: "1.1"
    sidebar_ref: "platform_admin_sidebar"

    components:
      - type: "page_header"
        props:
          title: "Provision New Tenant"
          description: "Create a new company environment with an isolated OpenClaw container."
          breadcrumbs:
            - label: "Admin"
              href: "/admin"
            - label: "Tenants"
              href: "/admin/tenants"
            - label: "New Tenant"

      - type: "card"
        id: "wizard_container"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "spacing.8"
          max_width: "720px"
        children:
          - type: "wizard"
            id: "provision_wizard"
            props:
              current_step: "{{wizard_state.step}}"
              steps:
                - id: "company_details"
                  label: "Company Details"
                - id: "plan_selection"
                  label: "Plan & Resources"
                - id: "review_confirm"
                  label: "Review & Provision"
            style:
              step_indicator:
                size: "components.wizard.step_indicator.size"
                font_size: "components.wizard.step_indicator.font_size"
                font_weight: "components.wizard.step_indicator.font_weight"
                border_radius: "components.wizard.step_indicator.border_radius"
                completed:
                  background: "components.wizard.step_indicator.completed.bg"
                  color: "components.wizard.step_indicator.completed.text"
                active:
                  background: "components.wizard.step_indicator.active.bg"
                  color: "components.wizard.step_indicator.active.text"
                  border: "components.wizard.step_indicator.active.border"
                upcoming:
                  background: "components.wizard.step_indicator.upcoming.bg"
                  color: "components.wizard.step_indicator.upcoming.text"
                  border: "components.wizard.step_indicator.upcoming.border"
              connector:
                color_completed: "components.wizard.connector.color_completed"
                color_upcoming: "components.wizard.connector.color_upcoming"
                height: "components.wizard.connector.height"
              step_label:
                font_size: "components.wizard.step_label.font_size"
                font_weight: "components.wizard.step_label.font_weight"
                active_color: "components.wizard.step_label.active_color"
                inactive_color: "components.wizard.step_label.inactive_color"
              content_padding_top: "spacing.8"

            children:
              # Step 1: Company Details
              - type: "VStack"
                id: "step_company_details"
                props:
                  visible_when: "wizard_state.step === 0"
                style:
                  gap: "spacing.semantic.form_gap"
                children:
                  - type: "Text"
                    props:
                      content: "Company Information"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.2"
                  - type: "form_field"
                    props:
                      label: "Company Name"
                      type: "text"
                      placeholder: "Acme Corporation"
                      required: true
                      validation: "unique_check:/api/admin/tenants/check-name"
                      hint: "Must be unique across the platform."
                  - type: "form_field"
                    props:
                      label: "Admin Email"
                      type: "email"
                      placeholder: "admin@acme.com"
                      required: true
                      validation: "unique_check:/api/admin/tenants/check-email"
                      hint: "This person will receive the admin invite."
                  - type: "form_field"
                    props:
                      label: "Industry"
                      type: "select"
                      required: true
                      options:
                        - label: "Technology"
                          value: "technology"
                        - label: "E-Commerce / Retail"
                          value: "ecommerce"
                        - label: "Financial Services"
                          value: "finance"
                        - label: "Healthcare"
                          value: "healthcare"
                        - label: "Education"
                          value: "education"
                        - label: "Other"
                          value: "other"
                  - type: "form_field"
                    props:
                      label: "Expected Agent Count"
                      type: "number"
                      placeholder: "5"
                      min: 1
                      max: 50
                      hint: "Helps us allocate appropriate resources."

                  - type: "HStack"
                    style:
                      justify_content: "flex-end"
                      padding_top: "spacing.6"
                    children:
                      - type: "Button"
                        props:
                          content: "Continue"
                          variant: "primary"
                          size: "md"
                          icon_right: "ArrowRight"
                        actions:
                          - event: "click"
                            handler: "wizard:next"

              # Step 2: Plan & Resources
              - type: "VStack"
                id: "step_plan_selection"
                props:
                  visible_when: "wizard_state.step === 1"
                style:
                  gap: "spacing.semantic.form_gap"
                children:
                  - type: "Text"
                    props:
                      content: "Plan & Resource Allocation"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.2"
                  - type: "card_grid"
                    id: "plan_cards"
                    style:
                      display: "grid"
                      grid_template_columns: "repeat(3, 1fr)"
                      gap: "spacing.4"
                    responsive:
                      md_down:
                        grid_template_columns: "1fr"
                    children:
                      - type: "card"
                        id: "plan_starter"
                        props:
                          selectable: true
                          selected_when: "wizard_state.plan === 'starter'"
                        style:
                          background: "components.card.variants.interactive.bg"
                          border: "components.card.variants.interactive.border"
                          border_radius: "components.card.variants.interactive.border_radius"
                          padding: "spacing.5"
                          cursor: "pointer"
                        states:
                          selected:
                            border: "borders.width.medium solid colors.primary.500"
                            shadow: "shadows.focus_ring"
                        children:
                          - type: "VStack"
                            style:
                              gap: "spacing.3"
                            children:
                              - type: "Text"
                                props:
                                  content: "Starter"
                                style:
                                  font_size: "typography.headings.h4.size"
                                  font_weight: "typography.headings.h4.weight"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "$199/mo"
                                style:
                                  font_size: "typography.scale.2xl.size"
                                  font_weight: "typography.weights.bold"
                                  color: "colors.primary.500"
                              - type: "VStack"
                                style:
                                  gap: "spacing.2"
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.600"
                                children:
                                  - type: "Text"
                                    props:
                                      content: "Up to 3 agents"
                                  - type: "Text"
                                    props:
                                      content: "Sonnet model"
                                  - type: "Text"
                                    props:
                                      content: "1 vCPU, 2GB RAM"
                        actions:
                          - event: "click"
                            handler: "wizard:set_plan:starter"

                      - type: "card"
                        id: "plan_growth"
                        props:
                          selectable: true
                          selected_when: "wizard_state.plan === 'growth'"
                          recommended: true
                        style:
                          background: "components.card.variants.interactive.bg"
                          border: "borders.width.medium solid colors.primary.500"
                          border_radius: "components.card.variants.interactive.border_radius"
                          padding: "spacing.5"
                          cursor: "pointer"
                          position: "relative"
                        children:
                          - type: "badge"
                            props:
                              content: "Recommended"
                            style:
                              position: "absolute"
                              top: "-spacing.3"
                              right: "spacing.4"
                              background: "colors.primary.500"
                              color: "colors.neutral.white"
                              font_size: "components.badge.sizes.sm.font_size"
                              padding: "components.badge.sizes.sm.padding_y components.badge.sizes.sm.padding_x"
                              border_radius: "components.badge.sizes.sm.border_radius"
                              font_weight: "components.badge.sizes.sm.font_weight"
                          - type: "VStack"
                            style:
                              gap: "spacing.3"
                            children:
                              - type: "Text"
                                props:
                                  content: "Growth"
                                style:
                                  font_size: "typography.headings.h4.size"
                                  font_weight: "typography.headings.h4.weight"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "$499/mo"
                                style:
                                  font_size: "typography.scale.2xl.size"
                                  font_weight: "typography.weights.bold"
                                  color: "colors.primary.500"
                              - type: "VStack"
                                style:
                                  gap: "spacing.2"
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.600"
                                children:
                                  - type: "Text"
                                    props:
                                      content: "Up to 10 agents"
                                  - type: "Text"
                                    props:
                                      content: "Sonnet + Opus models"
                                  - type: "Text"
                                    props:
                                      content: "2 vCPU, 4GB RAM"
                        actions:
                          - event: "click"
                            handler: "wizard:set_plan:growth"

                      - type: "card"
                        id: "plan_enterprise"
                        props:
                          selectable: true
                          selected_when: "wizard_state.plan === 'enterprise'"
                        style:
                          background: "components.card.variants.interactive.bg"
                          border: "components.card.variants.interactive.border"
                          border_radius: "components.card.variants.interactive.border_radius"
                          padding: "spacing.5"
                          cursor: "pointer"
                        children:
                          - type: "VStack"
                            style:
                              gap: "spacing.3"
                            children:
                              - type: "Text"
                                props:
                                  content: "Enterprise"
                                style:
                                  font_size: "typography.headings.h4.size"
                                  font_weight: "typography.headings.h4.weight"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "Custom"
                                style:
                                  font_size: "typography.scale.2xl.size"
                                  font_weight: "typography.weights.bold"
                                  color: "colors.primary.500"
                              - type: "VStack"
                                style:
                                  gap: "spacing.2"
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.600"
                                children:
                                  - type: "Text"
                                    props:
                                      content: "Unlimited agents"
                                  - type: "Text"
                                    props:
                                      content: "All models"
                                  - type: "Text"
                                    props:
                                      content: "Custom resources"
                        actions:
                          - event: "click"
                            handler: "wizard:set_plan:enterprise"

                  - type: "VStack"
                    id: "resource_config"
                    style:
                      gap: "spacing.semantic.form_gap"
                      margin_top: "spacing.4"
                    children:
                      - type: "Text"
                        props:
                          content: "Resource Limits"
                        style:
                          font_size: "typography.headings.h4.size"
                          font_weight: "typography.headings.h4.weight"
                          color: "colors.neutral.900"
                      - type: "HStack"
                        style:
                          gap: "spacing.4"
                          flex_wrap: "wrap"
                        children:
                          - type: "form_field"
                            props:
                              label: "Model Default"
                              type: "select"
                              options:
                                - label: "Haiku (Light)"
                                  value: "haiku"
                                - label: "Sonnet (Standard)"
                                  value: "sonnet"
                                - label: "Opus (Advanced)"
                                  value: "opus"
                            style:
                              flex: "1"
                              min_width: "180px"
                          - type: "form_field"
                            props:
                              label: "Max Agents"
                              type: "number"
                              min: 1
                              max: 100
                            style:
                              flex: "1"
                              min_width: "140px"

                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      padding_top: "spacing.6"
                    children:
                      - type: "Button"
                        props:
                          content: "Back"
                          variant: "secondary"
                          size: "md"
                          icon_left: "ArrowLeft"
                        actions:
                          - event: "click"
                            handler: "wizard:prev"
                      - type: "Button"
                        props:
                          content: "Continue"
                          variant: "primary"
                          size: "md"
                          icon_right: "ArrowRight"
                        actions:
                          - event: "click"
                            handler: "wizard:next"

              # Step 3: Review & Provision
              - type: "VStack"
                id: "step_review"
                props:
                  visible_when: "wizard_state.step === 2"
                style:
                  gap: "spacing.6"
                children:
                  - type: "Text"
                    props:
                      content: "Review & Confirm"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "card"
                    id: "review_summary"
                    style:
                      background: "colors.neutral.50"
                      border: "borders.width.thin solid colors.neutral.200"
                      border_radius: "borders.radius.lg"
                      padding: "spacing.5"
                    children:
                      - type: "VStack"
                        style:
                          gap: "spacing.4"
                        children:
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                              padding_bottom: "spacing.3"
                              border_bottom: "borders.width.thin solid colors.neutral.200"
                            children:
                              - type: "Text"
                                props:
                                  content: "Company"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{wizard_state.company_name}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                              padding_bottom: "spacing.3"
                              border_bottom: "borders.width.thin solid colors.neutral.200"
                            children:
                              - type: "Text"
                                props:
                                  content: "Admin Email"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{wizard_state.admin_email}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                              padding_bottom: "spacing.3"
                              border_bottom: "borders.width.thin solid colors.neutral.200"
                            children:
                              - type: "Text"
                                props:
                                  content: "Plan"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "badge"
                                props:
                                  content: "{{wizard_state.plan | titlecase}}"
                                  variant: "primary"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Estimated Monthly Cost"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{wizard_state.estimated_cost}}"
                                style:
                                  font_size: "typography.scale.base.size"
                                  font_weight: "typography.weights.bold"
                                  color: "colors.primary.500"

                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      padding_top: "spacing.4"
                    children:
                      - type: "Button"
                        props:
                          content: "Back"
                          variant: "secondary"
                          size: "md"
                          icon_left: "ArrowLeft"
                        actions:
                          - event: "click"
                            handler: "wizard:prev"
                      - type: "Button"
                        id: "provision_btn"
                        props:
                          content: "Provision Tenant"
                          variant: "primary"
                          size: "lg"
                          icon_left: "Rocket"
                          loading_text: "Provisioning..."
                        actions:
                          - event: "click"
                            handler: "POST /api/admin/tenants"
                            on_success: "show:provisioning_progress"
                            on_error: "show_toast:error"

      # Provisioning Progress Overlay
      - type: "VStack"
        id: "provisioning_progress"
        props:
          visible_when: "wizard_state.provisioning === true"
        style:
          max_width: "720px"
          margin_top: "spacing.8"
        children:
          - type: "card"
            style:
              background: "components.card.variants.default.bg"
              border: "components.card.variants.default.border"
              border_radius: "components.card.variants.default.border_radius"
              shadow: "components.card.variants.default.shadow"
              padding: "spacing.8"
            children:
              - type: "VStack"
                style:
                  align_items: "center"
                  gap: "spacing.6"
                children:
                  - type: "Text"
                    props:
                      content: "Provisioning in Progress"
                    style:
                      font_size: "typography.headings.h2.size"
                      font_weight: "typography.headings.h2.weight"
                      color: "colors.neutral.900"
                  - type: "VStack"
                    id: "progress_steps"
                    style:
                      width: "100%"
                      gap: "spacing.4"
                    children:
                      - type: "progress_step"
                        props:
                          label: "Creating Kubernetes Namespace"
                          status: "{{provision_progress.k8s_namespace}}"
                      - type: "progress_step"
                        props:
                          label: "Spinning Up OpenClaw Container"
                          status: "{{provision_progress.container}}"
                      - type: "progress_step"
                        props:
                          label: "Configuring Environment"
                          status: "{{provision_progress.config}}"
                      - type: "progress_step"
                        props:
                          label: "Installing Core Skill Bundle"
                          status: "{{provision_progress.skills}}"
                      - type: "progress_step"
                        props:
                          label: "Running Health Check"
                          status: "{{provision_progress.health}}"

    actions:
      - event: "provision:complete"
        handler: "navigate:/admin/tenants/{{new_tenant.id}}?provisioned=true"
      - event: "provision:failed"
        handler: "show_toast:error:Provisioning failed. Check logs for details."

  # ===========================================================================
  # SCREEN 5: Tenant Detail
  # ===========================================================================
  - id: "platform_admin_tenant_detail"
    name: "Tenant Detail"
    route: "/admin/tenants/:id"
    layout: "sidebar"
    auth_required: true
    role_required: "platform_admin"
    screen_id: "PA-06"
    flow_ref: "1.2"
    sidebar_ref: "platform_admin_sidebar"

    data_sources:
      - id: "tenant"
        endpoint: "GET /api/admin/tenants/:id"
        refresh: "30s"
      - id: "tenant_agents"
        endpoint: "GET /api/admin/tenants/:id/agents"
        refresh: "30s"
      - id: "tenant_resources"
        endpoint: "GET /api/admin/tenants/:id/resources"
        refresh: "30s"
      - id: "tenant_audit"
        endpoint: "GET /api/admin/tenants/:id/audit?limit=20"

    components:
      - type: "page_header"
        props:
          title: "{{tenant.company_name}}"
          description: "Tenant ID: {{tenant.id}}"
          breadcrumbs:
            - label: "Admin"
              href: "/admin"
            - label: "Tenants"
              href: "/admin/tenants"
            - label: "{{tenant.company_name}}"
        children:
          - type: "HStack"
            style:
              gap: "spacing.3"
              align_items: "center"
            children:
              - type: "status_badge"
                props:
                  status: "{{tenant.status}}"
                  size: "lg"
                  variant_map:
                    active: "success"
                    provisioning: "info"
                    suspended: "warning"
                    failed: "error"
              - type: "dropdown_menu"
                props:
                  trigger_icon: "MoreVertical"
                  trigger_variant: "ghost"
                  items:
                    - label: "Restart Container"
                      icon: "RotateCcw"
                      action: "confirm_then:POST /api/admin/tenants/:id/restart"
                    - label: "Export Logs"
                      icon: "Download"
                      action: "GET /api/admin/tenants/:id/logs/export"
                    - type: "separator"
                    - label: "Suspend Tenant"
                      icon: "Pause"
                      action: "confirm_then:PUT /api/admin/tenants/:id/suspend"
                      variant: "destructive"
                      visible_when: "tenant.status === 'active'"

      - type: "tabs"
        id: "tenant_tabs"
        props:
          default_tab: "overview"
          tabs:
            - id: "overview"
              label: "Overview"
              icon: "Info"
            - id: "config"
              label: "Configuration"
              icon: "Settings"
            - id: "agents"
              label: "Agents"
              icon: "Bot"
              badge: "{{tenant_agents.length}}"
            - id: "resources"
              label: "Resources"
              icon: "BarChart3"
            - id: "audit"
              label: "Audit Log"
              icon: "ScrollText"
        style:
          tab_list:
            border_bottom: "borders.width.thin solid colors.neutral.200"
            gap: "spacing.0"
          tab:
            padding: "spacing.3 spacing.4"
            font_size: "typography.scale.sm.size"
            font_weight: "typography.weights.medium"
            color: "colors.neutral.500"
            border_bottom: "borders.width.medium solid transparent"
            transition: "animations.presets.colors"
          tab_active:
            color: "colors.primary.500"
            border_bottom: "borders.width.medium solid colors.primary.500"
            font_weight: "typography.weights.semibold"
          tab_hover:
            color: "colors.neutral.700"
          tab_content:
            padding_top: "spacing.6"

        children:
          # Overview Tab
          - type: "VStack"
            id: "tab_overview"
            props:
              tab_id: "overview"
            style:
              gap: "spacing.6"
            children:
              - type: "HStack"
                style:
                  gap: "spacing.semantic.card_gap"
                  display: "grid"
                  grid_template_columns: "repeat(4, 1fr)"
                responsive:
                  md_down:
                    grid_template_columns: "repeat(2, 1fr)"
                children:
                  - type: "metric_card"
                    props:
                      label: "Health"
                      value: "{{tenant.health_status | titlecase}}"
                      icon: "HeartPulse"
                  - type: "metric_card"
                    props:
                      label: "Agents"
                      value: "{{tenant.agent_count}}/{{tenant.max_agents}}"
                      icon: "Bot"
                  - type: "metric_card"
                    props:
                      label: "Plan"
                      value: "{{tenant.plan | titlecase}}"
                      icon: "CreditCard"
                  - type: "metric_card"
                    props:
                      label: "Uptime"
                      value: "{{tenant.uptime_percent}}%"
                      icon: "Clock"

              - type: "card"
                id: "tenant_info_card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Tenant Information"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "VStack"
                    style:
                      gap: "spacing.3"
                    children:
                      - type: "HStack"
                        style:
                          gap: "spacing.8"
                          flex_wrap: "wrap"
                        children:
                          - type: "VStack"
                            style:
                              gap: "spacing.1"
                            children:
                              - type: "Text"
                                props:
                                  content: "Company Name"
                                style:
                                  font_size: "typography.scale.xs.size"
                                  font_weight: "typography.weights.medium"
                                  color: "colors.neutral.500"
                                  text_transform: "uppercase"
                                  letter_spacing: "0.05em"
                              - type: "Text"
                                props:
                                  content: "{{tenant.company_name}}"
                                style:
                                  font_size: "typography.scale.base.size"
                                  color: "colors.neutral.900"
                          - type: "VStack"
                            style:
                              gap: "spacing.1"
                            children:
                              - type: "Text"
                                props:
                                  content: "Admin Email"
                                style:
                                  font_size: "typography.scale.xs.size"
                                  font_weight: "typography.weights.medium"
                                  color: "colors.neutral.500"
                                  text_transform: "uppercase"
                                  letter_spacing: "0.05em"
                              - type: "Text"
                                props:
                                  content: "{{tenant.admin_email}}"
                                style:
                                  font_size: "typography.scale.base.size"
                                  color: "colors.neutral.900"
                          - type: "VStack"
                            style:
                              gap: "spacing.1"
                            children:
                              - type: "Text"
                                props:
                                  content: "Industry"
                                style:
                                  font_size: "typography.scale.xs.size"
                                  font_weight: "typography.weights.medium"
                                  color: "colors.neutral.500"
                                  text_transform: "uppercase"
                                  letter_spacing: "0.05em"
                              - type: "Text"
                                props:
                                  content: "{{tenant.industry}}"
                                style:
                                  font_size: "typography.scale.base.size"
                                  color: "colors.neutral.900"
                          - type: "VStack"
                            style:
                              gap: "spacing.1"
                            children:
                              - type: "Text"
                                props:
                                  content: "Created"
                                style:
                                  font_size: "typography.scale.xs.size"
                                  font_weight: "typography.weights.medium"
                                  color: "colors.neutral.500"
                                  text_transform: "uppercase"
                                  letter_spacing: "0.05em"
                              - type: "Text"
                                props:
                                  content: "{{tenant.created_at | date:'MMM d, yyyy'}}"
                                style:
                                  font_size: "typography.scale.base.size"
                                  color: "colors.neutral.900"

          # Configuration Tab
          - type: "VStack"
            id: "tab_config"
            props:
              tab_id: "config"
            style:
              gap: "spacing.6"
            children:
              - type: "card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      align_items: "center"
                      margin_bottom: "spacing.4"
                    children:
                      - type: "Text"
                        props:
                          content: "OpenClaw Configuration"
                        style:
                          font_size: "typography.headings.h3.size"
                          font_weight: "typography.headings.h3.weight"
                          color: "colors.neutral.900"
                      - type: "HStack"
                        style:
                          gap: "spacing.2"
                        children:
                          - type: "Button"
                            props:
                              content: "Form View"
                              variant: "ghost"
                              size: "sm"
                              active_when: "config_view === 'form'"
                          - type: "Button"
                            props:
                              content: "JSON View"
                              variant: "ghost"
                              size: "sm"
                              active_when: "config_view === 'json'"
                  - type: "form"
                    id: "config_form"
                    props:
                      visible_when: "config_view === 'form'"
                    style:
                      gap: "spacing.semantic.form_gap"
                    children:
                      - type: "form_field"
                        props:
                          label: "Model Tier"
                          type: "select"
                          value: "{{tenant.config.model}}"
                          options:
                            - label: "Haiku"
                              value: "haiku"
                            - label: "Sonnet"
                              value: "sonnet"
                            - label: "Opus"
                              value: "opus"
                      - type: "form_field"
                        props:
                          label: "Thinking Mode"
                          type: "select"
                          value: "{{tenant.config.thinking_mode}}"
                          options:
                            - label: "Off"
                              value: "off"
                            - label: "Low"
                              value: "low"
                            - label: "High"
                              value: "high"
                      - type: "form_field"
                        props:
                          label: "Max Tokens"
                          type: "number"
                          value: "{{tenant.config.max_tokens}}"
                      - type: "Button"
                        props:
                          content: "Save Configuration"
                          variant: "primary"
                          size: "md"
                        actions:
                          - event: "click"
                            handler: "PUT /api/admin/tenants/:id/config"
                  - type: "VStack"
                    props:
                      visible_when: "config_view === 'json'"
                    children:
                      - type: "code_editor"
                        props:
                          language: "json"
                          value: "{{tenant.config | json}}"
                          read_only: false
                        style:
                          font_family: "typography.font_families.monospace.css"
                          font_size: "typography.scale.sm.size"
                          border: "borders.width.thin solid colors.neutral.200"
                          border_radius: "borders.radius.md"
                          min_height: "300px"

          # Agents Tab
          - type: "VStack"
            id: "tab_agents"
            props:
              tab_id: "agents"
            style:
              gap: "spacing.4"
            children:
              - type: "data_table"
                id: "tenant_agents_table"
                props:
                  data_source: "tenant_agents"
                  columns:
                    - id: "name"
                      header: "Agent"
                      cell_type: "text_with_subtitle"
                      primary: "{{row.name}}"
                      secondary: "{{row.role}}"
                    - id: "model"
                      header: "Model"
                      cell_type: "badge"
                      variant: "outline"
                    - id: "status"
                      header: "Status"
                      cell_type: "status_badge"
                      variant_map:
                        active: "success"
                        idle: "default"
                        error: "error"
                    - id: "last_active"
                      header: "Last Active"
                      cell_type: "relative_time"
                    - id: "messages_24h"
                      header: "Messages (24h)"
                      cell_type: "number"

          # Resources Tab
          - type: "VStack"
            id: "tab_resources"
            props:
              tab_id: "resources"
            style:
              gap: "spacing.6"
            children:
              - type: "HStack"
                style:
                  display: "grid"
                  grid_template_columns: "repeat(2, 1fr)"
                  gap: "spacing.semantic.card_gap"
                responsive:
                  md_down:
                    grid_template_columns: "1fr"
                children:
                  - type: "card"
                    children:
                      - type: "Text"
                        props:
                          content: "CPU Usage"
                        style:
                          font_size: "typography.headings.h4.size"
                          font_weight: "typography.headings.h4.weight"
                          margin_bottom: "spacing.4"
                      - type: "chart"
                        props:
                          type: "line"
                          data_source: "tenant_resources.cpu"
                          time_range: "7d"
                          y_axis_label: "%"
                          color: "colors.primary.500"
                  - type: "card"
                    children:
                      - type: "Text"
                        props:
                          content: "Memory Usage"
                        style:
                          font_size: "typography.headings.h4.size"
                          font_weight: "typography.headings.h4.weight"
                          margin_bottom: "spacing.4"
                      - type: "chart"
                        props:
                          type: "line"
                          data_source: "tenant_resources.memory"
                          time_range: "7d"
                          y_axis_label: "MB"
                          color: "colors.secondary.500"
                  - type: "card"
                    children:
                      - type: "Text"
                        props:
                          content: "Disk Usage"
                        style:
                          font_size: "typography.headings.h4.size"
                          font_weight: "typography.headings.h4.weight"
                          margin_bottom: "spacing.4"
                      - type: "chart"
                        props:
                          type: "bar"
                          data_source: "tenant_resources.disk"
                          color: "colors.accent.500"
                  - type: "card"
                    children:
                      - type: "Text"
                        props:
                          content: "Token Consumption"
                        style:
                          font_size: "typography.headings.h4.size"
                          font_weight: "typography.headings.h4.weight"
                          margin_bottom: "spacing.4"
                      - type: "chart"
                        props:
                          type: "line"
                          data_source: "tenant_resources.tokens"
                          time_range: "7d"
                          y_axis_label: "tokens"
                          color: "colors.semantic.warning.main"

          # Audit Tab
          - type: "VStack"
            id: "tab_audit"
            props:
              tab_id: "audit"
            style:
              gap: "spacing.4"
            children:
              - type: "data_table"
                props:
                  data_source: "tenant_audit"
                  paginated: true
                  page_size: 20
                  columns:
                    - id: "timestamp"
                      header: "Time"
                      cell_type: "datetime"
                      font_family: "typography.font_families.monospace.css"
                      width: "160px"
                    - id: "actor"
                      header: "Actor"
                      cell_type: "text"
                    - id: "action"
                      header: "Action"
                      cell_type: "text"
                    - id: "details"
                      header: "Details"
                      cell_type: "truncated_text"
                      max_length: 60

  # ===========================================================================
  # SCREEN 6: Skill Review Queue
  # ===========================================================================
  - id: "platform_admin_skill_review_queue"
    name: "Skill Review Queue"
    route: "/admin/skills/review"
    layout: "sidebar"
    auth_required: true
    role_required: "platform_admin"
    screen_id: "PA-11"
    flow_ref: "1.3"
    sidebar_ref: "platform_admin_sidebar"

    data_sources:
      - id: "pending_skills"
        endpoint: "GET /api/admin/skills/review?status=pending&sort=submitted_at:asc"
      - id: "review_stats"
        endpoint: "GET /api/admin/skills/review/stats"

    components:
      - type: "page_header"
        props:
          title: "Skill Review Queue"
          description: "Review and approve skill submissions for the marketplace."
          breadcrumbs:
            - label: "Admin"
              href: "/admin"
            - label: "Skill Review"

      - type: "HStack"
        id: "review_stats_row"
        style:
          gap: "spacing.semantic.card_gap"
          margin_bottom: "spacing.semantic.section_gap"
          display: "grid"
          grid_template_columns: "repeat(3, 1fr)"
        responsive:
          md_down:
            grid_template_columns: "1fr"
        children:
          - type: "metric_card"
            props:
              label: "Pending Review"
              value: "{{review_stats.pending}}"
              icon: "Clock"
          - type: "metric_card"
            props:
              label: "Approved This Month"
              value: "{{review_stats.approved_month}}"
              icon: "CheckCircle"
          - type: "metric_card"
            props:
              label: "Rejected This Month"
              value: "{{review_stats.rejected_month}}"
              icon: "XCircle"

      - type: "card"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "0"
        children:
          - type: "data_table"
            id: "review_queue_table"
            props:
              data_source: "pending_skills"
              empty_state:
                icon: "PackageCheck"
                title: "Queue is empty"
                description: "No pending skill submissions to review."
              columns:
                - id: "name"
                  header: "Skill"
                  cell_type: "text_with_subtitle"
                  primary: "{{row.name}}"
                  secondary: "{{row.category}}"
                - id: "submitter"
                  header: "Submitted By"
                  cell_type: "text"
                - id: "submitted_at"
                  header: "Submitted"
                  cell_type: "relative_time"
                  width: "120px"
                - id: "version"
                  header: "Version"
                  cell_type: "text"
                  font_family: "typography.font_families.monospace.css"
                  width: "80px"
                - id: "compatible_roles"
                  header: "Roles"
                  cell_type: "badge_list"
                  variant: "outline"
                  width: "200px"
                - id: "actions"
                  header: ""
                  width: "100px"
                  cell_type: "button"
                  button_label: "Review"
                  button_variant: "primary"
                  button_size: "sm"

    actions:
      - event: "row:click"
        target: "review_queue_table"
        handler: "navigate:/admin/skills/review/{{row.id}}"

  # ===========================================================================
  # SCREEN 7: Skill Review Detail
  # ===========================================================================
  - id: "platform_admin_skill_review_detail"
    name: "Skill Review Detail"
    route: "/admin/skills/review/:id"
    layout: "sidebar"
    auth_required: true
    role_required: "platform_admin"
    screen_id: "PA-12"
    flow_ref: "1.3"
    sidebar_ref: "platform_admin_sidebar"

    data_sources:
      - id: "skill"
        endpoint: "GET /api/admin/skills/review/:id"

    components:
      - type: "page_header"
        props:
          title: "{{skill.name}}"
          description: "Review submission v{{skill.version}} by {{skill.submitter}}"
          breadcrumbs:
            - label: "Admin"
              href: "/admin"
            - label: "Skill Review"
              href: "/admin/skills/review"
            - label: "{{skill.name}}"
        children:
          - type: "HStack"
            style:
              gap: "spacing.3"
            children:
              - type: "Button"
                id: "reject_btn"
                props:
                  content: "Reject"
                  variant: "destructive"
                  size: "md"
                  icon_left: "X"
                actions:
                  - event: "click"
                    handler: "open_modal:rejection_dialog"
              - type: "Button"
                id: "request_revision_btn"
                props:
                  content: "Request Revision"
                  variant: "secondary"
                  size: "md"
                  icon_left: "MessageSquare"
                actions:
                  - event: "click"
                    handler: "open_modal:revision_dialog"
              - type: "Button"
                id: "approve_btn"
                props:
                  content: "Approve & Publish"
                  variant: "primary"
                  size: "md"
                  icon_left: "Check"
                  disabled_when: "!security_checklist.all_passed"
                actions:
                  - event: "click"
                    handler: "POST /api/admin/skills/review/:id/approve"
                    on_success: "navigate:/admin/skills/review"

      - type: "HStack"
        style:
          gap: "spacing.semantic.card_gap"
          align_items: "flex-start"
          display: "grid"
          grid_template_columns: "2fr 1fr"
        responsive:
          lg_down:
            grid_template_columns: "1fr"
        children:
          # Left: Code viewer + metadata
          - type: "VStack"
            style:
              gap: "spacing.semantic.card_gap"
            children:
              - type: "card"
                id: "skill_metadata"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Skill Metadata"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "HStack"
                    style:
                      gap: "spacing.8"
                      flex_wrap: "wrap"
                    children:
                      - type: "VStack"
                        style:
                          gap: "spacing.1"
                        children:
                          - type: "Text"
                            props:
                              content: "Category"
                            style:
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.500"
                              text_transform: "uppercase"
                          - type: "badge"
                            props:
                              content: "{{skill.category}}"
                              variant: "primary"
                      - type: "VStack"
                        style:
                          gap: "spacing.1"
                        children:
                          - type: "Text"
                            props:
                              content: "Compatible Roles"
                            style:
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.500"
                              text_transform: "uppercase"
                          - type: "HStack"
                            style:
                              gap: "spacing.1"
                            children:
                              - type: "badge_list"
                                props:
                                  items: "{{skill.compatible_roles}}"
                                  variant: "outline"
                  - type: "Text"
                    props:
                      content: "{{skill.description}}"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.600"
                      line_height: "typography.scale.sm.line_height"
                      margin_top: "spacing.4"

              - type: "card"
                id: "code_viewer_card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Source Code"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "code_editor"
                    id: "skill_code_viewer"
                    props:
                      language: "typescript"
                      value: "{{skill.source_code}}"
                      read_only: true
                      line_numbers: true
                    style:
                      font_family: "typography.font_families.monospace.css"
                      font_size: "typography.scale.sm.size"
                      border: "borders.width.thin solid colors.neutral.200"
                      border_radius: "borders.radius.md"
                      min_height: "400px"
                      max_height: "600px"
                      overflow: "auto"

              - type: "card"
                id: "permission_manifest"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Permission Manifest"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "VStack"
                    style:
                      gap: "spacing.3"
                    children:
                      - type: "HStack"
                        props:
                          for_each: "skill.permissions"
                        style:
                          justify_content: "space-between"
                          padding: "spacing.3"
                          background: "colors.neutral.50"
                          border_radius: "borders.radius.md"
                        children:
                          - type: "HStack"
                            style:
                              gap: "spacing.2"
                              align_items: "center"
                            children:
                              - type: "icon"
                                props:
                                  name: "{{item.icon}}"
                                style:
                                  color: "colors.neutral.500"
                                  size: "16px"
                              - type: "Text"
                                props:
                                  content: "{{item.label}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.700"
                          - type: "badge"
                            props:
                              content: "{{item.access_level}}"
                              variant: "{{item.access_level === 'full' ? 'warning' : 'default'}}"

          # Right: Security checklist
          - type: "card"
            id: "security_checklist_card"
            style:
              background: "components.card.variants.default.bg"
              border: "components.card.variants.default.border"
              border_radius: "components.card.variants.default.border_radius"
              padding: "components.card.variants.default.padding"
              position: "sticky"
              top: "spacing.6"
            children:
              - type: "Text"
                props:
                  content: "Security Checklist"
                style:
                  font_size: "typography.headings.h3.size"
                  font_weight: "typography.headings.h3.weight"
                  color: "colors.neutral.900"
                  margin_bottom: "spacing.5"
              - type: "VStack"
                id: "checklist_items"
                style:
                  gap: "spacing.4"
                children:
                  - type: "checklist_item"
                    props:
                      id: "no_undeclared_network"
                      label: "No undeclared outbound network calls"
                      description: "All network requests go to declared domains only."
                    style:
                      padding: "spacing.3"
                      border_radius: "borders.radius.md"
                      background_checked: "colors.semantic.success.light"
                      background_unchecked: "colors.neutral.50"
                  - type: "checklist_item"
                    props:
                      id: "no_filesystem_escape"
                      label: "No filesystem access outside workspace"
                      description: "File operations restricted to agent workspace."
                  - type: "checklist_item"
                    props:
                      id: "no_credential_harvesting"
                      label: "No credential harvesting patterns"
                      description: "No attempts to read env vars, tokens, or secrets."
                  - type: "checklist_item"
                    props:
                      id: "documentation_complete"
                      label: "Documentation complete"
                      description: "Usage examples, API docs, and changelog provided."
                  - type: "checklist_item"
                    props:
                      id: "version_valid"
                      label: "Version number valid"
                      description: "Follows semver and does not conflict with existing."

      # Rejection Dialog
      - type: "modal"
        id: "rejection_dialog"
        props:
          title: "Reject Skill Submission"
          trigger: "reject_btn"
        style:
          overlay:
            background: "components.modal.overlay.bg"
            backdrop_filter: "components.modal.overlay.backdrop_filter"
          container:
            background: "components.modal.container.bg"
            border_radius: "components.modal.container.border_radius"
            shadow: "components.modal.container.shadow"
            padding: "components.modal.container.padding"
            max_width: "components.modal.container.max_width"
        children:
          - type: "form_field"
            props:
              label: "Rejection Reason"
              type: "select"
              required: true
              options:
                - label: "Undeclared network access"
                  value: "network_access"
                - label: "Illegal filesystem access"
                  value: "filesystem_access"
                - label: "Security concern: credential access"
                  value: "credential_access"
                - label: "Other security concern"
                  value: "other_security"
          - type: "form_field"
            props:
              label: "Additional Feedback"
              type: "textarea"
              placeholder: "Provide specific feedback to the submitter..."
              rows: 4
          - type: "HStack"
            style:
              justify_content: "flex-end"
              gap: "spacing.3"
              padding_top: "components.modal.footer.padding_top"
              border_top: "components.modal.footer.border_top"
            children:
              - type: "Button"
                props:
                  content: "Cancel"
                  variant: "secondary"
                  size: "md"
                actions:
                  - event: "click"
                    handler: "close_modal:rejection_dialog"
              - type: "Button"
                props:
                  content: "Reject Submission"
                  variant: "destructive"
                  size: "md"
                actions:
                  - event: "click"
                    handler: "POST /api/admin/skills/review/:id/reject"
                    on_success: "navigate:/admin/skills/review"

      # Revision Dialog
      - type: "modal"
        id: "revision_dialog"
        props:
          title: "Request Revision"
        style:
          overlay:
            background: "components.modal.overlay.bg"
          container:
            background: "components.modal.container.bg"
            border_radius: "components.modal.container.border_radius"
            shadow: "components.modal.container.shadow"
            padding: "components.modal.container.padding"
            max_width: "components.modal.container.max_width"
        children:
          - type: "form_field"
            props:
              label: "Revision Notes"
              type: "textarea"
              placeholder: "Describe what needs to be changed..."
              required: true
              rows: 6
          - type: "HStack"
            style:
              justify_content: "flex-end"
              gap: "spacing.3"
              padding_top: "components.modal.footer.padding_top"
              border_top: "components.modal.footer.border_top"
            children:
              - type: "Button"
                props:
                  content: "Cancel"
                  variant: "secondary"
                  size: "md"
                actions:
                  - event: "click"
                    handler: "close_modal:revision_dialog"
              - type: "Button"
                props:
                  content: "Send Revision Request"
                  variant: "primary"
                  size: "md"
                actions:
                  - event: "click"
                    handler: "POST /api/admin/skills/review/:id/revision"
                    on_success: "navigate:/admin/skills/review"

  # ===========================================================================
  # SCREEN 8: Tenant Dashboard Home
  # ===========================================================================
  - id: "tenant_dashboard_home"
    name: "Tenant Dashboard Home"
    route: "/dashboard"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-04"
    flow_ref: "2.1, 3.1"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "dashboard_stats"
        endpoint: "GET /api/dashboard/stats"
        refresh: "30s"
      - id: "agents"
        endpoint: "GET /api/dashboard/agents"
        refresh: "30s"
      - id: "recent_activity"
        endpoint: "GET /api/dashboard/activity?limit=15"
        refresh: "60s"

    components:
      - type: "page_header"
        props:
          title: "Dashboard"
          description: "Monitor your AI agent team and recent activity."
          breadcrumbs:
            - label: "Dashboard"
        children:
          - type: "HStack"
            style:
              gap: "spacing.3"
            children:
              - type: "Button"
                props:
                  content: "Create Agent"
                  variant: "primary"
                  size: "md"
                  icon_left: "Plus"
                  href: "/dashboard/agents/new"
                  visible_when: "current_user.role === 'tenant_admin'"

      - type: "HStack"
        id: "stats_row"
        style:
          display: "grid"
          grid_template_columns: "repeat(4, 1fr)"
          gap: "spacing.semantic.card_gap"
          margin_bottom: "spacing.semantic.section_gap"
        responsive:
          md:
            grid_template_columns: "repeat(2, 1fr)"
          sm:
            grid_template_columns: "1fr"
        children:
          - type: "metric_card"
            props:
              label: "Total Agents"
              value: "{{dashboard_stats.total_agents}}"
              icon: "Bot"
            style:
              background: "components.metric_card.bg"
              border: "components.metric_card.border"
              border_radius: "components.metric_card.border_radius"
              padding: "components.metric_card.padding"
          - type: "metric_card"
            props:
              label: "Active Today"
              value: "{{dashboard_stats.active_today}}"
              icon: "Activity"
          - type: "metric_card"
            props:
              label: "Messages Today"
              value: "{{dashboard_stats.messages_today}}"
              icon: "MessageSquare"
          - type: "metric_card"
            props:
              label: "Est. Daily Cost"
              value: "${{dashboard_stats.estimated_daily_cost}}"
              icon: "DollarSign"

      - type: "HStack"
        id: "main_grid"
        style:
          display: "grid"
          grid_template_columns: "2fr 1fr"
          gap: "spacing.semantic.card_gap"
          align_items: "flex-start"
        responsive:
          lg_down:
            grid_template_columns: "1fr"
        children:
          # Agent Cards Grid
          - type: "card"
            id: "agents_section"
            style:
              background: "components.card.variants.default.bg"
              border: "components.card.variants.default.border"
              border_radius: "components.card.variants.default.border_radius"
              shadow: "components.card.variants.default.shadow"
              padding: "components.card.variants.default.padding"
            children:
              - type: "HStack"
                style:
                  justify_content: "space-between"
                  align_items: "center"
                  margin_bottom: "spacing.5"
                children:
                  - type: "Text"
                    props:
                      content: "Agent Team"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "HStack"
                    style:
                      gap: "spacing.2"
                    children:
                      - type: "select"
                        id: "agent_filter"
                        props:
                          placeholder: "All Roles"
                          size: "sm"
                          options:
                            - label: "PM"
                              value: "pm"
                            - label: "Engineering"
                              value: "engineering"
                            - label: "Operations"
                              value: "operations"
                      - type: "Button"
                        props:
                          content: "View All"
                          variant: "link"
                          size: "sm"
                          href: "/dashboard/agents"

              - type: "card_grid"
                id: "agent_cards"
                props:
                  data_source: "agents"
                  empty_state:
                    icon: "Bot"
                    title: "No agents yet"
                    description: "Create your first AI agent to get started."
                    action_label: "Create Agent"
                    action_href: "/dashboard/agents/new"
                style:
                  display: "grid"
                  grid_template_columns: "repeat(auto-fill, minmax(240px, 1fr))"
                  gap: "spacing.4"
                item_template:
                  type: "card"
                  style:
                    background: "components.card.variants.interactive.bg"
                    border: "components.card.variants.interactive.border"
                    border_radius: "components.card.variants.interactive.border_radius"
                    padding: "spacing.4"
                    cursor: "pointer"
                    transition: "animations.presets.default"
                  states:
                    hover:
                      shadow: "components.card.variants.interactive.hover_shadow"
                      border: "components.card.variants.interactive.hover_border"
                  actions:
                    - event: "click"
                      handler: "navigate:/dashboard/agents/{{item.id}}"
                  children:
                    - type: "HStack"
                      style:
                        justify_content: "space-between"
                        align_items: "flex-start"
                        margin_bottom: "spacing.3"
                      children:
                        - type: "VStack"
                          style:
                            gap: "spacing.1"
                          children:
                            - type: "Text"
                              props:
                                content: "{{item.name}}"
                              style:
                                font_size: "typography.scale.base.size"
                                font_weight: "typography.weights.semibold"
                                color: "colors.neutral.900"
                            - type: "Text"
                              props:
                                content: "{{item.role | titlecase}}"
                              style:
                                font_size: "typography.scale.xs.size"
                                color: "colors.neutral.500"
                        - type: "status_badge"
                          props:
                            status: "{{item.status}}"
                            variant: "dot_with_label"
                            size: "sm"
                          style:
                            active:
                              dot_color: "colors.agent_status.active.dot"
                              bg: "colors.agent_status.active.bg"
                              text: "colors.agent_status.active.text"
                            idle:
                              dot_color: "colors.agent_status.idle.dot"
                              bg: "colors.agent_status.idle.bg"
                              text: "colors.agent_status.idle.text"
                            error:
                              dot_color: "colors.agent_status.error.dot"
                              bg: "colors.agent_status.error.bg"
                              text: "colors.agent_status.error.text"
                    - type: "HStack"
                      style:
                        gap: "spacing.4"
                        margin_top: "spacing.3"
                        padding_top: "spacing.3"
                        border_top: "borders.width.thin solid colors.neutral.100"
                      children:
                        - type: "VStack"
                          style:
                            gap: "spacing.0.5"
                          children:
                            - type: "Text"
                              props:
                                content: "Model"
                              style:
                                font_size: "typography.scale.xs.size"
                                color: "colors.neutral.400"
                            - type: "Text"
                              props:
                                content: "{{item.model | titlecase}}"
                              style:
                                font_size: "typography.scale.sm.size"
                                color: "colors.neutral.700"
                        - type: "VStack"
                          style:
                            gap: "spacing.0.5"
                          children:
                            - type: "Text"
                              props:
                                content: "Last Active"
                              style:
                                font_size: "typography.scale.xs.size"
                                color: "colors.neutral.400"
                            - type: "Text"
                              props:
                                content: "{{item.last_active | relative_time}}"
                              style:
                                font_size: "typography.scale.sm.size"
                                color: "colors.neutral.700"

          # Activity Feed
          - type: "card"
            id: "activity_section"
            style:
              background: "components.card.variants.default.bg"
              border: "components.card.variants.default.border"
              border_radius: "components.card.variants.default.border_radius"
              shadow: "components.card.variants.default.shadow"
              padding: "components.card.variants.default.padding"
            children:
              - type: "Text"
                props:
                  content: "Recent Activity"
                style:
                  font_size: "typography.headings.h3.size"
                  font_weight: "typography.headings.h3.weight"
                  color: "colors.neutral.900"
                  margin_bottom: "spacing.4"
              - type: "activity_feed"
                props:
                  data_source: "recent_activity"
                  empty_state:
                    icon: "Activity"
                    title: "No activity yet"
                    description: "Agent activity will appear here."
                style:
                  gap: "spacing.1"
                item_template:
                  type: "HStack"
                  style:
                    gap: "spacing.3"
                    padding: "spacing.2.5 0"
                    border_bottom: "borders.width.thin solid colors.neutral.100"
                  children:
                    - type: "VStack"
                      style:
                        width: "32px"
                        height: "32px"
                        border_radius: "borders.radius.full"
                        background: "colors.primary.50"
                        align_items: "center"
                        justify_content: "center"
                        flex_shrink: "0"
                      children:
                        - type: "icon"
                          props:
                            name: "{{item.icon}}"
                          style:
                            color: "colors.primary.500"
                            size: "14px"
                    - type: "VStack"
                      style:
                        flex: "1"
                        gap: "spacing.0.5"
                      children:
                        - type: "Text"
                          props:
                            content: "{{item.description}}"
                          style:
                            font_size: "typography.scale.sm.size"
                            color: "colors.neutral.700"
                            line_height: "typography.scale.sm.line_height"
                        - type: "Text"
                          props:
                            content: "{{item.agent_name}} -- {{item.created_at | relative_time}}"
                          style:
                            font_size: "typography.scale.xs.size"
                            color: "colors.neutral.400"

  # ===========================================================================
  # SCREEN 9: Agent List
  # ===========================================================================
  - id: "tenant_agent_list"
    name: "Agent List"
    route: "/dashboard/agents"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-04"
    flow_ref: "2.2, 3.1"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "agents"
        endpoint: "GET /api/dashboard/agents"
        refresh: "30s"

    components:
      - type: "page_header"
        props:
          title: "Agents"
          description: "Manage your AI agent team."
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Agents"
        children:
          - type: "Button"
            props:
              content: "Create Agent"
              variant: "primary"
              size: "md"
              icon_left: "Plus"
              href: "/dashboard/agents/new"
              visible_when: "current_user.role === 'tenant_admin'"

      - type: "card"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "0"
        children:
          - type: "HStack"
            id: "agent_toolbar"
            style:
              padding: "spacing.4"
              gap: "spacing.3"
              border_bottom: "borders.width.thin solid colors.neutral.200"
            children:
              - type: "search_bar"
                props:
                  placeholder: "Search agents..."
                  debounce_ms: 300
                style:
                  flex: "1"
                  min_width: "200px"
              - type: "select"
                props:
                  placeholder: "All Roles"
                  options:
                    - label: "PM"
                      value: "pm"
                    - label: "Engineering"
                      value: "engineering"
                    - label: "Operations"
                      value: "operations"
                    - label: "Custom"
                      value: "custom"
              - type: "select"
                props:
                  placeholder: "All Statuses"
                  options:
                    - label: "Active"
                      value: "active"
                    - label: "Idle"
                      value: "idle"
                    - label: "Error"
                      value: "error"

          - type: "data_table"
            id: "agents_table"
            props:
              data_source: "agents"
              sortable: true
              empty_state:
                icon: "Bot"
                title: "No agents created"
                description: "Create your first agent to start building your AI team."
                action_label: "Create Agent"
                action_href: "/dashboard/agents/new"
              columns:
                - id: "name"
                  header: "Agent"
                  sortable: true
                  cell_type: "text_with_subtitle"
                  primary: "{{row.name}}"
                  secondary: "{{row.description}}"
                  width: "auto"
                - id: "role"
                  header: "Role"
                  sortable: true
                  cell_type: "badge"
                  variant: "primary"
                  width: "120px"
                - id: "model"
                  header: "Model"
                  sortable: true
                  cell_type: "text"
                  width: "100px"
                - id: "status"
                  header: "Status"
                  sortable: true
                  cell_type: "status_badge"
                  width: "120px"
                  variant_map:
                    active: "success"
                    idle: "default"
                    error: "error"
                    provisioning: "info"
                - id: "messages_24h"
                  header: "Messages (24h)"
                  sortable: true
                  cell_type: "number"
                  width: "130px"
                  align: "right"
                - id: "last_active"
                  header: "Last Active"
                  sortable: true
                  cell_type: "relative_time"
                  width: "120px"
                - id: "actions"
                  header: ""
                  width: "60px"
                  cell_type: "actions_menu"
                  items:
                    - label: "View Details"
                      icon: "Eye"
                      action: "navigate:/dashboard/agents/{{row.id}}"
                    - label: "Edit Configuration"
                      icon: "Settings"
                      action: "navigate:/dashboard/agents/{{row.id}}?tab=config"
                    - type: "separator"
                    - label: "Delete Agent"
                      icon: "Trash2"
                      action: "confirm_then:DELETE /api/dashboard/agents/{{row.id}}"
                      variant: "destructive"
                      visible_when: "current_user.role === 'tenant_admin'"

    actions:
      - event: "row:click"
        target: "agents_table"
        handler: "navigate:/dashboard/agents/{{row.id}}"

  # ===========================================================================
  # SCREEN 10: Agent Creation Wizard
  # ===========================================================================
  - id: "tenant_agent_creation_wizard"
    name: "Agent Creation Wizard"
    route: "/dashboard/agents/new"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-05"
    flow_ref: "2.2"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "plan_limits"
        endpoint: "GET /api/dashboard/plan/limits"
      - id: "available_skills"
        endpoint: "GET /api/dashboard/skills?installable=true"

    components:
      - type: "page_header"
        props:
          title: "Create New Agent"
          description: "Set up a new AI agent for your team."
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Agents"
              href: "/dashboard/agents"
            - label: "Create Agent"

      # Plan limit warning
      - type: "VStack"
        id: "plan_limit_warning"
        props:
          visible_when: "plan_limits.agents_remaining === 0"
        style:
          padding: "spacing.4"
          background: "colors.semantic.warning.light"
          border: "borders.width.thin solid colors.semantic.warning.border"
          border_radius: "borders.radius.lg"
          margin_bottom: "spacing.6"
        children:
          - type: "HStack"
            style:
              gap: "spacing.3"
              align_items: "center"
            children:
              - type: "icon"
                props:
                  name: "AlertTriangle"
                style:
                  color: "colors.semantic.warning.main"
                  size: "20px"
              - type: "VStack"
                style:
                  gap: "spacing.1"
                  flex: "1"
                children:
                  - type: "Text"
                    props:
                      content: "Agent limit reached"
                    style:
                      font_size: "typography.scale.sm.size"
                      font_weight: "typography.weights.semibold"
                      color: "colors.semantic.warning.dark"
                  - type: "Text"
                    props:
                      content: "Your current plan allows {{plan_limits.max_agents}} agents. Upgrade your plan or remove an existing agent."
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.semantic.warning.dark"

      - type: "card"
        id: "wizard_container"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "spacing.8"
          max_width: "780px"
        children:
          - type: "wizard"
            id: "agent_wizard"
            props:
              current_step: "{{wizard_state.step}}"
              steps:
                - id: "basic_info"
                  label: "Basic Info"
                - id: "model_selection"
                  label: "Model & Thinking"
                - id: "tool_policy"
                  label: "Tool Policy"
                - id: "channel_binding"
                  label: "Channel"
                - id: "review"
                  label: "Review"
            style:
              step_indicator:
                size: "components.wizard.step_indicator.size"
                font_size: "components.wizard.step_indicator.font_size"
                font_weight: "components.wizard.step_indicator.font_weight"
                border_radius: "components.wizard.step_indicator.border_radius"
                completed:
                  background: "components.wizard.step_indicator.completed.bg"
                  color: "components.wizard.step_indicator.completed.text"
                active:
                  background: "components.wizard.step_indicator.active.bg"
                  color: "components.wizard.step_indicator.active.text"
                upcoming:
                  background: "components.wizard.step_indicator.upcoming.bg"
                  color: "components.wizard.step_indicator.upcoming.text"
              connector:
                color_completed: "components.wizard.connector.color_completed"
                color_upcoming: "components.wizard.connector.color_upcoming"
              content_padding_top: "spacing.8"

            children:
              # Step 1: Basic Info
              - type: "VStack"
                id: "step_basic_info"
                props:
                  visible_when: "wizard_state.step === 0"
                style:
                  gap: "spacing.semantic.form_gap"
                children:
                  - type: "Text"
                    props:
                      content: "Agent Identity"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "form_field"
                    props:
                      label: "Agent Name"
                      type: "text"
                      placeholder: "e.g., Nadia, Atlas, Scout"
                      required: true
                      hint: "Give your agent a memorable name."
                  - type: "form_field"
                    props:
                      label: "Role Type"
                      type: "select"
                      required: true
                      options:
                        - label: "PM (Product Management)"
                          value: "pm"
                          description: "Jira, Amplitude, Tableau, stakeholder comms"
                        - label: "Engineering"
                          value: "engineering"
                          description: "GitHub, Sentry, CI/CD, code review"
                        - label: "Operations"
                          value: "operations"
                          description: "Routing, knowledge base, cross-team coordination"
                        - label: "Custom"
                          value: "custom"
                          description: "Define your own role and tool set"
                      hint: "Role type pre-populates tool policies and skill suggestions."
                  - type: "form_field"
                    props:
                      label: "Description"
                      type: "textarea"
                      placeholder: "Describe what this agent will do and its personality..."
                      rows: 3
                      optional: true
                  - type: "HStack"
                    style:
                      justify_content: "flex-end"
                      padding_top: "spacing.6"
                    children:
                      - type: "Button"
                        props:
                          content: "Continue"
                          variant: "primary"
                          size: "md"
                          icon_right: "ArrowRight"
                        actions:
                          - event: "click"
                            handler: "wizard:next"

              # Step 2: Model & Thinking
              - type: "VStack"
                id: "step_model"
                props:
                  visible_when: "wizard_state.step === 1"
                style:
                  gap: "spacing.semantic.form_gap"
                children:
                  - type: "Text"
                    props:
                      content: "Model & Thinking Configuration"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "card_grid"
                    id: "model_cards"
                    style:
                      display: "grid"
                      grid_template_columns: "repeat(3, 1fr)"
                      gap: "spacing.4"
                    responsive:
                      md_down:
                        grid_template_columns: "1fr"
                    children:
                      - type: "card"
                        props:
                          selectable: true
                          selected_when: "wizard_state.model === 'haiku'"
                        style:
                          background: "components.card.variants.interactive.bg"
                          border: "components.card.variants.interactive.border"
                          padding: "spacing.5"
                          cursor: "pointer"
                          border_radius: "borders.radius.lg"
                        states:
                          selected:
                            border: "borders.width.medium solid colors.primary.500"
                        children:
                          - type: "VStack"
                            style:
                              gap: "spacing.2"
                            children:
                              - type: "Text"
                                props:
                                  content: "Haiku"
                                style:
                                  font_size: "typography.headings.h4.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "Light & Fast"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "~$0.02/msg"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.semantic.success.dark"
                        actions:
                          - event: "click"
                            handler: "wizard:set_model:haiku"
                      - type: "card"
                        props:
                          selectable: true
                          selected_when: "wizard_state.model === 'sonnet'"
                          recommended: true
                        style:
                          background: "components.card.variants.interactive.bg"
                          border: "borders.width.medium solid colors.primary.500"
                          padding: "spacing.5"
                          cursor: "pointer"
                          border_radius: "borders.radius.lg"
                        children:
                          - type: "badge"
                            props:
                              content: "Recommended"
                            style:
                              position: "absolute"
                              top: "-spacing.3"
                              right: "spacing.4"
                              background: "colors.primary.500"
                              color: "colors.neutral.white"
                              font_size: "components.badge.sizes.sm.font_size"
                              padding: "components.badge.sizes.sm.padding_y components.badge.sizes.sm.padding_x"
                              border_radius: "components.badge.sizes.sm.border_radius"
                          - type: "VStack"
                            style:
                              gap: "spacing.2"
                            children:
                              - type: "Text"
                                props:
                                  content: "Sonnet"
                                style:
                                  font_size: "typography.headings.h4.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "Balanced"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "~$0.08/msg"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.semantic.warning.dark"
                        actions:
                          - event: "click"
                            handler: "wizard:set_model:sonnet"
                      - type: "card"
                        props:
                          selectable: true
                          selected_when: "wizard_state.model === 'opus'"
                        style:
                          background: "components.card.variants.interactive.bg"
                          border: "components.card.variants.interactive.border"
                          padding: "spacing.5"
                          cursor: "pointer"
                          border_radius: "borders.radius.lg"
                        children:
                          - type: "VStack"
                            style:
                              gap: "spacing.2"
                            children:
                              - type: "Text"
                                props:
                                  content: "Opus"
                                style:
                                  font_size: "typography.headings.h4.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "Advanced Reasoning"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "~$0.25/msg"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.semantic.error.dark"
                        actions:
                          - event: "click"
                            handler: "wizard:set_model:opus"

                  - type: "form_field"
                    props:
                      label: "Thinking Mode"
                      type: "select"
                      options:
                        - label: "Off -- Fastest responses"
                          value: "off"
                        - label: "Low -- Light reasoning"
                          value: "low"
                        - label: "High -- Deep analysis"
                          value: "high"
                      hint: "Higher thinking modes increase quality but also cost."

                  - type: "card"
                    id: "cost_estimate"
                    style:
                      background: "colors.neutral.50"
                      border: "borders.width.thin solid colors.neutral.200"
                      border_radius: "borders.radius.md"
                      padding: "spacing.4"
                    children:
                      - type: "HStack"
                        style:
                          justify_content: "space-between"
                          align_items: "center"
                        children:
                          - type: "Text"
                            props:
                              content: "Estimated daily cost (50 msgs/day)"
                            style:
                              font_size: "typography.scale.sm.size"
                              color: "colors.neutral.600"
                          - type: "Text"
                            props:
                              content: "${{wizard_state.estimated_daily_cost}}"
                            style:
                              font_size: "typography.scale.lg.size"
                              font_weight: "typography.weights.bold"
                              color: "colors.neutral.900"

                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      padding_top: "spacing.6"
                    children:
                      - type: "Button"
                        props:
                          content: "Back"
                          variant: "secondary"
                          size: "md"
                          icon_left: "ArrowLeft"
                        actions:
                          - event: "click"
                            handler: "wizard:prev"
                      - type: "Button"
                        props:
                          content: "Continue"
                          variant: "primary"
                          size: "md"
                          icon_right: "ArrowRight"
                        actions:
                          - event: "click"
                            handler: "wizard:next"

              # Step 3: Tool Policy
              - type: "VStack"
                id: "step_tool_policy"
                props:
                  visible_when: "wizard_state.step === 2"
                style:
                  gap: "spacing.semantic.form_gap"
                children:
                  - type: "Text"
                    props:
                      content: "Tool Policy Configuration"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "Text"
                    props:
                      content: "Control which tools this agent can access. Defaults are pre-populated based on the selected role."
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"
                      margin_bottom: "spacing.2"
                  - type: "data_table"
                    id: "tool_policy_grid"
                    props:
                      data_source: "tool_categories"
                      columns:
                        - id: "category"
                          header: "Tool Category"
                          cell_type: "text_with_subtitle"
                          primary: "{{row.name}}"
                          secondary: "{{row.description}}"
                          width: "auto"
                        - id: "read"
                          header: "Read"
                          cell_type: "checkbox"
                          width: "80px"
                          align: "center"
                        - id: "write"
                          header: "Write"
                          cell_type: "checkbox"
                          width: "80px"
                          align: "center"
                        - id: "execute"
                          header: "Execute"
                          cell_type: "checkbox"
                          width: "80px"
                          align: "center"
                    style:
                      header:
                        background: "components.table.header.bg"
                        font_size: "components.table.header.font_size"
                        font_weight: "components.table.header.font_weight"
                        text_transform: "components.table.header.text_transform"
                      row:
                        padding: "spacing.3 spacing.4"
                        border_bottom: "components.table.row.border_bottom"

                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      padding_top: "spacing.6"
                    children:
                      - type: "Button"
                        props:
                          content: "Back"
                          variant: "secondary"
                          size: "md"
                          icon_left: "ArrowLeft"
                        actions:
                          - event: "click"
                            handler: "wizard:prev"
                      - type: "Button"
                        props:
                          content: "Continue"
                          variant: "primary"
                          size: "md"
                          icon_right: "ArrowRight"
                        actions:
                          - event: "click"
                            handler: "wizard:next"

              # Step 4: Channel Binding
              - type: "VStack"
                id: "step_channel"
                props:
                  visible_when: "wizard_state.step === 3"
                style:
                  gap: "spacing.semantic.form_gap"
                children:
                  - type: "Text"
                    props:
                      content: "Communication Channel"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "Text"
                    props:
                      content: "Connect a messaging channel so your team can interact with this agent. You can skip this and configure later."
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"
                  - type: "HStack"
                    id: "channel_options"
                    style:
                      display: "grid"
                      grid_template_columns: "repeat(2, 1fr)"
                      gap: "spacing.4"
                    children:
                      - type: "card"
                        props:
                          selectable: true
                          selected_when: "wizard_state.channel === 'telegram'"
                        style:
                          background: "components.card.variants.interactive.bg"
                          border: "components.card.variants.interactive.border"
                          border_radius: "borders.radius.lg"
                          padding: "spacing.5"
                          cursor: "pointer"
                          text_align: "center"
                        states:
                          selected:
                            border: "borders.width.medium solid colors.primary.500"
                        children:
                          - type: "icon"
                            props:
                              name: "Send"
                            style:
                              color: "colors.primary.500"
                              size: "32px"
                              margin_bottom: "spacing.2"
                          - type: "Text"
                            props:
                              content: "Telegram"
                            style:
                              font_size: "typography.scale.base.size"
                              font_weight: "typography.weights.semibold"
                              color: "colors.neutral.900"
                        actions:
                          - event: "click"
                            handler: "wizard:set_channel:telegram"
                      - type: "card"
                        props:
                          selectable: true
                          selected_when: "wizard_state.channel === 'slack'"
                        style:
                          background: "components.card.variants.interactive.bg"
                          border: "components.card.variants.interactive.border"
                          border_radius: "borders.radius.lg"
                          padding: "spacing.5"
                          cursor: "pointer"
                          text_align: "center"
                        children:
                          - type: "icon"
                            props:
                              name: "Hash"
                            style:
                              color: "colors.primary.500"
                              size: "32px"
                              margin_bottom: "spacing.2"
                          - type: "Text"
                            props:
                              content: "Slack"
                            style:
                              font_size: "typography.scale.base.size"
                              font_weight: "typography.weights.semibold"
                              color: "colors.neutral.900"
                        actions:
                          - event: "click"
                            handler: "wizard:set_channel:slack"
                  - type: "VStack"
                    id: "telegram_config"
                    props:
                      visible_when: "wizard_state.channel === 'telegram'"
                    style:
                      gap: "spacing.semantic.form_gap"
                    children:
                      - type: "form_field"
                        props:
                          label: "Bot Token"
                          type: "password"
                          placeholder: "Enter your Telegram Bot Token"
                          required: true
                          hint: "Get this from @BotFather on Telegram."
                      - type: "form_field"
                        props:
                          label: "Chat ID"
                          type: "text"
                          placeholder: "Target group or user chat ID"
                          required: true
                  - type: "VStack"
                    id: "slack_config"
                    props:
                      visible_when: "wizard_state.channel === 'slack'"
                    style:
                      gap: "spacing.semantic.form_gap"
                    children:
                      - type: "Button"
                        props:
                          content: "Connect Slack Workspace"
                          variant: "secondary"
                          size: "lg"
                          icon_left: "ExternalLink"
                          full_width: true
                        actions:
                          - event: "click"
                            handler: "oauth:slack"

                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      padding_top: "spacing.6"
                    children:
                      - type: "Button"
                        props:
                          content: "Back"
                          variant: "secondary"
                          size: "md"
                          icon_left: "ArrowLeft"
                        actions:
                          - event: "click"
                            handler: "wizard:prev"
                      - type: "HStack"
                        style:
                          gap: "spacing.3"
                        children:
                          - type: "Button"
                            props:
                              content: "Skip for Now"
                              variant: "ghost"
                              size: "md"
                            actions:
                              - event: "click"
                                handler: "wizard:next"
                          - type: "Button"
                            props:
                              content: "Continue"
                              variant: "primary"
                              size: "md"
                              icon_right: "ArrowRight"
                            actions:
                              - event: "click"
                                handler: "wizard:validate_channel_then_next"

              # Step 5: Review
              - type: "VStack"
                id: "step_review"
                props:
                  visible_when: "wizard_state.step === 4"
                style:
                  gap: "spacing.6"
                children:
                  - type: "Text"
                    props:
                      content: "Review Agent Configuration"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "card"
                    style:
                      background: "colors.neutral.50"
                      border: "borders.width.thin solid colors.neutral.200"
                      border_radius: "borders.radius.lg"
                      padding: "spacing.5"
                    children:
                      - type: "VStack"
                        style:
                          gap: "spacing.4"
                        children:
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                              padding_bottom: "spacing.3"
                              border_bottom: "borders.width.thin solid colors.neutral.200"
                            children:
                              - type: "Text"
                                props:
                                  content: "Name"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{wizard_state.name}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                              padding_bottom: "spacing.3"
                              border_bottom: "borders.width.thin solid colors.neutral.200"
                            children:
                              - type: "Text"
                                props:
                                  content: "Role"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "badge"
                                props:
                                  content: "{{wizard_state.role | titlecase}}"
                                  variant: "primary"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                              padding_bottom: "spacing.3"
                              border_bottom: "borders.width.thin solid colors.neutral.200"
                            children:
                              - type: "Text"
                                props:
                                  content: "Model"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{wizard_state.model | titlecase}} (Thinking: {{wizard_state.thinking_mode}})"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                              padding_bottom: "spacing.3"
                              border_bottom: "borders.width.thin solid colors.neutral.200"
                            children:
                              - type: "Text"
                                props:
                                  content: "Channel"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{wizard_state.channel | titlecase | default:'Not configured'}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Est. Daily Cost"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "${{wizard_state.estimated_daily_cost}}"
                                style:
                                  font_size: "typography.scale.base.size"
                                  font_weight: "typography.weights.bold"
                                  color: "colors.primary.500"

                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      padding_top: "spacing.4"
                    children:
                      - type: "Button"
                        props:
                          content: "Back"
                          variant: "secondary"
                          size: "md"
                          icon_left: "ArrowLeft"
                        actions:
                          - event: "click"
                            handler: "wizard:prev"
                      - type: "Button"
                        props:
                          content: "Create Agent"
                          variant: "primary"
                          size: "lg"
                          icon_left: "Sparkles"
                          loading_text: "Creating..."
                        actions:
                          - event: "click"
                            handler: "POST /api/dashboard/agents"
                            on_success: "navigate:/dashboard/agents/{{new_agent.id}}"
                            on_error: "show_toast:error"

  # ===========================================================================
  # SCREEN 11: Agent Detail
  # ===========================================================================
  - id: "tenant_agent_detail"
    name: "Agent Detail"
    route: "/dashboard/agents/:id"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-06"
    flow_ref: "2.2, 2.3, 3.1"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "agent"
        endpoint: "GET /api/dashboard/agents/:id"
        refresh: "30s"
      - id: "agent_activity"
        endpoint: "GET /api/dashboard/agents/:id/activity?limit=20"
        refresh: "60s"
      - id: "agent_skills"
        endpoint: "GET /api/dashboard/agents/:id/skills"
      - id: "agent_metrics"
        endpoint: "GET /api/dashboard/agents/:id/metrics?range=7d"
        refresh: "60s"

    components:
      - type: "page_header"
        props:
          title: "{{agent.name}}"
          description: "{{agent.role | titlecase}} Agent -- {{agent.model | titlecase}} Model"
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Agents"
              href: "/dashboard/agents"
            - label: "{{agent.name}}"
        children:
          - type: "HStack"
            style:
              gap: "spacing.3"
              align_items: "center"
            children:
              - type: "status_badge"
                props:
                  status: "{{agent.status}}"
                  size: "lg"
              - type: "Button"
                props:
                  content: "Edit"
                  variant: "secondary"
                  size: "md"
                  icon_left: "Pencil"
                  visible_when: "current_user.role === 'tenant_admin'"
                actions:
                  - event: "click"
                    handler: "navigate:/dashboard/agents/{{agent.id}}/edit"
              - type: "dropdown_menu"
                props:
                  trigger_icon: "MoreVertical"
                  trigger_variant: "ghost"
                  items:
                    - label: "View Logs"
                      icon: "FileText"
                      action: "open_modal:agent_logs"
                    - label: "Restart Agent"
                      icon: "RotateCcw"
                      action: "confirm_then:POST /api/dashboard/agents/:id/restart"
                    - type: "separator"
                    - label: "Delete Agent"
                      icon: "Trash2"
                      action: "confirm_then:DELETE /api/dashboard/agents/:id"
                      variant: "destructive"

      - type: "tabs"
        id: "agent_tabs"
        props:
          default_tab: "info"
          tabs:
            - id: "info"
              label: "Info"
              icon: "Info"
            - id: "activity"
              label: "Activity"
              icon: "Activity"
            - id: "skills"
              label: "Skills"
              icon: "Puzzle"
              badge: "{{agent_skills.length}}"
            - id: "status"
              label: "Status"
              icon: "HeartPulse"
        style:
          tab_list:
            border_bottom: "borders.width.thin solid colors.neutral.200"
          tab:
            padding: "spacing.3 spacing.4"
            font_size: "typography.scale.sm.size"
            font_weight: "typography.weights.medium"
            color: "colors.neutral.500"
            border_bottom: "borders.width.medium solid transparent"
          tab_active:
            color: "colors.primary.500"
            border_bottom: "borders.width.medium solid colors.primary.500"
          tab_content:
            padding_top: "spacing.6"

        children:
          # Info Tab
          - type: "VStack"
            props:
              tab_id: "info"
            style:
              gap: "spacing.6"
            children:
              - type: "HStack"
                style:
                  display: "grid"
                  grid_template_columns: "1fr 1fr"
                  gap: "spacing.semantic.card_gap"
                responsive:
                  md_down:
                    grid_template_columns: "1fr"
                children:
                  - type: "card"
                    style:
                      background: "components.card.variants.default.bg"
                      border: "components.card.variants.default.border"
                      border_radius: "components.card.variants.default.border_radius"
                      padding: "components.card.variants.default.padding"
                    children:
                      - type: "Text"
                        props:
                          content: "Configuration"
                        style:
                          font_size: "typography.headings.h3.size"
                          font_weight: "typography.headings.h3.weight"
                          color: "colors.neutral.900"
                          margin_bottom: "spacing.4"
                      - type: "VStack"
                        style:
                          gap: "spacing.3"
                        children:
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Role"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "badge"
                                props:
                                  content: "{{agent.role | titlecase}}"
                                  variant: "primary"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Model"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{agent.model | titlecase}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Thinking Mode"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{agent.thinking_mode | titlecase}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Channel"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{agent.channel_type | titlecase | default:'Not connected'}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.900"
                  - type: "card"
                    style:
                      background: "components.card.variants.default.bg"
                      border: "components.card.variants.default.border"
                      border_radius: "components.card.variants.default.border_radius"
                      padding: "components.card.variants.default.padding"
                    children:
                      - type: "Text"
                        props:
                          content: "Usage (Last 7 Days)"
                        style:
                          font_size: "typography.headings.h3.size"
                          font_weight: "typography.headings.h3.weight"
                          color: "colors.neutral.900"
                          margin_bottom: "spacing.4"
                      - type: "VStack"
                        style:
                          gap: "spacing.3"
                        children:
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Messages Processed"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{agent_metrics.messages_7d}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Tool Invocations"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "{{agent_metrics.tool_calls_7d}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.semibold"
                                  color: "colors.neutral.900"
                          - type: "HStack"
                            style:
                              justify_content: "space-between"
                            children:
                              - type: "Text"
                                props:
                                  content: "Estimated Cost"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                              - type: "Text"
                                props:
                                  content: "${{agent_metrics.cost_7d}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.bold"
                                  color: "colors.primary.500"

          # Activity Tab
          - type: "VStack"
            props:
              tab_id: "activity"
            style:
              gap: "spacing.4"
            children:
              - type: "HStack"
                style:
                  display: "grid"
                  grid_template_columns: "1fr 1fr"
                  gap: "spacing.semantic.card_gap"
                  margin_bottom: "spacing.4"
                children:
                  - type: "card"
                    children:
                      - type: "Text"
                        props:
                          content: "Messages per Day"
                        style:
                          font_size: "typography.headings.h4.size"
                          font_weight: "typography.headings.h4.weight"
                          margin_bottom: "spacing.3"
                      - type: "chart"
                        props:
                          type: "sparkline"
                          data_source: "agent_metrics.messages_daily"
                          color: "colors.primary.500"
                          height: "80px"
                  - type: "card"
                    children:
                      - type: "Text"
                        props:
                          content: "Tool Calls per Day"
                        style:
                          font_size: "typography.headings.h4.size"
                          font_weight: "typography.headings.h4.weight"
                          margin_bottom: "spacing.3"
                      - type: "chart"
                        props:
                          type: "sparkline"
                          data_source: "agent_metrics.tools_daily"
                          color: "colors.secondary.500"
                          height: "80px"
              - type: "activity_feed"
                id: "agent_activity_feed"
                props:
                  data_source: "agent_activity"
                  paginated: true
                  page_size: 20
                style:
                  gap: "spacing.1"
                item_template:
                  type: "HStack"
                  style:
                    gap: "spacing.3"
                    padding: "spacing.3"
                    border_bottom: "borders.width.thin solid colors.neutral.100"
                    border_radius: "borders.radius.md"
                  children:
                    - type: "icon"
                      props:
                        name: "{{item.icon}}"
                      style:
                        color: "colors.neutral.400"
                        size: "16px"
                        margin_top: "spacing.0.5"
                    - type: "VStack"
                      style:
                        flex: "1"
                        gap: "spacing.0.5"
                      children:
                        - type: "Text"
                          props:
                            content: "{{item.description}}"
                          style:
                            font_size: "typography.scale.sm.size"
                            color: "colors.neutral.700"
                        - type: "Text"
                          props:
                            content: "{{item.created_at | datetime}}"
                          style:
                            font_size: "typography.scale.xs.size"
                            color: "colors.neutral.400"
                            font_family: "typography.font_families.monospace.css"

          # Skills Tab
          - type: "VStack"
            props:
              tab_id: "skills"
            style:
              gap: "spacing.4"
            children:
              - type: "HStack"
                style:
                  justify_content: "space-between"
                  margin_bottom: "spacing.2"
                children:
                  - type: "Text"
                    props:
                      content: "Installed Skills"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "Button"
                    props:
                      content: "Add Skill"
                      variant: "primary"
                      size: "sm"
                      icon_left: "Plus"
                      href: "/dashboard/skills"
                      visible_when: "current_user.role === 'tenant_admin'"
              - type: "card_grid"
                props:
                  data_source: "agent_skills"
                  empty_state:
                    icon: "Puzzle"
                    title: "No skills installed"
                    description: "Browse the marketplace to find skills for this agent."
                    action_label: "Browse Marketplace"
                    action_href: "/dashboard/skills"
                style:
                  display: "grid"
                  grid_template_columns: "repeat(auto-fill, minmax(280px, 1fr))"
                  gap: "spacing.4"
                item_template:
                  type: "card"
                  style:
                    background: "components.card.variants.default.bg"
                    border: "components.card.variants.default.border"
                    border_radius: "components.card.variants.default.border_radius"
                    padding: "spacing.4"
                  children:
                    - type: "HStack"
                      style:
                        justify_content: "space-between"
                        align_items: "flex-start"
                      children:
                        - type: "VStack"
                          style:
                            gap: "spacing.1"
                          children:
                            - type: "Text"
                              props:
                                content: "{{item.name}}"
                              style:
                                font_size: "typography.scale.base.size"
                                font_weight: "typography.weights.semibold"
                                color: "colors.neutral.900"
                            - type: "Text"
                              props:
                                content: "v{{item.version}}"
                              style:
                                font_size: "typography.scale.xs.size"
                                color: "colors.neutral.400"
                                font_family: "typography.font_families.monospace.css"
                        - type: "dropdown_menu"
                          props:
                            trigger_icon: "MoreHorizontal"
                            trigger_variant: "ghost"
                            trigger_size: "sm"
                            items:
                              - label: "View Details"
                                icon: "Eye"
                                action: "navigate:/dashboard/skills/{{item.id}}"
                              - label: "Uninstall"
                                icon: "Trash2"
                                action: "confirm_then:DELETE /api/dashboard/agents/:id/skills/{{item.id}}"
                                variant: "destructive"
                    - type: "Text"
                      props:
                        content: "{{item.description}}"
                      style:
                        font_size: "typography.scale.sm.size"
                        color: "colors.neutral.500"
                        margin_top: "spacing.2"
                        line_height: "typography.scale.sm.line_height"

          # Status Tab
          - type: "VStack"
            props:
              tab_id: "status"
            style:
              gap: "spacing.6"
            children:
              - type: "HStack"
                style:
                  display: "grid"
                  grid_template_columns: "repeat(3, 1fr)"
                  gap: "spacing.semantic.card_gap"
                responsive:
                  md_down:
                    grid_template_columns: "1fr"
                children:
                  - type: "metric_card"
                    props:
                      label: "Status"
                      value: "{{agent.status | titlecase}}"
                      icon: "HeartPulse"
                  - type: "metric_card"
                    props:
                      label: "Uptime"
                      value: "{{agent.uptime}}"
                      icon: "Clock"
                  - type: "metric_card"
                    props:
                      label: "Error Count (24h)"
                      value: "{{agent_metrics.errors_24h}}"
                      icon: "AlertTriangle"

  # ===========================================================================
  # SCREEN 12: Skill Marketplace
  # ===========================================================================
  - id: "tenant_skill_marketplace"
    name: "Skill Marketplace"
    route: "/dashboard/skills"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-08"
    flow_ref: "2.3"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "skills"
        endpoint: "GET /api/dashboard/skills"
        params:
          category: "{{filters.category}}"
          role: "{{filters.role}}"
          search: "{{search.query}}"
      - id: "installed_skills"
        endpoint: "GET /api/dashboard/skills/installed"

    components:
      - type: "page_header"
        props:
          title: "Skill Marketplace"
          description: "Browse and install verified skills to extend your agents' capabilities."
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Skill Marketplace"

      - type: "HStack"
        id: "marketplace_toolbar"
        style:
          gap: "spacing.4"
          margin_bottom: "spacing.6"
          flex_wrap: "wrap"
        children:
          - type: "search_bar"
            props:
              placeholder: "Search skills..."
              icon: "Search"
              debounce_ms: 300
            style:
              flex: "1"
              min_width: "280px"
              input:
                height: "components.input.sizes.md.height"
                font_size: "components.input.sizes.md.font_size"
                background: "components.input.default.bg"
                border: "components.input.default.border"
                border_radius: "components.input.default.border_radius"
          - type: "HStack"
            style:
              gap: "spacing.2"
            children:
              - type: "select"
                props:
                  placeholder: "All Categories"
                  options:
                    - label: "Productivity"
                      value: "productivity"
                    - label: "Analytics"
                      value: "analytics"
                    - label: "Engineering"
                      value: "engineering"
                    - label: "Communication"
                      value: "communication"
              - type: "select"
                props:
                  placeholder: "All Roles"
                  options:
                    - label: "PM"
                      value: "pm"
                    - label: "Engineering"
                      value: "engineering"
                    - label: "Operations"
                      value: "operations"

      - type: "card_grid"
        id: "skills_grid"
        props:
          data_source: "skills"
          empty_state:
            icon: "Puzzle"
            title: "No skills found"
            description: "Try adjusting your search or filters."
        style:
          display: "grid"
          grid_template_columns: "repeat(auto-fill, minmax(300px, 1fr))"
          gap: "spacing.semantic.card_gap"
        item_template:
          type: "card"
          style:
            background: "components.card.variants.interactive.bg"
            border: "components.card.variants.interactive.border"
            border_radius: "components.card.variants.interactive.border_radius"
            padding: "spacing.5"
            cursor: "pointer"
            transition: "animations.presets.default"
          states:
            hover:
              shadow: "components.card.variants.interactive.hover_shadow"
              border: "components.card.variants.interactive.hover_border"
          actions:
            - event: "click"
              handler: "navigate:/dashboard/skills/{{item.id}}"
          children:
            - type: "HStack"
              style:
                justify_content: "space-between"
                align_items: "flex-start"
                margin_bottom: "spacing.3"
              children:
                - type: "HStack"
                  style:
                    gap: "spacing.3"
                    align_items: "center"
                  children:
                    - type: "VStack"
                      style:
                        width: "40px"
                        height: "40px"
                        border_radius: "borders.radius.lg"
                        background: "colors.primary.50"
                        align_items: "center"
                        justify_content: "center"
                      children:
                        - type: "icon"
                          props:
                            name: "{{item.icon}}"
                          style:
                            color: "colors.primary.500"
                            size: "20px"
                    - type: "VStack"
                      style:
                        gap: "spacing.0.5"
                      children:
                        - type: "Text"
                          props:
                            content: "{{item.name}}"
                          style:
                            font_size: "typography.scale.base.size"
                            font_weight: "typography.weights.semibold"
                            color: "colors.neutral.900"
                        - type: "Text"
                          props:
                            content: "v{{item.version}}"
                          style:
                            font_size: "typography.scale.xs.size"
                            color: "colors.neutral.400"
                            font_family: "typography.font_families.monospace.css"
                - type: "badge"
                  props:
                    content: "{{item.category}}"
                    variant: "primary"
                    size: "sm"
            - type: "Text"
              props:
                content: "{{item.description}}"
              style:
                font_size: "typography.scale.sm.size"
                color: "colors.neutral.600"
                line_height: "typography.scale.sm.line_height"
                margin_bottom: "spacing.3"
            - type: "HStack"
              style:
                justify_content: "space-between"
                align_items: "center"
                padding_top: "spacing.3"
                border_top: "borders.width.thin solid colors.neutral.100"
              children:
                - type: "HStack"
                  style:
                    gap: "spacing.1"
                  children:
                    - type: "badge_list"
                      props:
                        items: "{{item.compatible_roles}}"
                        variant: "outline"
                        size: "sm"
                - type: "Text"
                  props:
                    content: "{{item.install_count}} installs"
                  style:
                    font_size: "typography.scale.xs.size"
                    color: "colors.neutral.400"

  # ===========================================================================
  # SCREEN 13: Skill Detail
  # ===========================================================================
  - id: "tenant_skill_detail"
    name: "Skill Detail"
    route: "/dashboard/skills/:id"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-09"
    flow_ref: "2.3"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "skill"
        endpoint: "GET /api/dashboard/skills/:id"
      - id: "agents"
        endpoint: "GET /api/dashboard/agents"

    components:
      - type: "page_header"
        props:
          title: "{{skill.name}}"
          description: "{{skill.category}} -- v{{skill.version}}"
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Skill Marketplace"
              href: "/dashboard/skills"
            - label: "{{skill.name}}"
        children:
          - type: "Button"
            id: "install_btn"
            props:
              content: "{{skill.is_installed ? 'Installed' : 'Install Skill'}}"
              variant: "{{skill.is_installed ? 'secondary' : 'primary'}}"
              size: "md"
              icon_left: "{{skill.is_installed ? 'Check' : 'Download'}}"
              disabled: "{{skill.is_installed}}"
              visible_when: "current_user.role === 'tenant_admin'"
            actions:
              - event: "click"
                handler: "open_modal:install_modal"

      - type: "HStack"
        style:
          display: "grid"
          grid_template_columns: "2fr 1fr"
          gap: "spacing.semantic.card_gap"
          align_items: "flex-start"
        responsive:
          lg_down:
            grid_template_columns: "1fr"
        children:
          - type: "VStack"
            style:
              gap: "spacing.semantic.card_gap"
            children:
              - type: "card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Description"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "Text"
                    props:
                      content: "{{skill.full_description}}"
                    style:
                      font_size: "typography.scale.base.size"
                      color: "colors.neutral.700"
                      line_height: "typography.scale.base.line_height"

              - type: "card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Permissions Required"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "VStack"
                    style:
                      gap: "spacing.2"
                    children:
                      - type: "HStack"
                        props:
                          for_each: "skill.permissions"
                        style:
                          gap: "spacing.2"
                          padding: "spacing.3"
                          background: "colors.neutral.50"
                          border_radius: "borders.radius.md"
                        children:
                          - type: "icon"
                            props:
                              name: "{{item.icon}}"
                            style:
                              color: "colors.neutral.500"
                              size: "16px"
                          - type: "Text"
                            props:
                              content: "{{item.label}}: {{item.description}}"
                            style:
                              font_size: "typography.scale.sm.size"
                              color: "colors.neutral.700"

              - type: "card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Changelog"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "VStack"
                    style:
                      gap: "spacing.3"
                    children:
                      - type: "VStack"
                        props:
                          for_each: "skill.changelog"
                        style:
                          padding_bottom: "spacing.3"
                          border_bottom: "borders.width.thin solid colors.neutral.100"
                        children:
                          - type: "HStack"
                            style:
                              gap: "spacing.2"
                              margin_bottom: "spacing.1"
                            children:
                              - type: "Text"
                                props:
                                  content: "v{{item.version}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.semibold"
                                  font_family: "typography.font_families.monospace.css"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "{{item.date}}"
                                style:
                                  font_size: "typography.scale.xs.size"
                                  color: "colors.neutral.400"
                          - type: "Text"
                            props:
                              content: "{{item.description}}"
                            style:
                              font_size: "typography.scale.sm.size"
                              color: "colors.neutral.600"

          # Sidebar info
          - type: "VStack"
            style:
              gap: "spacing.semantic.card_gap"
            children:
              - type: "card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Details"
                    style:
                      font_size: "typography.headings.h4.size"
                      font_weight: "typography.headings.h4.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.4"
                  - type: "VStack"
                    style:
                      gap: "spacing.3"
                    children:
                      - type: "VStack"
                        style:
                          gap: "spacing.1"
                        children:
                          - type: "Text"
                            props:
                              content: "Category"
                            style:
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.500"
                              text_transform: "uppercase"
                          - type: "badge"
                            props:
                              content: "{{skill.category}}"
                              variant: "primary"
                      - type: "VStack"
                        style:
                          gap: "spacing.1"
                        children:
                          - type: "Text"
                            props:
                              content: "Compatible Roles"
                            style:
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.500"
                              text_transform: "uppercase"
                          - type: "HStack"
                            style:
                              gap: "spacing.1"
                              flex_wrap: "wrap"
                            children:
                              - type: "badge_list"
                                props:
                                  items: "{{skill.compatible_roles}}"
                                  variant: "outline"
                                  size: "sm"
                      - type: "VStack"
                        style:
                          gap: "spacing.1"
                        children:
                          - type: "Text"
                            props:
                              content: "Install Count"
                            style:
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.500"
                              text_transform: "uppercase"
                          - type: "Text"
                            props:
                              content: "{{skill.install_count}}"
                            style:
                              font_size: "typography.scale.base.size"
                              font_weight: "typography.weights.semibold"
                              color: "colors.neutral.900"
                      - type: "VStack"
                        style:
                          gap: "spacing.1"
                        children:
                          - type: "Text"
                            props:
                              content: "Version"
                            style:
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.500"
                              text_transform: "uppercase"
                          - type: "Text"
                            props:
                              content: "{{skill.version}}"
                            style:
                              font_size: "typography.scale.base.size"
                              font_family: "typography.font_families.monospace.css"
                              color: "colors.neutral.900"

      # Install Confirmation Modal
      - type: "modal"
        id: "install_modal"
        props:
          title: "Install {{skill.name}}"
        style:
          overlay:
            background: "components.modal.overlay.bg"
            backdrop_filter: "components.modal.overlay.backdrop_filter"
          container:
            background: "components.modal.container.bg"
            border_radius: "components.modal.container.border_radius"
            shadow: "components.modal.container.shadow"
            padding: "components.modal.container.padding"
            max_width: "500px"
        children:
          - type: "form_field"
            id: "target_agent"
            props:
              label: "Target Agent"
              type: "select"
              required: true
              placeholder: "Select an agent..."
              options_from: "agents"
              option_label: "{{item.name}} ({{item.role}})"
              option_value: "{{item.id}}"
          - type: "VStack"
            id: "permission_review"
            style:
              margin_top: "spacing.4"
              padding: "spacing.4"
              background: "colors.semantic.info.light"
              border: "borders.width.thin solid colors.semantic.info.border"
              border_radius: "borders.radius.md"
            children:
              - type: "Text"
                props:
                  content: "This skill requires the following permissions:"
                style:
                  font_size: "typography.scale.sm.size"
                  font_weight: "typography.weights.medium"
                  color: "colors.semantic.info.dark"
                  margin_bottom: "spacing.2"
              - type: "VStack"
                style:
                  gap: "spacing.1"
                children:
                  - type: "Text"
                    props:
                      for_each: "skill.permissions"
                      content: "-- {{item.label}}"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.semantic.info.dark"
          - type: "HStack"
            style:
              justify_content: "flex-end"
              gap: "spacing.3"
              padding_top: "components.modal.footer.padding_top"
              border_top: "components.modal.footer.border_top"
              margin_top: "spacing.4"
            children:
              - type: "Button"
                props:
                  content: "Cancel"
                  variant: "secondary"
                  size: "md"
                actions:
                  - event: "click"
                    handler: "close_modal:install_modal"
              - type: "Button"
                props:
                  content: "Install Skill"
                  variant: "primary"
                  size: "md"
                  icon_left: "Download"
                actions:
                  - event: "click"
                    handler: "POST /api/dashboard/agents/{{target_agent}}/skills"
                    body:
                      skill_id: "{{skill.id}}"
                    on_success: "show_toast:success:Skill installed successfully"
                    on_error: "show_toast:error"

  # ===========================================================================
  # SCREEN 14: Team Members
  # ===========================================================================
  - id: "tenant_team_members"
    name: "Team Members"
    route: "/dashboard/team"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-12"
    flow_ref: "2.4"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "members"
        endpoint: "GET /api/dashboard/team/members"
      - id: "pending_invites"
        endpoint: "GET /api/dashboard/team/invites?status=pending"

    components:
      - type: "page_header"
        props:
          title: "Team Members"
          description: "Manage who has access to your workspace."
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Team Members"
        children:
          - type: "Button"
            props:
              content: "Invite Member"
              variant: "primary"
              size: "md"
              icon_left: "UserPlus"
              visible_when: "current_user.role === 'tenant_admin'"
            actions:
              - event: "click"
                handler: "open_modal:invite_modal"

      - type: "VStack"
        style:
          gap: "spacing.semantic.section_gap"
        children:
          # Pending Invites
          - type: "card"
            id: "pending_invites_card"
            props:
              visible_when: "pending_invites.length > 0"
            style:
              background: "components.card.variants.default.bg"
              border: "components.card.variants.default.border"
              border_radius: "components.card.variants.default.border_radius"
              shadow: "components.card.variants.default.shadow"
              padding: "components.card.variants.default.padding"
            children:
              - type: "Text"
                props:
                  content: "Pending Invitations"
                style:
                  font_size: "typography.headings.h3.size"
                  font_weight: "typography.headings.h3.weight"
                  color: "colors.neutral.900"
                  margin_bottom: "spacing.4"
              - type: "VStack"
                style:
                  gap: "spacing.2"
                children:
                  - type: "HStack"
                    props:
                      for_each: "pending_invites"
                    style:
                      justify_content: "space-between"
                      align_items: "center"
                      padding: "spacing.3"
                      background: "colors.semantic.warning.light"
                      border_radius: "borders.radius.md"
                    children:
                      - type: "HStack"
                        style:
                          gap: "spacing.3"
                          align_items: "center"
                        children:
                          - type: "icon"
                            props:
                              name: "Mail"
                            style:
                              color: "colors.semantic.warning.main"
                              size: "16px"
                          - type: "VStack"
                            style:
                              gap: "spacing.0.5"
                            children:
                              - type: "Text"
                                props:
                                  content: "{{item.email}}"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "Invited {{item.created_at | relative_time}} -- Expires {{item.expires_at | relative_time}}"
                                style:
                                  font_size: "typography.scale.xs.size"
                                  color: "colors.neutral.500"
                      - type: "HStack"
                        style:
                          gap: "spacing.2"
                        children:
                          - type: "badge"
                            props:
                              content: "{{item.role | titlecase}}"
                              variant: "warning"
                              size: "sm"
                          - type: "Button"
                            props:
                              content: "Resend"
                              variant: "ghost"
                              size: "sm"
                            actions:
                              - event: "click"
                                handler: "POST /api/dashboard/team/invites/{{item.id}}/resend"

          # Active Members
          - type: "card"
            style:
              background: "components.card.variants.default.bg"
              border: "components.card.variants.default.border"
              border_radius: "components.card.variants.default.border_radius"
              shadow: "components.card.variants.default.shadow"
              padding: "0"
            children:
              - type: "data_table"
                id: "members_table"
                props:
                  data_source: "members"
                  columns:
                    - id: "name"
                      header: "Member"
                      cell_type: "user_cell"
                      avatar: "{{row.avatar}}"
                      primary: "{{row.name}}"
                      secondary: "{{row.email}}"
                      width: "auto"
                    - id: "role"
                      header: "Role"
                      cell_type: "badge"
                      width: "120px"
                      variant_map:
                        tenant_admin: "primary"
                        tenant_viewer: "default"
                    - id: "status"
                      header: "Status"
                      cell_type: "status_badge"
                      width: "100px"
                      variant_map:
                        active: "success"
                        inactive: "default"
                    - id: "last_login"
                      header: "Last Login"
                      cell_type: "relative_time"
                      width: "140px"
                    - id: "actions"
                      header: ""
                      width: "60px"
                      cell_type: "actions_menu"
                      visible_when: "current_user.role === 'tenant_admin'"
                      items:
                        - label: "Change Role"
                          icon: "Shield"
                          action: "open_modal:role_change:{{row.id}}"
                        - type: "separator"
                        - label: "Remove Member"
                          icon: "UserMinus"
                          action: "confirm_then:DELETE /api/dashboard/team/members/{{row.id}}"
                          variant: "destructive"
                          disabled_when: "row.is_last_admin"

      # Invite Modal
      - type: "modal"
        id: "invite_modal"
        props:
          title: "Invite Team Member"
        style:
          overlay:
            background: "components.modal.overlay.bg"
            backdrop_filter: "components.modal.overlay.backdrop_filter"
          container:
            background: "components.modal.container.bg"
            border_radius: "components.modal.container.border_radius"
            shadow: "components.modal.container.shadow"
            padding: "components.modal.container.padding"
            max_width: "460px"
        children:
          - type: "form"
            id: "invite_form"
            style:
              gap: "spacing.semantic.form_gap"
            children:
              - type: "form_field"
                props:
                  label: "Email Address"
                  type: "email"
                  placeholder: "colleague@company.com"
                  required: true
              - type: "form_field"
                props:
                  label: "Role"
                  type: "select"
                  required: true
                  options:
                    - label: "Admin -- Full access to manage agents and settings"
                      value: "tenant_admin"
                    - label: "Viewer -- Read-only access to agent activity"
                      value: "tenant_viewer"
              - type: "HStack"
                style:
                  justify_content: "flex-end"
                  gap: "spacing.3"
                  padding_top: "components.modal.footer.padding_top"
                  border_top: "components.modal.footer.border_top"
                children:
                  - type: "Button"
                    props:
                      content: "Cancel"
                      variant: "secondary"
                      size: "md"
                    actions:
                      - event: "click"
                        handler: "close_modal:invite_modal"
                  - type: "Button"
                    props:
                      content: "Send Invitation"
                      variant: "primary"
                      size: "md"
                      icon_left: "Send"
                    actions:
                      - event: "click"
                        handler: "POST /api/dashboard/team/invites"
                        on_success: "close_modal:invite_modal && show_toast:success"
                        on_error: "show_toast:error"

  # ===========================================================================
  # SCREEN 15: Audit Log
  # ===========================================================================
  - id: "tenant_audit_log"
    name: "Audit Log"
    route: "/dashboard/audit"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-14"
    flow_ref: "3.3"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "audit_logs"
        endpoint: "GET /api/dashboard/audit"
        params:
          page: "{{pagination.page}}"
          limit: 50
          agent: "{{filters.agent}}"
          action_type: "{{filters.action_type}}"
          severity: "{{filters.severity}}"
          date_from: "{{filters.date_from}}"
          date_to: "{{filters.date_to}}"
      - id: "agents_for_filter"
        endpoint: "GET /api/dashboard/agents?fields=id,name"

    components:
      - type: "page_header"
        props:
          title: "Audit Log"
          description: "Review all agent actions and system events for compliance."
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Audit Log"
        children:
          - type: "Button"
            props:
              content: "Export"
              variant: "secondary"
              size: "md"
              icon_left: "Download"
              visible_when: "current_user.role === 'tenant_admin'"
            actions:
              - event: "click"
                handler: "open_modal:export_modal"

      - type: "card"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "0"
        children:
          # Filter Bar
          - type: "HStack"
            id: "audit_filters"
            style:
              padding: "spacing.4"
              gap: "spacing.3"
              border_bottom: "borders.width.thin solid colors.neutral.200"
              flex_wrap: "wrap"
            children:
              - type: "select"
                props:
                  placeholder: "All Agents"
                  options_from: "agents_for_filter"
                  option_label: "{{item.name}}"
                  option_value: "{{item.id}}"
                style:
                  min_width: "160px"
              - type: "select"
                props:
                  placeholder: "All Actions"
                  options:
                    - label: "Tool Invocation"
                      value: "tool_invocation"
                    - label: "Message"
                      value: "message"
                    - label: "Config Change"
                      value: "config_change"
                    - label: "Login"
                      value: "login"
                    - label: "Skill Install"
                      value: "skill_install"
                style:
                  min_width: "160px"
              - type: "select"
                props:
                  placeholder: "All Severities"
                  options:
                    - label: "Info"
                      value: "info"
                    - label: "Warning"
                      value: "warning"
                    - label: "Error"
                      value: "error"
                style:
                  min_width: "140px"
              - type: "form_field"
                props:
                  type: "date_range"
                  placeholder: "Date range..."
                style:
                  min_width: "220px"

          # Audit Table
          - type: "data_table"
            id: "audit_table"
            props:
              data_source: "audit_logs"
              paginated: true
              page_size: 50
              sortable: true
              empty_state:
                icon: "ScrollText"
                title: "No audit entries"
                description: "Audit logs will appear as agents perform actions."
              columns:
                - id: "timestamp"
                  header: "Time"
                  sortable: true
                  cell_type: "datetime"
                  width: "170px"
                  font_family: "typography.font_families.monospace.css"
                  font_size: "typography.scale.xs.size"
                - id: "severity"
                  header: ""
                  width: "40px"
                  cell_type: "severity_dot"
                  color_map:
                    info: "colors.semantic.info.main"
                    warning: "colors.semantic.warning.main"
                    error: "colors.semantic.error.main"
                - id: "actor"
                  header: "Actor"
                  sortable: true
                  cell_type: "text"
                  width: "140px"
                - id: "action"
                  header: "Action"
                  sortable: true
                  cell_type: "badge"
                  variant: "outline"
                  width: "140px"
                - id: "description"
                  header: "Details"
                  cell_type: "truncated_text"
                  max_length: 80
                  width: "auto"
                - id: "actions"
                  header: ""
                  width: "50px"
                  cell_type: "button"
                  button_icon: "ChevronRight"
                  button_variant: "ghost"
                  button_size: "sm"

    actions:
      - event: "row:click"
        target: "audit_table"
        handler: "open_modal:audit_detail:{{row.id}}"

    modals:
      - type: "modal"
        id: "audit_detail"
        props:
          title: "Audit Entry Detail"
        style:
          container:
            max_width: "600px"
            background: "components.modal.container.bg"
            border_radius: "components.modal.container.border_radius"
            shadow: "components.modal.container.shadow"
            padding: "components.modal.container.padding"
        children:
          - type: "VStack"
            style:
              gap: "spacing.4"
            children:
              - type: "HStack"
                style:
                  justify_content: "space-between"
                children:
                  - type: "Text"
                    props:
                      content: "Timestamp"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"
                  - type: "Text"
                    props:
                      content: "{{selected_entry.timestamp | datetime:'full'}}"
                    style:
                      font_size: "typography.scale.sm.size"
                      font_family: "typography.font_families.monospace.css"
                      color: "colors.neutral.900"
              - type: "HStack"
                style:
                  justify_content: "space-between"
                children:
                  - type: "Text"
                    props:
                      content: "Actor"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"
                  - type: "Text"
                    props:
                      content: "{{selected_entry.actor}}"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.900"
              - type: "HStack"
                style:
                  justify_content: "space-between"
                children:
                  - type: "Text"
                    props:
                      content: "Action"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"
                  - type: "badge"
                    props:
                      content: "{{selected_entry.action}}"
                      variant: "outline"
              - type: "VStack"
                style:
                  gap: "spacing.1"
                children:
                  - type: "Text"
                    props:
                      content: "Details"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"
                  - type: "Text"
                    props:
                      content: "{{selected_entry.description}}"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.700"
                      line_height: "typography.scale.sm.line_height"
              - type: "VStack"
                props:
                  visible_when: "selected_entry.parameters"
                style:
                  gap: "spacing.1"
                children:
                  - type: "Text"
                    props:
                      content: "Parameters"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"
                  - type: "code_editor"
                    props:
                      language: "json"
                      value: "{{selected_entry.parameters | json}}"
                      read_only: true
                    style:
                      font_family: "typography.font_families.monospace.css"
                      font_size: "typography.scale.xs.size"
                      max_height: "200px"
                      border: "borders.width.thin solid colors.neutral.200"
                      border_radius: "borders.radius.md"

      - type: "modal"
        id: "export_modal"
        props:
          title: "Export Audit Log"
        style:
          container:
            max_width: "400px"
        children:
          - type: "Text"
            props:
              content: "Export the currently filtered audit log entries."
            style:
              font_size: "typography.scale.sm.size"
              color: "colors.neutral.600"
              margin_bottom: "spacing.4"
          - type: "form_field"
            props:
              label: "Format"
              type: "select"
              required: true
              options:
                - label: "CSV"
                  value: "csv"
                - label: "JSON"
                  value: "json"
          - type: "HStack"
            style:
              justify_content: "flex-end"
              gap: "spacing.3"
              padding_top: "spacing.4"
            children:
              - type: "Button"
                props:
                  content: "Cancel"
                  variant: "secondary"
                  size: "md"
                actions:
                  - event: "click"
                    handler: "close_modal:export_modal"
              - type: "Button"
                props:
                  content: "Download"
                  variant: "primary"
                  size: "md"
                  icon_left: "Download"
                actions:
                  - event: "click"
                    handler: "GET /api/dashboard/audit/export?format={{export_format}}"

  # ===========================================================================
  # SCREEN 16: Settings
  # ===========================================================================
  - id: "tenant_settings"
    name: "Settings"
    route: "/dashboard/settings"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-16"
    flow_ref: "2.1"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "company_profile"
        endpoint: "GET /api/dashboard/settings/profile"
      - id: "api_keys"
        endpoint: "GET /api/dashboard/settings/api-keys"

    components:
      - type: "page_header"
        props:
          title: "Settings"
          description: "Manage your company profile and workspace configuration."
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Settings"

      - type: "tabs"
        id: "settings_tabs"
        props:
          default_tab: "profile"
          tabs:
            - id: "profile"
              label: "Company Profile"
            - id: "api_keys"
              label: "API Keys"
            - id: "notifications"
              label: "Notifications"
        style:
          tab_list:
            border_bottom: "borders.width.thin solid colors.neutral.200"
          tab:
            padding: "spacing.3 spacing.4"
            font_size: "typography.scale.sm.size"
            font_weight: "typography.weights.medium"
            color: "colors.neutral.500"
          tab_active:
            color: "colors.primary.500"
            border_bottom: "borders.width.medium solid colors.primary.500"
          tab_content:
            padding_top: "spacing.6"

        children:
          # Profile Tab
          - type: "VStack"
            props:
              tab_id: "profile"
            style:
              max_width: "600px"
            children:
              - type: "card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Company Profile"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.5"
                  - type: "form"
                    id: "profile_form"
                    style:
                      gap: "spacing.semantic.form_gap"
                    children:
                      - type: "form_field"
                        props:
                          label: "Company Name"
                          type: "text"
                          value: "{{company_profile.company_name}}"
                          disabled: true
                          hint: "Contact support to change your company name."
                      - type: "form_field"
                        props:
                          label: "Industry"
                          type: "select"
                          value: "{{company_profile.industry}}"
                          options:
                            - label: "Technology"
                              value: "technology"
                            - label: "E-Commerce / Retail"
                              value: "ecommerce"
                            - label: "Financial Services"
                              value: "finance"
                            - label: "Healthcare"
                              value: "healthcare"
                            - label: "Education"
                              value: "education"
                            - label: "Other"
                              value: "other"
                      - type: "form_field"
                        props:
                          label: "Company Website"
                          type: "url"
                          value: "{{company_profile.website}}"
                          placeholder: "https://your-company.com"
                      - type: "form_field"
                        props:
                          label: "Timezone"
                          type: "select"
                          value: "{{company_profile.timezone}}"
                          options_type: "timezone"
                      - type: "HStack"
                        style:
                          justify_content: "flex-end"
                          padding_top: "spacing.4"
                        children:
                          - type: "Button"
                            props:
                              content: "Save Changes"
                              variant: "primary"
                              size: "md"
                            actions:
                              - event: "click"
                                handler: "PUT /api/dashboard/settings/profile"
                                on_success: "show_toast:success:Profile updated"

          # API Keys Tab
          - type: "VStack"
            props:
              tab_id: "api_keys"
            style:
              max_width: "700px"
              gap: "spacing.6"
            children:
              - type: "card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      align_items: "center"
                      margin_bottom: "spacing.4"
                    children:
                      - type: "VStack"
                        style:
                          gap: "spacing.1"
                        children:
                          - type: "Text"
                            props:
                              content: "API Keys"
                            style:
                              font_size: "typography.headings.h3.size"
                              font_weight: "typography.headings.h3.weight"
                              color: "colors.neutral.900"
                          - type: "Text"
                            props:
                              content: "Manage programmatic access to your workspace."
                            style:
                              font_size: "typography.scale.sm.size"
                              color: "colors.neutral.500"
                      - type: "Button"
                        props:
                          content: "Generate Key"
                          variant: "primary"
                          size: "sm"
                          icon_left: "Key"
                        actions:
                          - event: "click"
                            handler: "POST /api/dashboard/settings/api-keys"
                  - type: "data_table"
                    props:
                      data_source: "api_keys"
                      empty_state:
                        icon: "Key"
                        title: "No API keys"
                        description: "Generate an API key for programmatic access."
                      columns:
                        - id: "name"
                          header: "Name"
                          cell_type: "text"
                        - id: "key_preview"
                          header: "Key"
                          cell_type: "masked_text"
                          font_family: "typography.font_families.monospace.css"
                        - id: "created_at"
                          header: "Created"
                          cell_type: "relative_time"
                        - id: "last_used"
                          header: "Last Used"
                          cell_type: "relative_time"
                        - id: "actions"
                          header: ""
                          width: "50px"
                          cell_type: "actions_menu"
                          items:
                            - label: "Revoke"
                              icon: "Trash2"
                              action: "confirm_then:DELETE /api/dashboard/settings/api-keys/{{row.id}}"
                              variant: "destructive"

          # Notifications Tab
          - type: "VStack"
            props:
              tab_id: "notifications"
            style:
              max_width: "600px"
            children:
              - type: "card"
                style:
                  background: "components.card.variants.default.bg"
                  border: "components.card.variants.default.border"
                  border_radius: "components.card.variants.default.border_radius"
                  padding: "components.card.variants.default.padding"
                children:
                  - type: "Text"
                    props:
                      content: "Notification Preferences"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                      margin_bottom: "spacing.5"
                  - type: "VStack"
                    style:
                      gap: "spacing.5"
                    children:
                      - type: "HStack"
                        style:
                          justify_content: "space-between"
                          align_items: "center"
                        children:
                          - type: "VStack"
                            style:
                              gap: "spacing.0.5"
                            children:
                              - type: "Text"
                                props:
                                  content: "Agent Error Alerts"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.medium"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "Receive email when an agent enters an error state."
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                          - type: "Toggle"
                            props:
                              checked: true
                      - type: "HStack"
                        style:
                          justify_content: "space-between"
                          align_items: "center"
                        children:
                          - type: "VStack"
                            style:
                              gap: "spacing.0.5"
                            children:
                              - type: "Text"
                                props:
                                  content: "Weekly Usage Summary"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.medium"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "Weekly report of agent activity and costs."
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                          - type: "Toggle"
                            props:
                              checked: true
                      - type: "HStack"
                        style:
                          justify_content: "space-between"
                          align_items: "center"
                        children:
                          - type: "VStack"
                            style:
                              gap: "spacing.0.5"
                            children:
                              - type: "Text"
                                props:
                                  content: "New Team Member Joins"
                                style:
                                  font_size: "typography.scale.sm.size"
                                  font_weight: "typography.weights.medium"
                                  color: "colors.neutral.900"
                              - type: "Text"
                                props:
                                  content: "Notification when an invited member accepts."
                                style:
                                  font_size: "typography.scale.sm.size"
                                  color: "colors.neutral.500"
                          - type: "Toggle"
                            props:
                              checked: false

  # ===========================================================================
  # SCREEN 17: Tenant Admin Login
  # ===========================================================================
  - id: "tenant_login"
    name: "Tenant Admin Login"
    route: "/login"
    layout: "centered"
    auth_required: false
    role_required: "public"
    screen_id: "TA-01"
    flow_ref: "2.1, 3.1"

    components:
      - type: "VStack"
        id: "login_container"
        style:
          width: "100%"
          max_width: "420px"
          padding: "spacing.10"
          background: "colors.neutral.white"
          border_radius: "borders.radius.xl"
          shadow: "shadows.lg"
          gap: "spacing.8"
        dark_mode:
          background: "dark_mode.colors.bg.raised"
        children:
          - type: "VStack"
            style:
              align_items: "center"
              gap: "spacing.4"
            children:
              - type: "Image"
                props:
                  src: "/logo-full.svg"
                  alt: "Aegis Platform"
                  width: "140px"
              - type: "VStack"
                style:
                  align_items: "center"
                  gap: "spacing.1"
                children:
                  - type: "Text"
                    props:
                      content: "Welcome Back"
                    style:
                      font_size: "typography.headings.h2.size"
                      font_weight: "typography.headings.h2.weight"
                      color: "colors.neutral.900"
                  - type: "Text"
                    props:
                      content: "Sign in to your workspace"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"

          - type: "VStack"
            id: "oauth_buttons"
            style:
              gap: "spacing.3"
            children:
              - type: "Button"
                props:
                  content: "Continue with Google"
                  variant: "secondary"
                  size: "lg"
                  icon_left: "google_icon"
                  full_width: true
                actions:
                  - event: "click"
                    handler: "oauth:google"
              - type: "Button"
                props:
                  content: "Continue with GitHub"
                  variant: "secondary"
                  size: "lg"
                  icon_left: "github_icon"
                  full_width: true
                actions:
                  - event: "click"
                    handler: "oauth:github"

          - type: "HStack"
            id: "divider"
            style:
              align_items: "center"
              gap: "spacing.4"
            children:
              - type: "Divider"
                style:
                  flex: "1"
                  border_top: "borders.width.thin solid colors.neutral.200"
              - type: "Text"
                props:
                  content: "or"
                style:
                  font_size: "typography.scale.sm.size"
                  color: "colors.neutral.400"
              - type: "Divider"
                style:
                  flex: "1"
                  border_top: "borders.width.thin solid colors.neutral.200"

          - type: "form"
            id: "login_form"
            props:
              on_submit: "auth:tenant_login"
            style:
              gap: "spacing.semantic.form_gap"
            children:
              - type: "form_field"
                props:
                  label: "Email Address"
                  type: "email"
                  placeholder: "you@company.com"
                  required: true
                  autocomplete: "email"
              - type: "form_field"
                props:
                  label: "Password"
                  type: "password"
                  placeholder: "Enter your password"
                  required: true
                  autocomplete: "current-password"
                  show_toggle: true
              - type: "HStack"
                style:
                  justify_content: "flex-end"
                children:
                  - type: "Button"
                    props:
                      content: "Forgot password?"
                      variant: "link"
                      size: "sm"
                    style:
                      color: "colors.primary.500"
                      font_size: "typography.scale.sm.size"
              - type: "Button"
                props:
                  content: "Sign In"
                  variant: "primary"
                  size: "lg"
                  full_width: true
                  loading_text: "Signing in..."
                  type: "submit"

    actions:
      - event: "form:submit"
        target: "login_form"
        handler: "POST /api/auth/login"
        on_success: "navigate:/dashboard"
        on_error: "show_toast:error"

  # ===========================================================================
  # SCREEN 18: Invite Acceptance
  # ===========================================================================
  - id: "invite_acceptance"
    name: "Invite Acceptance"
    route: "/invite/:token"
    layout: "centered"
    auth_required: false
    role_required: "public"
    screen_id: "TA-02"
    flow_ref: "2.1"

    data_sources:
      - id: "invite"
        endpoint: "GET /api/auth/invites/:token"

    components:
      - type: "VStack"
        id: "invite_container"
        style:
          width: "100%"
          max_width: "440px"
          padding: "spacing.10"
          background: "colors.neutral.white"
          border_radius: "borders.radius.xl"
          shadow: "shadows.lg"
          gap: "spacing.8"
        dark_mode:
          background: "dark_mode.colors.bg.raised"
        children:
          # Expired State
          - type: "VStack"
            id: "expired_state"
            props:
              visible_when: "invite.status === 'expired'"
            style:
              align_items: "center"
              gap: "spacing.4"
            children:
              - type: "VStack"
                style:
                  width: "64px"
                  height: "64px"
                  border_radius: "borders.radius.full"
                  background: "colors.semantic.error.light"
                  align_items: "center"
                  justify_content: "center"
                children:
                  - type: "icon"
                    props:
                      name: "Clock"
                    style:
                      color: "colors.semantic.error.main"
                      size: "28px"
              - type: "Text"
                props:
                  content: "Invitation Expired"
                style:
                  font_size: "typography.headings.h2.size"
                  font_weight: "typography.headings.h2.weight"
                  color: "colors.neutral.900"
              - type: "Text"
                props:
                  content: "This invite link has expired. Please contact your workspace admin to request a new invitation."
                style:
                  font_size: "typography.scale.sm.size"
                  color: "colors.neutral.500"
                  text_align: "center"

          # Valid Invite State
          - type: "VStack"
            id: "valid_state"
            props:
              visible_when: "invite.status === 'pending'"
            style:
              gap: "spacing.6"
            children:
              - type: "VStack"
                style:
                  align_items: "center"
                  gap: "spacing.4"
                children:
                  - type: "Image"
                    props:
                      src: "/logo-full.svg"
                      alt: "Aegis Platform"
                      width: "140px"
                  - type: "Text"
                    props:
                      content: "Join {{invite.company_name}}"
                    style:
                      font_size: "typography.headings.h2.size"
                      font_weight: "typography.headings.h2.weight"
                      color: "colors.neutral.900"
                  - type: "Text"
                    props:
                      content: "You've been invited to join as {{invite.role | titlecase}}."
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.500"

              - type: "VStack"
                id: "oauth_options"
                style:
                  gap: "spacing.3"
                children:
                  - type: "Button"
                    props:
                      content: "Continue with Google"
                      variant: "secondary"
                      size: "lg"
                      icon_left: "google_icon"
                      full_width: true
                    actions:
                      - event: "click"
                        handler: "oauth:google:invite={{invite.token}}"
                  - type: "Button"
                    props:
                      content: "Continue with GitHub"
                      variant: "secondary"
                      size: "lg"
                      icon_left: "github_icon"
                      full_width: true
                    actions:
                      - event: "click"
                        handler: "oauth:github:invite={{invite.token}}"

              - type: "HStack"
                style:
                  align_items: "center"
                  gap: "spacing.4"
                children:
                  - type: "Divider"
                    style:
                      flex: "1"
                      border_top: "borders.width.thin solid colors.neutral.200"
                  - type: "Text"
                    props:
                      content: "or set a password"
                    style:
                      font_size: "typography.scale.sm.size"
                      color: "colors.neutral.400"
                      white_space: "nowrap"
                  - type: "Divider"
                    style:
                      flex: "1"
                      border_top: "borders.width.thin solid colors.neutral.200"

              - type: "form"
                id: "accept_form"
                style:
                  gap: "spacing.semantic.form_gap"
                children:
                  - type: "form_field"
                    props:
                      label: "Full Name"
                      type: "text"
                      placeholder: "Your full name"
                      required: true
                  - type: "form_field"
                    props:
                      label: "Password"
                      type: "password"
                      placeholder: "Create a password"
                      required: true
                      min_length: 12
                      show_strength: true
                      hint: "Minimum 12 characters with mixed case and special characters."
                  - type: "form_field"
                    props:
                      label: "Confirm Password"
                      type: "password"
                      placeholder: "Confirm your password"
                      required: true
                      must_match: "password"
                  - type: "Button"
                    props:
                      content: "Accept Invitation"
                      variant: "primary"
                      size: "lg"
                      full_width: true
                      loading_text: "Setting up your account..."
                      type: "submit"

    actions:
      - event: "form:submit"
        target: "accept_form"
        handler: "POST /api/auth/invites/:token/accept"
        on_success: "navigate:/dashboard"
        on_error: "show_toast:error"

  # ===========================================================================
  # SCREEN 19: Private Skill Upload
  # ===========================================================================
  # Tenant admin screen for managing private/custom skills -- submission,
  # version management, validation results. Includes submit modal with
  # permission manifest fields and a version history expansion panel.
  # ===========================================================================
  - id: "tenant_private_skills"
    name: "Private Skills"
    route: "/dashboard/skills/private"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-19"
    flow_ref: "3.4"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "private_skills"
        endpoint: "GET /api/dashboard/skills/private"
        params:
          page: "{{pagination.page}}"
          limit: 20
          status: "{{filters.status}}"
          sort: "submitted_at:desc"
      - id: "skill_categories"
        endpoint: "GET /api/skills/categories"
      - id: "available_roles"
        endpoint: "GET /api/dashboard/agents/roles"

    components:
      - type: "page_header"
        props:
          title: "Private Skills"
          description: "Manage custom skills developed for your organization."
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Skills"
              href: "/dashboard/skills"
            - label: "Private Skills"
        children:
          - type: "Button"
            id: "submit_skill_btn"
            props:
              content: "Submit New Skill"
              variant: "primary"
              size: "md"
              icon_left: "Plus"
            style:
              background: "components.button.variants.primary.bg"
              color: "components.button.variants.primary.text"
              height: "components.button.sizes.md.height"
              padding_x: "components.button.sizes.md.padding_x"
              font_size: "components.button.sizes.md.font_size"
              font_weight: "typography.weights.semibold"
              border_radius: "components.button.sizes.md.border_radius"
              shadow: "components.button.variants.primary.shadow"
            states:
              hover:
                background: "components.button.variants.primary.bg_hover"
                shadow: "components.button.variants.primary.shadow_hover"
              active:
                background: "components.button.variants.primary.bg_active"
            actions:
              - event: "click"
                handler: "open_modal:submit_skill_modal"

      # Status Filter Tabs
      - type: "HStack"
        id: "status_tabs"
        style:
          gap: "spacing.1"
          margin_bottom: "spacing.5"
          border_bottom: "borders.width.thin solid colors.neutral.200"
          padding_bottom: "spacing.0"
        dark_mode:
          border_bottom: "borders.width.thin solid dark_mode.colors.border.default"
        children:
          - type: "tab_button"
            props:
              label: "All"
              value: "all"
              active: "{{filters.status === 'all'}}"
            style:
              padding: "spacing.2 spacing.4"
              font_size: "typography.scale.sm.size"
              font_weight: "typography.weights.medium"
              color: "colors.neutral.500"
              border_bottom: "borders.width.medium solid transparent"
              margin_bottom: "-1px"
              transition: "animations.presets.colors"
            states:
              active:
                color: "colors.primary.500"
                border_bottom: "borders.width.medium solid colors.primary.500"
              hover:
                color: "colors.neutral.700"
          - type: "tab_button"
            props:
              label: "Pending"
              value: "pending"
              count: "{{private_skills.counts.pending}}"
          - type: "tab_button"
            props:
              label: "Approved"
              value: "approved"
              count: "{{private_skills.counts.approved}}"
          - type: "tab_button"
            props:
              label: "Rejected"
              value: "rejected"
              count: "{{private_skills.counts.rejected}}"

      # Skills Table Card
      - type: "card"
        id: "skills_table_card"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "0"
        dark_mode:
          background: "dark_mode.components.card.bg"
          border: "dark_mode.components.card.border"
        children:
          - type: "data_table"
            id: "private_skills_table"
            props:
              data_source: "private_skills"
              paginated: true
              page_size: 20
              sortable: true
              empty_state:
                icon: "Puzzle"
                title: "No private skills yet"
                description: "Submit your first custom skill to get started."
                action_label: "Submit New Skill"
                action_handler: "open_modal:submit_skill_modal"
              columns:
                - id: "name"
                  header: "Skill Name"
                  sortable: true
                  cell_type: "text_with_subtitle"
                  primary: "{{row.name}}"
                  secondary: "{{row.description | truncate:60}}"
                  style:
                    primary_font_size: "typography.scale.sm.size"
                    primary_font_weight: "typography.weights.medium"
                    primary_color: "colors.neutral.900"
                    secondary_font_size: "typography.scale.xs.size"
                    secondary_color: "colors.neutral.500"
                - id: "version"
                  header: "Version"
                  cell_type: "text"
                  width: "90px"
                  font_family: "typography.font_families.monospace.css"
                  font_size: "typography.scale.sm.size"
                  color: "colors.neutral.700"
                - id: "category"
                  header: "Category"
                  cell_type: "badge"
                  variant: "primary"
                  width: "130px"
                - id: "status"
                  header: "Status"
                  cell_type: "badge"
                  width: "110px"
                  variant_map:
                    pending: "warning"
                    approved: "success"
                    rejected: "error"
                  style:
                    badge_pending_bg: "components.badge.variants.warning.bg"
                    badge_pending_text: "components.badge.variants.warning.text"
                    badge_approved_bg: "components.badge.variants.success.bg"
                    badge_approved_text: "components.badge.variants.success.text"
                    badge_rejected_bg: "components.badge.variants.error.bg"
                    badge_rejected_text: "components.badge.variants.error.text"
                    badge_padding_x: "components.badge.sizes.md.padding_x"
                    badge_padding_y: "components.badge.sizes.md.padding_y"
                    badge_font_size: "components.badge.sizes.md.font_size"
                    badge_border_radius: "components.badge.sizes.md.border_radius"
                    badge_font_weight: "components.badge.sizes.md.font_weight"
                - id: "submitted_at"
                  header: "Submitted"
                  sortable: true
                  cell_type: "relative_time"
                  width: "130px"
                  font_size: "typography.scale.xs.size"
                  color: "colors.neutral.500"
                - id: "actions"
                  header: ""
                  width: "120px"
                  cell_type: "action_menu"
                  items:
                    - label: "View Details"
                      icon: "Eye"
                      action: "open_drawer:skill_detail_drawer:{{row.id}}"
                    - label: "Edit"
                      icon: "Pencil"
                      action: "open_modal:edit_skill_modal:{{row.id}}"
                      visible_when: "row.status !== 'approved'"
                    - label: "Version History"
                      icon: "History"
                      action: "toggle_expand:version_panel:{{row.id}}"
                    - label: "Delete"
                      icon: "Trash2"
                      action: "open_modal:delete_confirm:{{row.id}}"
                      variant: "destructive"
                      visible_when: "row.status !== 'approved'"

          # Expandable Version History Panel (per row)
          - type: "expandable_panel"
            id: "version_panel"
            style:
              background: "colors.neutral.50"
              border_top: "borders.width.thin solid colors.neutral.200"
              padding: "spacing.4 spacing.6"
            dark_mode:
              background: "dark_mode.colors.bg.muted"
              border_top: "borders.width.thin solid dark_mode.colors.border.default"
            children:
              - type: "HStack"
                style:
                  justify_content: "space-between"
                  align_items: "center"
                  margin_bottom: "spacing.3"
                children:
                  - type: "Text"
                    props:
                      content: "Version History"
                    style:
                      font_size: "typography.headings.h4.size"
                      font_weight: "typography.headings.h4.weight"
                      color: "colors.neutral.800"
              - type: "VStack"
                id: "version_list"
                props:
                  data_source: "GET /api/dashboard/skills/private/{{row.id}}/versions"
                style:
                  gap: "spacing.2"
                item_template:
                  type: "HStack"
                  style:
                    justify_content: "space-between"
                    align_items: "center"
                    padding: "spacing.2 spacing.3"
                    border_radius: "borders.radius.md"
                    background: "colors.neutral.white"
                    border: "borders.width.thin solid colors.neutral.200"
                  dark_mode:
                    background: "dark_mode.colors.bg.raised"
                    border: "borders.width.thin solid dark_mode.colors.border.default"
                  children:
                    - type: "HStack"
                      style:
                        gap: "spacing.3"
                        align_items: "center"
                      children:
                        - type: "Text"
                          props:
                            content: "v{{item.version}}"
                          style:
                            font_family: "typography.font_families.monospace.css"
                            font_size: "typography.scale.sm.size"
                            font_weight: "typography.weights.semibold"
                            color: "colors.primary.600"
                        - type: "Text"
                          props:
                            content: "{{item.created_at | relative_time}}"
                          style:
                            font_size: "typography.scale.xs.size"
                            color: "colors.neutral.400"
                            font_family: "typography.font_families.monospace.css"
                        - type: "badge"
                          props:
                            content: "{{item.status}}"
                            variant: "{{item.status === 'approved' ? 'success' : item.status === 'pending' ? 'warning' : 'error'}}"
                    - type: "Button"
                      props:
                        content: "Rollback"
                        variant: "ghost"
                        size: "xs"
                        icon_left: "RotateCcw"
                        visible_when: "item.version !== row.version && item.status === 'approved'"
                      style:
                        color: "colors.primary.500"
                        font_size: "typography.scale.xs.size"
                      actions:
                        - event: "click"
                          handler: "POST /api/dashboard/skills/private/{{row.id}}/rollback/{{item.version}}"
                          confirm: "Rollback to v{{item.version}}?"
                          on_success: "refresh:private_skills"

      # Validation Results Card (shown after submission)
      - type: "card"
        id: "validation_results_card"
        props:
          visible_when: "validation_result"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "components.card.variants.default.padding"
          margin_top: "spacing.semantic.section_gap"
        dark_mode:
          background: "dark_mode.components.card.bg"
          border: "dark_mode.components.card.border"
        children:
          - type: "HStack"
            style:
              justify_content: "space-between"
              align_items: "center"
              margin_bottom: "spacing.4"
            children:
              - type: "HStack"
                style:
                  gap: "spacing.3"
                  align_items: "center"
                children:
                  - type: "Text"
                    props:
                      content: "Validation Results"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                  - type: "badge"
                    props:
                      content: "{{validation_result.passed ? 'PASSED' : 'FAILED'}}"
                      variant: "{{validation_result.passed ? 'success' : 'error'}}"
                    style:
                      font_size: "components.badge.sizes.sm.font_size"
                      padding_x: "components.badge.sizes.sm.padding_x"
                      padding_y: "components.badge.sizes.sm.padding_y"
              - type: "Button"
                props:
                  content: "Dismiss"
                  variant: "ghost"
                  size: "sm"
                  icon_left: "X"
                actions:
                  - event: "click"
                    handler: "set_state:validation_result:null"
          - type: "VStack"
            id: "validation_issues_list"
            props:
              visible_when: "validation_result.issues.length > 0"
            style:
              gap: "spacing.2"
            children:
              - type: "HStack"
                props:
                  for_each: "validation_result.issues"
                style:
                  gap: "spacing.3"
                  padding: "spacing.3"
                  border_radius: "borders.radius.md"
                  background: "{{item.severity === 'error' ? 'colors.semantic.error.light' : item.severity === 'warning' ? 'colors.semantic.warning.light' : 'colors.neutral.50'}}"
                  align_items: "flex-start"
                children:
                  - type: "icon"
                    props:
                      name: "{{item.severity === 'error' ? 'XCircle' : 'AlertTriangle'}}"
                    style:
                      color: "{{item.severity === 'error' ? 'colors.semantic.error.main' : 'colors.semantic.warning.main'}}"
                      size: "16px"
                      flex_shrink: "0"
                      margin_top: "spacing.0.5"
                  - type: "VStack"
                    style:
                      gap: "spacing.0.5"
                    children:
                      - type: "Text"
                        props:
                          content: "{{item.message}}"
                        style:
                          font_size: "typography.scale.sm.size"
                          font_weight: "typography.weights.medium"
                          color: "{{item.severity === 'error' ? 'colors.semantic.error.dark' : 'colors.semantic.warning.dark'}}"
                      - type: "Text"
                        props:
                          content: "{{item.detail}}"
                          visible_when: "item.detail"
                        style:
                          font_size: "typography.scale.xs.size"
                          color: "colors.neutral.600"

    # Submit Skill Modal
    modals:
      - type: "modal"
        id: "submit_skill_modal"
        props:
          title: "Submit New Skill"
        style:
          overlay:
            background: "components.modal.overlay.bg"
            backdrop_filter: "components.modal.overlay.backdrop_filter"
          container:
            background: "components.modal.container.bg"
            border_radius: "components.modal.container.border_radius"
            shadow: "components.modal.container.shadow"
            padding: "components.modal.container.padding"
            max_width: "640px"
            width: "100%"
            max_height: "90vh"
            overflow_y: "auto"
        dark_mode:
          overlay:
            background: "dark_mode.components.modal.overlay_bg"
          container:
            background: "dark_mode.components.modal.container_bg"
            border: "dark_mode.components.modal.container_border"
        children:
          - type: "form"
            id: "submit_skill_form"
            style:
              gap: "spacing.semantic.form_gap"
            children:
              # Basic Information Section
              - type: "Text"
                props:
                  content: "Basic Information"
                style:
                  font_size: "typography.headings.h5.size"
                  font_weight: "typography.headings.h5.weight"
                  color: "colors.neutral.800"
                  margin_bottom: "spacing.1"
              - type: "HStack"
                style:
                  gap: "spacing.4"
                responsive:
                  sm_down:
                    flex_direction: "column"
                children:
                  - type: "form_field"
                    props:
                      label: "Skill Name"
                      type: "text"
                      placeholder: "e.g., Customer Sentiment Analyzer"
                      required: true
                      name: "name"
                    style:
                      flex: "2"
                  - type: "form_field"
                    props:
                      label: "Version"
                      type: "text"
                      placeholder: "1.0.0"
                      required: true
                      name: "version"
                      pattern: "^\\d+\\.\\d+\\.\\d+$"
                      hint: "Semantic versioning (e.g., 1.0.0)"
                    style:
                      flex: "1"
              - type: "form_field"
                props:
                  label: "Description"
                  type: "textarea"
                  placeholder: "Describe what this skill does and when agents should use it..."
                  required: true
                  name: "description"
                  rows: 3
                  max_length: 500
                  show_count: true
              - type: "HStack"
                style:
                  gap: "spacing.4"
                responsive:
                  sm_down:
                    flex_direction: "column"
                children:
                  - type: "form_field"
                    props:
                      label: "Category"
                      type: "select"
                      required: true
                      name: "category"
                      options:
                        - label: "Productivity"
                          value: "productivity"
                        - label: "Analytics"
                          value: "analytics"
                        - label: "Engineering"
                          value: "engineering"
                        - label: "Communication"
                          value: "communication"
                        - label: "Security"
                          value: "security"
                        - label: "Integration"
                          value: "integration"
                        - label: "Custom"
                          value: "custom"
                    style:
                      flex: "1"
                  - type: "form_field"
                    props:
                      label: "Compatible Roles"
                      type: "multi_select"
                      required: true
                      name: "compatible_roles"
                      options_from: "available_roles"
                      option_label: "{{item.name}}"
                      option_value: "{{item.id}}"
                      placeholder: "Select roles..."
                    style:
                      flex: "1"

              # Source Code Section
              - type: "Divider"
                style:
                  border_top: "borders.width.thin solid colors.neutral.200"
                  margin: "spacing.2 0"
              - type: "Text"
                props:
                  content: "Source Code"
                style:
                  font_size: "typography.headings.h5.size"
                  font_weight: "typography.headings.h5.weight"
                  color: "colors.neutral.800"
                  margin_bottom: "spacing.1"
              - type: "code_editor"
                id: "skill_source_editor"
                props:
                  language: "typescript"
                  name: "source_code"
                  placeholder: "// Paste or write your skill source code here..."
                  required: true
                  line_numbers: true
                style:
                  font_family: "typography.font_families.monospace.css"
                  font_size: "typography.scale.sm.size"
                  border: "borders.width.thin solid colors.neutral.200"
                  border_radius: "borders.radius.md"
                  min_height: "250px"
                  max_height: "400px"
                  overflow: "auto"
                dark_mode:
                  border: "borders.width.thin solid dark_mode.colors.border.default"
                  background: "dark_mode.colors.bg.overlay"

              # Permissions Section
              - type: "Divider"
                style:
                  border_top: "borders.width.thin solid colors.neutral.200"
                  margin: "spacing.2 0"
              - type: "Text"
                props:
                  content: "Permissions"
                style:
                  font_size: "typography.headings.h5.size"
                  font_weight: "typography.headings.h5.weight"
                  color: "colors.neutral.800"
                  margin_bottom: "spacing.1"
              - type: "Text"
                props:
                  content: "Declare the resources this skill requires access to."
                style:
                  font_size: "typography.scale.xs.size"
                  color: "colors.neutral.500"
                  margin_bottom: "spacing.3"
              - type: "form_field"
                props:
                  label: "Network Domains"
                  type: "tag_input"
                  name: "permissions.network_domains"
                  placeholder: "api.example.com"
                  hint: "Domains this skill needs to reach. Press Enter to add."
              - type: "form_field"
                props:
                  label: "File Paths"
                  type: "tag_input"
                  name: "permissions.file_paths"
                  placeholder: "/workspace/data"
                  hint: "File system paths required by this skill."
              - type: "form_field"
                props:
                  label: "Environment Variables"
                  type: "tag_input"
                  name: "permissions.env_vars"
                  placeholder: "API_KEY"
                  hint: "Environment variables this skill needs to read."

              # Modal Footer
              - type: "HStack"
                style:
                  justify_content: "flex-end"
                  gap: "spacing.3"
                  padding_top: "components.modal.footer.padding_top"
                  border_top: "components.modal.footer.border_top"
                children:
                  - type: "Button"
                    props:
                      content: "Cancel"
                      variant: "secondary"
                      size: "md"
                    actions:
                      - event: "click"
                        handler: "close_modal:submit_skill_modal"
                  - type: "Button"
                    props:
                      content: "Validate & Submit"
                      variant: "primary"
                      size: "md"
                      icon_left: "CheckCircle"
                      loading_text: "Validating..."
                      type: "submit"

      # Delete Confirmation Modal
      - type: "modal"
        id: "delete_confirm"
        props:
          title: "Delete Skill"
        style:
          overlay:
            background: "components.modal.overlay.bg"
          container:
            background: "components.modal.container.bg"
            border_radius: "components.modal.container.border_radius"
            shadow: "components.modal.container.shadow"
            padding: "components.modal.container.padding"
            max_width: "components.modal.container.max_width"
        children:
          - type: "Text"
            props:
              content: "Are you sure you want to delete this skill? This action cannot be undone."
            style:
              font_size: "typography.scale.sm.size"
              color: "colors.neutral.600"
              margin_bottom: "spacing.4"
          - type: "HStack"
            style:
              justify_content: "flex-end"
              gap: "spacing.3"
              padding_top: "components.modal.footer.padding_top"
              border_top: "components.modal.footer.border_top"
            children:
              - type: "Button"
                props:
                  content: "Cancel"
                  variant: "secondary"
                  size: "md"
                actions:
                  - event: "click"
                    handler: "close_modal:delete_confirm"
              - type: "Button"
                props:
                  content: "Delete Skill"
                  variant: "destructive"
                  size: "md"
                  icon_left: "Trash2"
                actions:
                  - event: "click"
                    handler: "DELETE /api/dashboard/skills/private/{{selected_skill.id}}"
                    on_success: "refresh:private_skills"
                    on_error: "show_toast:error"

    actions:
      - event: "form:submit"
        target: "submit_skill_form"
        handler: "POST /api/dashboard/skills/private"
        on_success:
          - "close_modal:submit_skill_modal"
          - "refresh:private_skills"
          - "set_state:validation_result:response.validation"
          - "show_toast:success:Skill submitted for review"
        on_error: "show_toast:error"
      - event: "filter:change"
        target: "status_tabs"
        handler: "set_param:status:{{value}}"

  # ===========================================================================
  # SCREEN 20: Security Posture Dashboard
  # ===========================================================================
  # Platform admin security overview showing alerts, violations, compliance
  # metrics, and trend data. Central hub for security monitoring.
  # ===========================================================================
  - id: "platform_admin_security_posture"
    name: "Security Posture Dashboard"
    route: "/admin/dashboard/security-posture"
    layout: "sidebar"
    auth_required: true
    role_required: "platform_admin"
    screen_id: "PA-20"
    flow_ref: "1.4"
    sidebar_ref: "platform_admin_sidebar"

    data_sources:
      - id: "security_summary"
        endpoint: "GET /api/admin/dashboard/security-posture/summary"
        params:
          range: "{{filters.time_range}}"
        refresh: "60s"
      - id: "alerts_by_rule"
        endpoint: "GET /api/admin/dashboard/security-posture/alerts-by-rule"
        params:
          range: "{{filters.time_range}}"
      - id: "violation_trend"
        endpoint: "GET /api/admin/dashboard/security-posture/violation-trend"
        params:
          range: "{{filters.time_range}}"
      - id: "policy_compliance"
        endpoint: "GET /api/admin/dashboard/security-posture/compliance"

    components:
      - type: "page_header"
        props:
          title: "Security Posture"
          description: "Platform security overview, alert analysis, and compliance status."
          breadcrumbs:
            - label: "Admin"
              href: "/admin"
            - label: "Security Posture"
        children:
          - type: "HStack"
            style:
              gap: "spacing.3"
            children:
              - type: "Button"
                props:
                  content: "View All Alerts"
                  variant: "secondary"
                  size: "md"
                  icon_left: "Bell"
                  href: "/admin/alerts"
                style:
                  background: "components.button.variants.secondary.bg"
                  color: "components.button.variants.secondary.text"
                  border: "components.button.variants.secondary.border"
                  height: "components.button.sizes.md.height"
                  padding_x: "components.button.sizes.md.padding_x"
                  font_size: "components.button.sizes.md.font_size"
                  border_radius: "components.button.sizes.md.border_radius"
                states:
                  hover:
                    background: "components.button.variants.secondary.bg_hover"
                    shadow: "components.button.variants.secondary.shadow_hover"

      # Time Range Filter
      - type: "HStack"
        id: "time_filter"
        style:
          gap: "spacing.1"
          margin_bottom: "spacing.5"
          background: "colors.neutral.100"
          border_radius: "borders.radius.lg"
          padding: "spacing.1"
          width: "fit-content"
        dark_mode:
          background: "dark_mode.colors.bg.muted"
        children:
          - type: "pill_button"
            props:
              label: "24h"
              value: "24h"
              active: "{{filters.time_range === '24h'}}"
            style:
              padding: "spacing.1.5 spacing.4"
              font_size: "typography.scale.sm.size"
              font_weight: "typography.weights.medium"
              color: "colors.neutral.600"
              border_radius: "borders.radius.md"
              transition: "animations.presets.colors"
            states:
              active:
                background: "colors.neutral.white"
                color: "colors.neutral.900"
                shadow: "shadows.xs"
              hover:
                color: "colors.neutral.900"
            dark_mode:
              states:
                active:
                  background: "dark_mode.colors.bg.raised"
                  color: "dark_mode.colors.text.primary"
          - type: "pill_button"
            props:
              label: "7d"
              value: "7d"
              active: "{{filters.time_range === '7d'}}"
          - type: "pill_button"
            props:
              label: "30d"
              value: "30d"
              active: "{{filters.time_range === '30d'}}"

      # Summary Metric Cards
      - type: "HStack"
        id: "security_metrics_row"
        style:
          gap: "spacing.semantic.card_gap"
          margin_bottom: "spacing.semantic.section_gap"
          display: "grid"
          grid_template_columns: "repeat(4, 1fr)"
        responsive:
          lg:
            grid_template_columns: "repeat(4, 1fr)"
          md:
            grid_template_columns: "repeat(2, 1fr)"
          sm:
            grid_template_columns: "1fr"
        children:
          - type: "metric_card"
            id: "total_alerts_metric"
            props:
              label: "Total Alerts"
              value: "{{security_summary.total_alerts}}"
              trend_value: "{{security_summary.total_alerts_trend}}"
              trend_direction: "{{security_summary.total_alerts_trend_direction}}"
              icon: "Bell"
            style:
              background: "components.metric_card.bg"
              border: "components.metric_card.border"
              border_radius: "components.metric_card.border_radius"
              padding: "components.metric_card.padding"
            dark_mode:
              background: "dark_mode.components.card.bg"
              border: "dark_mode.components.card.border"
            children:
              - type: "Text"
                props:
                  content: "{{label}}"
                style:
                  font_size: "components.metric_card.label.font_size"
                  font_weight: "components.metric_card.label.font_weight"
                  color: "components.metric_card.label.color"
                  text_transform: "components.metric_card.label.text_transform"
                  letter_spacing: "components.metric_card.label.letter_spacing"
              - type: "Text"
                props:
                  content: "{{value}}"
                style:
                  font_size: "components.metric_card.value.font_size"
                  font_weight: "components.metric_card.value.font_weight"
                  color: "components.metric_card.value.color"
              - type: "HStack"
                props:
                  visible_when: "trend_value"
                style:
                  gap: "spacing.1"
                  align_items: "center"
                  margin_top: "spacing.1"
                children:
                  - type: "icon"
                    props:
                      name: "{{trend_direction === 'up' ? 'TrendingUp' : 'TrendingDown'}}"
                    style:
                      size: "14px"
                      color: "{{trend_direction === 'up' ? 'components.metric_card.trend.negative' : 'components.metric_card.trend.positive'}}"
                  - type: "Text"
                    props:
                      content: "{{trend_value}}"
                    style:
                      font_size: "components.metric_card.trend.font_size"
                      font_weight: "components.metric_card.trend.font_weight"
                      color: "{{trend_direction === 'up' ? 'components.metric_card.trend.negative' : 'components.metric_card.trend.positive'}}"

          - type: "metric_card"
            id: "unresolved_alerts_metric"
            props:
              label: "Unresolved"
              value: "{{security_summary.unresolved_alerts}}"
              icon: "AlertCircle"
              value_color_condition:
                gte_10: "colors.semantic.error.main"
                gte_5: "colors.semantic.warning.main"
                lt_5: "colors.semantic.success.main"
            style:
              background: "components.metric_card.bg"
              border: "components.metric_card.border"
              border_radius: "components.metric_card.border_radius"
              padding: "components.metric_card.padding"

          - type: "metric_card"
            id: "critical_alerts_metric"
            props:
              label: "Critical Alerts"
              value: "{{security_summary.critical_alerts}}"
              icon: "ShieldAlert"
              value_color_condition:
                gte_1: "colors.semantic.error.main"
                lt_1: "colors.semantic.success.main"
            style:
              background: "components.metric_card.bg"
              border: "components.metric_card.border"
              border_radius: "components.metric_card.border_radius"
              padding: "components.metric_card.padding"

          - type: "metric_card"
            id: "compliance_score_metric"
            props:
              label: "Compliance Score"
              value: "{{security_summary.compliance_score}}%"
              icon: "ShieldCheck"
              value_color_condition:
                gte_90: "colors.semantic.success.main"
                gte_70: "colors.semantic.warning.main"
                lt_70: "colors.semantic.error.main"
            style:
              background: "components.metric_card.bg"
              border: "components.metric_card.border"
              border_radius: "components.metric_card.border_radius"
              padding: "components.metric_card.padding"

      # Main Content: 2-column grid
      - type: "HStack"
        id: "security_main_content"
        style:
          gap: "spacing.semantic.card_gap"
          align_items: "flex-start"
          display: "grid"
          grid_template_columns: "1fr 1fr"
        responsive:
          lg:
            grid_template_columns: "1fr 1fr"
          md_down:
            grid_template_columns: "1fr"
        children:

          # Alerts by Rule Card
          - type: "card"
            id: "alerts_by_rule_card"
            style:
              background: "components.card.variants.default.bg"
              border: "components.card.variants.default.border"
              border_radius: "components.card.variants.default.border_radius"
              shadow: "components.card.variants.default.shadow"
              padding: "components.card.variants.default.padding"
            dark_mode:
              background: "dark_mode.components.card.bg"
              border: "dark_mode.components.card.border"
            children:
              - type: "Text"
                props:
                  content: "Alerts by Rule"
                style:
                  font_size: "typography.headings.h3.size"
                  font_weight: "typography.headings.h3.weight"
                  color: "colors.neutral.900"
                  margin_bottom: "spacing.5"
                dark_mode:
                  color: "dark_mode.colors.text.primary"
              - type: "VStack"
                id: "rule_breakdown_list"
                props:
                  data_source: "alerts_by_rule"
                  empty_state:
                    icon: "ShieldCheck"
                    title: "No alerts"
                    description: "No security alerts in this time range."
                style:
                  gap: "spacing.3"
                item_template:
                  type: "VStack"
                  style:
                    gap: "spacing.2"
                  children:
                    - type: "HStack"
                      style:
                        justify_content: "space-between"
                        align_items: "center"
                      children:
                        - type: "Text"
                          props:
                            content: "{{item.rule_name}}"
                          style:
                            font_size: "typography.scale.sm.size"
                            font_weight: "typography.weights.medium"
                            color: "colors.neutral.800"
                        - type: "HStack"
                          style:
                            gap: "spacing.3"
                            align_items: "center"
                          children:
                            - type: "Text"
                              props:
                                content: "{{item.count}}"
                              style:
                                font_size: "typography.scale.sm.size"
                                font_weight: "typography.weights.bold"
                                color: "colors.neutral.900"
                                font_family: "typography.font_families.monospace.css"
                            - type: "Text"
                              props:
                                content: "{{item.last_triggered | relative_time}}"
                              style:
                                font_size: "typography.scale.xs.size"
                                color: "colors.neutral.400"
                    # Horizontal bar
                    - type: "progress_bar"
                      props:
                        value: "{{item.count}}"
                        max: "{{alerts_by_rule.max_count}}"
                      style:
                        height: "6px"
                        border_radius: "borders.radius.full"
                        background: "colors.neutral.100"
                        fill_color: "{{item.severity === 'critical' ? 'colors.semantic.error.main' : item.severity === 'high' ? 'colors.semantic.warning.main' : 'colors.primary.500'}}"
                      dark_mode:
                        background: "dark_mode.colors.bg.muted"

          # Permission Violations Trend Card
          - type: "card"
            id: "violation_trend_card"
            style:
              background: "components.card.variants.default.bg"
              border: "components.card.variants.default.border"
              border_radius: "components.card.variants.default.border_radius"
              shadow: "components.card.variants.default.shadow"
              padding: "components.card.variants.default.padding"
            dark_mode:
              background: "dark_mode.components.card.bg"
              border: "dark_mode.components.card.border"
            children:
              - type: "HStack"
                style:
                  justify_content: "space-between"
                  align_items: "center"
                  margin_bottom: "spacing.5"
                children:
                  - type: "Text"
                    props:
                      content: "Permission Violations"
                    style:
                      font_size: "typography.headings.h3.size"
                      font_weight: "typography.headings.h3.weight"
                      color: "colors.neutral.900"
                    dark_mode:
                      color: "dark_mode.colors.text.primary"
                  - type: "badge"
                    props:
                      content: "{{violation_trend.trend_label}}"
                      variant: "{{violation_trend.trend_direction === 'decreasing' ? 'success' : violation_trend.trend_direction === 'increasing' ? 'error' : 'default'}}"
                    style:
                      font_size: "components.badge.sizes.sm.font_size"
                      padding_x: "components.badge.sizes.sm.padding_x"
                      padding_y: "components.badge.sizes.sm.padding_y"
                      border_radius: "components.badge.sizes.sm.border_radius"
              - type: "area_chart"
                id: "violation_trend_chart"
                props:
                  data_source: "violation_trend.data_points"
                  x_axis: "timestamp"
                  y_axis: "count"
                  show_grid: true
                  show_tooltip: true
                  fill_opacity: 0.15
                style:
                  height: "240px"
                  line_color: "colors.primary.500"
                  fill_color: "colors.primary.100"
                  grid_color: "colors.neutral.200"
                  axis_label_color: "colors.neutral.500"
                  axis_label_font_size: "typography.scale.xs.size"
                  tooltip_bg: "colors.neutral.900"
                  tooltip_color: "colors.neutral.white"
                  tooltip_border_radius: "borders.radius.md"
                  tooltip_font_size: "typography.scale.xs.size"
                dark_mode:
                  line_color: "dark_mode.colors.primary.500"
                  fill_color: "dark_mode.colors.primary.100"
                  grid_color: "dark_mode.colors.border.default"
                  axis_label_color: "dark_mode.colors.text.muted"
                  tooltip_bg: "dark_mode.colors.bg.overlay"

      # Policy Compliance Section
      - type: "card"
        id: "policy_compliance_card"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "components.card.variants.default.padding"
          margin_top: "spacing.semantic.card_gap"
        dark_mode:
          background: "dark_mode.components.card.bg"
          border: "dark_mode.components.card.border"
        children:
          - type: "HStack"
            style:
              justify_content: "space-between"
              align_items: "center"
              margin_bottom: "spacing.5"
            children:
              - type: "Text"
                props:
                  content: "Network Policy Compliance"
                style:
                  font_size: "typography.headings.h3.size"
                  font_weight: "typography.headings.h3.weight"
                  color: "colors.neutral.900"
                dark_mode:
                  color: "dark_mode.colors.text.primary"
              - type: "Text"
                props:
                  content: "{{policy_compliance.compliant_count}} / {{policy_compliance.total_tenants}} tenants"
                style:
                  font_size: "typography.scale.sm.size"
                  color: "colors.neutral.500"
                  font_family: "typography.font_families.monospace.css"

          # Compliance Progress Bar
          - type: "VStack"
            style:
              gap: "spacing.3"
              margin_bottom: "spacing.5"
            children:
              - type: "progress_bar"
                id: "compliance_progress"
                props:
                  value: "{{policy_compliance.compliance_percentage}}"
                  max: 100
                  label: "{{policy_compliance.compliance_percentage}}%"
                style:
                  height: "12px"
                  border_radius: "borders.radius.full"
                  background: "colors.neutral.100"
                  fill_color: "{{policy_compliance.compliance_percentage >= 90 ? 'colors.semantic.success.main' : policy_compliance.compliance_percentage >= 70 ? 'colors.semantic.warning.main' : 'colors.semantic.error.main'}}"
                dark_mode:
                  background: "dark_mode.colors.bg.muted"
              - type: "HStack"
                style:
                  justify_content: "space-between"
                children:
                  - type: "Text"
                    props:
                      content: "With active network policy"
                    style:
                      font_size: "typography.scale.xs.size"
                      color: "colors.semantic.success.dark"
                  - type: "Text"
                    props:
                      content: "Without network policy"
                    style:
                      font_size: "typography.scale.xs.size"
                      color: "colors.semantic.error.dark"

          # Non-compliant Tenants List
          - type: "VStack"
            id: "non_compliant_list"
            props:
              visible_when: "policy_compliance.non_compliant_tenants.length > 0"
            style:
              gap: "spacing.2"
            children:
              - type: "Text"
                props:
                  content: "Tenants Without Network Policy"
                style:
                  font_size: "typography.scale.sm.size"
                  font_weight: "typography.weights.semibold"
                  color: "colors.neutral.700"
                  margin_bottom: "spacing.2"
              - type: "HStack"
                props:
                  for_each: "policy_compliance.non_compliant_tenants"
                style:
                  justify_content: "space-between"
                  align_items: "center"
                  padding: "spacing.3"
                  border_radius: "borders.radius.md"
                  background: "colors.semantic.warning.light"
                  border: "borders.width.thin solid colors.semantic.warning.border"
                dark_mode:
                  background: "dark_mode.colors.semantic.warning.light"
                  border: "borders.width.thin solid dark_mode.colors.semantic.warning.border"
                children:
                  - type: "HStack"
                    style:
                      gap: "spacing.3"
                      align_items: "center"
                    children:
                      - type: "icon"
                        props:
                          name: "AlertTriangle"
                        style:
                          color: "colors.semantic.warning.main"
                          size: "16px"
                      - type: "VStack"
                        style:
                          gap: "spacing.0.5"
                        children:
                          - type: "Text"
                            props:
                              content: "{{item.company_name}}"
                            style:
                              font_size: "typography.scale.sm.size"
                              font_weight: "typography.weights.medium"
                              color: "colors.semantic.warning.dark"
                          - type: "Text"
                            props:
                              content: "{{item.agent_count}} agents, {{item.skill_count}} skills"
                            style:
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.600"
                  - type: "Button"
                    props:
                      content: "Configure"
                      variant: "ghost"
                      size: "xs"
                      href: "/admin/tenants/{{item.id}}/network-policy"
                    style:
                      color: "colors.primary.500"
                      font_size: "typography.scale.xs.size"

    actions:
      - event: "filter:change"
        target: "time_filter"
        handler: "set_param:time_range:{{value}}"
      - event: "auto_refresh"
        interval: "60s"
        handler: "refresh:security_summary,alerts_by_rule,violation_trend"

  # ===========================================================================
  # SCREEN 21: Inter-Agent Message Dashboard
  # ===========================================================================
  # Tenant admin timeline view of inter-agent messages with filtering,
  # search, detail drawer, and export capabilities.
  # ===========================================================================
  - id: "tenant_message_dashboard"
    name: "Inter-Agent Messages"
    route: "/dashboard/messages"
    layout: "sidebar"
    auth_required: true
    role_required: "tenant_admin"
    screen_id: "TA-21"
    flow_ref: "3.5"
    sidebar_ref: "tenant_admin_sidebar"

    data_sources:
      - id: "messages"
        endpoint: "GET /api/dashboard/messages"
        params:
          page: "{{pagination.page}}"
          limit: 50
          from_agent: "{{filters.from_agent}}"
          to_agent: "{{filters.to_agent}}"
          type: "{{filters.message_type}}"
          status: "{{filters.status}}"
          date_from: "{{filters.date_from}}"
          date_to: "{{filters.date_to}}"
          search: "{{filters.search}}"
      - id: "agents_list"
        endpoint: "GET /api/dashboard/agents?fields=id,name,role"
      - id: "message_flow"
        endpoint: "GET /api/dashboard/messages/flow-summary"
        params:
          range: "{{filters.date_from}},{{filters.date_to}}"

    components:
      - type: "page_header"
        props:
          title: "Inter-Agent Messages"
          description: "Monitor and inspect messages exchanged between your agents."
          breadcrumbs:
            - label: "Dashboard"
              href: "/dashboard"
            - label: "Messages"
        children:
          - type: "HStack"
            style:
              gap: "spacing.3"
            children:
              - type: "Button"
                id: "refresh_btn"
                props:
                  content: "Refresh"
                  variant: "ghost"
                  size: "md"
                  icon_left: "RefreshCw"
                style:
                  color: "components.button.variants.ghost.text"
                states:
                  hover:
                    background: "components.button.variants.ghost.bg_hover"
                actions:
                  - event: "click"
                    handler: "refresh:messages,message_flow"
              - type: "dropdown_menu"
                id: "export_menu"
                props:
                  trigger:
                    type: "Button"
                    props:
                      content: "Export"
                      variant: "secondary"
                      size: "md"
                      icon_left: "Download"
                    style:
                      background: "components.button.variants.secondary.bg"
                      color: "components.button.variants.secondary.text"
                      border: "components.button.variants.secondary.border"
                      height: "components.button.sizes.md.height"
                      padding_x: "components.button.sizes.md.padding_x"
                      font_size: "components.button.sizes.md.font_size"
                      border_radius: "components.button.sizes.md.border_radius"
                  items:
                    - label: "Export as JSON"
                      icon: "FileJson"
                      action: "GET /api/dashboard/messages/export?format=json"
                    - label: "Export as CSV"
                      icon: "FileSpreadsheet"
                      action: "GET /api/dashboard/messages/export?format=csv"

      # Mini Flow Diagram Card
      - type: "card"
        id: "flow_diagram_card"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "components.card.variants.default.padding"
          margin_bottom: "spacing.semantic.card_gap"
        dark_mode:
          background: "dark_mode.components.card.bg"
          border: "dark_mode.components.card.border"
        children:
          - type: "HStack"
            style:
              justify_content: "space-between"
              align_items: "center"
              margin_bottom: "spacing.4"
            children:
              - type: "Text"
                props:
                  content: "Message Flow Overview"
                style:
                  font_size: "typography.headings.h3.size"
                  font_weight: "typography.headings.h3.weight"
                  color: "colors.neutral.900"
                dark_mode:
                  color: "dark_mode.colors.text.primary"
              - type: "Text"
                props:
                  content: "{{message_flow.total_messages}} total messages"
                style:
                  font_size: "typography.scale.sm.size"
                  color: "colors.neutral.500"
          - type: "flow_diagram"
            id: "agent_flow_mini"
            props:
              data_source: "message_flow"
              node_type: "agent"
              edge_type: "message_count"
              layout: "horizontal"
              interactive: false
            style:
              height: "140px"
              node_bg: "colors.primary.50"
              node_border: "borders.width.thin solid colors.primary.200"
              node_border_radius: "borders.radius.lg"
              node_text_color: "colors.primary.700"
              node_font_size: "typography.scale.xs.size"
              node_font_weight: "typography.weights.semibold"
              edge_color: "colors.neutral.300"
              edge_label_bg: "colors.neutral.white"
              edge_label_color: "colors.neutral.600"
              edge_label_font_size: "typography.scale.xs.size"
              edge_label_font_family: "typography.font_families.monospace.css"
            dark_mode:
              node_bg: "dark_mode.colors.primary.50"
              node_border: "borders.width.thin solid dark_mode.colors.primary.200"
              node_text_color: "dark_mode.colors.primary.500"
              edge_color: "dark_mode.colors.border.strong"
              edge_label_bg: "dark_mode.colors.bg.raised"
              edge_label_color: "dark_mode.colors.text.secondary"

      # Filter Bar + Timeline Card
      - type: "card"
        id: "messages_card"
        style:
          background: "components.card.variants.default.bg"
          border: "components.card.variants.default.border"
          border_radius: "components.card.variants.default.border_radius"
          shadow: "components.card.variants.default.shadow"
          padding: "0"
        dark_mode:
          background: "dark_mode.components.card.bg"
          border: "dark_mode.components.card.border"
        children:
          # Filter Bar
          - type: "HStack"
            id: "message_filters"
            style:
              padding: "spacing.4"
              gap: "spacing.3"
              border_bottom: "borders.width.thin solid colors.neutral.200"
              flex_wrap: "wrap"
              align_items: "flex-end"
            dark_mode:
              border_bottom: "borders.width.thin solid dark_mode.colors.border.default"
            children:
              - type: "select"
                id: "from_agent_filter"
                props:
                  label: "From Agent"
                  placeholder: "Any agent"
                  options_from: "agents_list"
                  option_label: "{{item.name}}"
                  option_value: "{{item.id}}"
                  clearable: true
                style:
                  min_width: "160px"
                  background: "components.input.default.bg"
                  border: "components.input.default.border"
                  border_radius: "components.input.default.border_radius"
                  font_size: "components.input.default.font_size"
                  height: "components.input.default.height"
                dark_mode:
                  background: "dark_mode.components.input.bg"
                  border: "dark_mode.components.input.border"
                  color: "dark_mode.components.input.text_color"
              - type: "select"
                id: "to_agent_filter"
                props:
                  label: "To Agent"
                  placeholder: "Any agent"
                  options_from: "agents_list"
                  option_label: "{{item.name}}"
                  option_value: "{{item.id}}"
                  clearable: true
                style:
                  min_width: "160px"
              - type: "select"
                id: "type_filter"
                props:
                  label: "Message Type"
                  placeholder: "All types"
                  multi_select: true
                  options:
                    - label: "Direct"
                      value: "direct"
                    - label: "Broadcast"
                      value: "broadcast"
                    - label: "Request"
                      value: "request"
                    - label: "Response"
                      value: "response"
                style:
                  min_width: "160px"
              - type: "select"
                id: "status_filter"
                props:
                  label: "Status"
                  placeholder: "All statuses"
                  options:
                    - label: "Delivered"
                      value: "delivered"
                    - label: "Pending"
                      value: "pending"
                    - label: "Failed"
                      value: "failed"
                style:
                  min_width: "130px"
              - type: "form_field"
                id: "date_range_filter"
                props:
                  type: "date_range"
                  placeholder: "Date range..."
                style:
                  min_width: "220px"
              - type: "form_field"
                id: "search_input"
                props:
                  type: "search"
                  placeholder: "Search messages..."
                  icon_left: "Search"
                style:
                  flex: "1"
                  min_width: "200px"
                  background: "components.input.default.bg"
                  border: "components.input.default.border"
                  border_radius: "components.input.default.border_radius"
                  font_size: "components.input.default.font_size"
                  height: "components.input.default.height"
                  padding_left: "spacing.10"
                dark_mode:
                  background: "dark_mode.components.input.bg"
                  border: "dark_mode.components.input.border"

          # Message Timeline
          - type: "VStack"
            id: "message_timeline"
            props:
              data_source: "messages"
              empty_state:
                icon: "MessageSquare"
                title: "No messages found"
                description: "Adjust your filters or wait for agents to exchange messages."
            style:
              padding: "0"
            item_template:
              type: "HStack"
              id: "message_row_{{item.id}}"
              style:
                gap: "spacing.4"
                padding: "spacing.4 spacing.6"
                border_bottom: "borders.width.thin solid colors.neutral.100"
                align_items: "flex-start"
                cursor: "pointer"
                transition: "animations.presets.colors"
              states:
                hover:
                  background: "colors.neutral.50"
              dark_mode:
                border_bottom: "borders.width.thin solid dark_mode.colors.border.muted"
                states:
                  hover:
                    background: "dark_mode.colors.bg.muted"
              actions:
                - event: "click"
                  handler: "open_drawer:message_detail_drawer:{{item.id}}"
              children:
                # Timestamp Column
                - type: "Text"
                  props:
                    content: "{{item.timestamp | time:'HH:mm:ss'}}"
                  style:
                    font_family: "typography.font_families.monospace.css"
                    font_size: "typography.scale.xs.size"
                    color: "colors.neutral.400"
                    width: "70px"
                    flex_shrink: "0"
                    padding_top: "spacing.0.5"

                # Agent Avatars (from -> to)
                - type: "HStack"
                  style:
                    gap: "spacing.2"
                    align_items: "center"
                    width: "140px"
                    flex_shrink: "0"
                  children:
                    - type: "avatar"
                      props:
                        name: "{{item.from_agent_name}}"
                        size: "28px"
                      style:
                        border_radius: "borders.radius.full"
                        border: "borders.width.medium solid colors.primary.200"
                    - type: "icon"
                      props:
                        name: "ArrowRight"
                      style:
                        size: "14px"
                        color: "colors.neutral.400"
                    - type: "avatar"
                      props:
                        name: "{{item.to_agent_name}}"
                        size: "28px"
                      style:
                        border_radius: "borders.radius.full"
                        border: "borders.width.medium solid colors.secondary.200"

                # Message Type Badge
                - type: "badge"
                  props:
                    content: "{{item.type}}"
                    variant: "{{item.type === 'direct' ? 'primary' : item.type === 'broadcast' ? 'info' : item.type === 'request' ? 'warning' : 'success'}}"
                  style:
                    width: "80px"
                    flex_shrink: "0"
                    text_align: "center"
                    font_size: "components.badge.sizes.sm.font_size"
                    padding_x: "components.badge.sizes.sm.padding_x"
                    padding_y: "components.badge.sizes.sm.padding_y"
                    border_radius: "components.badge.sizes.sm.border_radius"
                    font_weight: "components.badge.sizes.sm.font_weight"

                # Message Preview
                - type: "VStack"
                  style:
                    gap: "spacing.0.5"
                    flex: "1"
                    min_width: "0"
                  children:
                    - type: "Text"
                      props:
                        content: "{{item.from_agent_name}} -> {{item.to_agent_name}}"
                      style:
                        font_size: "typography.scale.xs.size"
                        font_weight: "typography.weights.medium"
                        color: "colors.neutral.600"
                    - type: "Text"
                      props:
                        content: "{{item.payload_preview | truncate:120}}"
                      style:
                        font_size: "typography.scale.sm.size"
                        color: "colors.neutral.700"
                        overflow: "hidden"
                        text_overflow: "ellipsis"
                        white_space: "nowrap"

                # Expand icon
                - type: "icon"
                  props:
                    name: "ChevronRight"
                  style:
                    size: "16px"
                    color: "colors.neutral.400"
                    flex_shrink: "0"
                    margin_top: "spacing.1"

          # Pagination Bar
          - type: "HStack"
            id: "pagination_bar"
            style:
              justify_content: "space-between"
              align_items: "center"
              padding: "spacing.3 spacing.6"
              border_top: "borders.width.thin solid colors.neutral.200"
            dark_mode:
              border_top: "borders.width.thin solid dark_mode.colors.border.default"
            children:
              - type: "Text"
                props:
                  content: "Showing {{messages.from}}-{{messages.to}} of {{messages.total}}"
                style:
                  font_size: "typography.scale.sm.size"
                  color: "colors.neutral.500"
              - type: "pagination"
                props:
                  current_page: "{{pagination.page}}"
                  total_pages: "{{messages.total_pages}}"
                  page_size: 50
                style:
                  button_size: "components.button.sizes.sm.height"
                  button_border_radius: "components.button.sizes.sm.border_radius"
                  active_bg: "colors.primary.500"
                  active_color: "colors.neutral.white"
                  inactive_bg: "transparent"
                  inactive_color: "colors.neutral.600"

    # Message Detail Drawer (right slide-in)
    drawers:
      - type: "drawer"
        id: "message_detail_drawer"
        props:
          title: "Message Detail"
          position: "right"
          width: "480px"
        style:
          background: "colors.neutral.white"
          border_left: "borders.width.thin solid colors.neutral.200"
          shadow: "shadows.xl"
          z_index: "z_index.modal"
          transition: "transform 300ms cubic-bezier(0.4, 0, 0.2, 1)"
        dark_mode:
          background: "dark_mode.colors.bg.overlay"
          border_left: "borders.width.thin solid dark_mode.colors.border.default"
        children:
          # Drawer Header
          - type: "HStack"
            style:
              justify_content: "space-between"
              align_items: "center"
              padding: "spacing.4 spacing.5"
              border_bottom: "borders.width.thin solid colors.neutral.200"
            dark_mode:
              border_bottom: "borders.width.thin solid dark_mode.colors.border.default"
            children:
              - type: "Text"
                props:
                  content: "Message Detail"
                style:
                  font_size: "typography.headings.h3.size"
                  font_weight: "typography.headings.h3.weight"
                  color: "colors.neutral.900"
                dark_mode:
                  color: "dark_mode.colors.text.primary"
              - type: "Button"
                props:
                  variant: "ghost"
                  size: "sm"
                  icon_left: "X"
                  aria_label: "Close drawer"
                actions:
                  - event: "click"
                    handler: "close_drawer:message_detail_drawer"

          # Drawer Body
          - type: "VStack"
            style:
              padding: "spacing.5"
              gap: "spacing.5"
              overflow_y: "auto"
              flex: "1"
            children:
              # Metadata Section
              - type: "VStack"
                style:
                  gap: "spacing.3"
                children:
                  - type: "Text"
                    props:
                      content: "Metadata"
                    style:
                      font_size: "typography.headings.h5.size"
                      font_weight: "typography.headings.h5.weight"
                      color: "colors.neutral.800"
                      margin_bottom: "spacing.1"
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                    children:
                      - type: "Text"
                        props:
                          content: "Message ID"
                        style:
                          font_size: "typography.scale.sm.size"
                          color: "colors.neutral.500"
                      - type: "Text"
                        props:
                          content: "{{selected_message.id}}"
                        style:
                          font_size: "typography.scale.sm.size"
                          font_family: "typography.font_families.monospace.css"
                          color: "colors.neutral.700"
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                    children:
                      - type: "Text"
                        props:
                          content: "Timestamp"
                        style:
                          font_size: "typography.scale.sm.size"
                          color: "colors.neutral.500"
                      - type: "Text"
                        props:
                          content: "{{selected_message.timestamp | datetime:'full'}}"
                        style:
                          font_size: "typography.scale.sm.size"
                          font_family: "typography.font_families.monospace.css"
                          color: "colors.neutral.700"
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                    children:
                      - type: "Text"
                        props:
                          content: "Type"
                        style:
                          font_size: "typography.scale.sm.size"
                          color: "colors.neutral.500"
                      - type: "badge"
                        props:
                          content: "{{selected_message.type}}"
                          variant: "{{selected_message.type === 'direct' ? 'primary' : selected_message.type === 'broadcast' ? 'info' : selected_message.type === 'request' ? 'warning' : 'success'}}"
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                    children:
                      - type: "Text"
                        props:
                          content: "From"
                        style:
                          font_size: "typography.scale.sm.size"
                          color: "colors.neutral.500"
                      - type: "HStack"
                        style:
                          gap: "spacing.2"
                          align_items: "center"
                        children:
                          - type: "avatar"
                            props:
                              name: "{{selected_message.from_agent_name}}"
                              size: "20px"
                          - type: "Text"
                            props:
                              content: "{{selected_message.from_agent_name}}"
                            style:
                              font_size: "typography.scale.sm.size"
                              color: "colors.neutral.900"
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                    children:
                      - type: "Text"
                        props:
                          content: "To"
                        style:
                          font_size: "typography.scale.sm.size"
                          color: "colors.neutral.500"
                      - type: "HStack"
                        style:
                          gap: "spacing.2"
                          align_items: "center"
                        children:
                          - type: "avatar"
                            props:
                              name: "{{selected_message.to_agent_name}}"
                              size: "20px"
                          - type: "Text"
                            props:
                              content: "{{selected_message.to_agent_name}}"
                            style:
                              font_size: "typography.scale.sm.size"
                              color: "colors.neutral.900"
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                    children:
                      - type: "Text"
                        props:
                          content: "Status"
                        style:
                          font_size: "typography.scale.sm.size"
                          color: "colors.neutral.500"
                      - type: "badge"
                        props:
                          content: "{{selected_message.status}}"
                          variant: "{{selected_message.status === 'delivered' ? 'success' : selected_message.status === 'pending' ? 'warning' : 'error'}}"

              # Payload Section
              - type: "Divider"
                style:
                  border_top: "borders.width.thin solid colors.neutral.200"
              - type: "VStack"
                style:
                  gap: "spacing.2"
                children:
                  - type: "HStack"
                    style:
                      justify_content: "space-between"
                      align_items: "center"
                    children:
                      - type: "Text"
                        props:
                          content: "Payload"
                        style:
                          font_size: "typography.headings.h5.size"
                          font_weight: "typography.headings.h5.weight"
                          color: "colors.neutral.800"
                      - type: "Button"
                        props:
                          content: "Copy"
                          variant: "ghost"
                          size: "xs"
                          icon_left: "Copy"
                        style:
                          color: "colors.neutral.500"
                          font_size: "typography.scale.xs.size"
                        actions:
                          - event: "click"
                            handler: "clipboard:copy:{{selected_message.payload | json}}"
                  - type: "code_editor"
                    id: "payload_viewer"
                    props:
                      language: "json"
                      value: "{{selected_message.payload | json:pretty}}"
                      read_only: true
                      line_numbers: true
                    style:
                      font_family: "typography.font_families.monospace.css"
                      font_size: "typography.scale.xs.size"
                      border: "borders.width.thin solid colors.neutral.200"
                      border_radius: "borders.radius.md"
                      min_height: "200px"
                      max_height: "400px"
                      overflow: "auto"
                      background: "colors.neutral.50"
                    dark_mode:
                      border: "borders.width.thin solid dark_mode.colors.border.default"
                      background: "dark_mode.colors.bg.base"

              # Related Messages Section
              - type: "Divider"
                style:
                  border_top: "borders.width.thin solid colors.neutral.200"
              - type: "VStack"
                id: "related_messages"
                props:
                  visible_when: "selected_message.related_messages.length > 0"
                style:
                  gap: "spacing.2"
                children:
                  - type: "Text"
                    props:
                      content: "Related Messages"
                    style:
                      font_size: "typography.headings.h5.size"
                      font_weight: "typography.headings.h5.weight"
                      color: "colors.neutral.800"
                      margin_bottom: "spacing.1"
                  - type: "VStack"
                    props:
                      for_each: "selected_message.related_messages"
                    style:
                      gap: "spacing.2"
                    children:
                      - type: "HStack"
                        style:
                          gap: "spacing.3"
                          padding: "spacing.2 spacing.3"
                          border_radius: "borders.radius.md"
                          background: "colors.neutral.50"
                          cursor: "pointer"
                          transition: "animations.presets.colors"
                        states:
                          hover:
                            background: "colors.neutral.100"
                        dark_mode:
                          background: "dark_mode.colors.bg.muted"
                          states:
                            hover:
                              background: "dark_mode.colors.bg.subtle"
                        actions:
                          - event: "click"
                            handler: "open_drawer:message_detail_drawer:{{item.id}}"
                        children:
                          - type: "Text"
                            props:
                              content: "{{item.timestamp | time:'HH:mm:ss'}}"
                            style:
                              font_family: "typography.font_families.monospace.css"
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.400"
                              width: "60px"
                          - type: "badge"
                            props:
                              content: "{{item.type}}"
                              variant: "outline"
                            style:
                              font_size: "typography.scale.xs.size"
                          - type: "Text"
                            props:
                              content: "{{item.from_agent_name}} -> {{item.to_agent_name}}"
                            style:
                              font_size: "typography.scale.xs.size"
                              color: "colors.neutral.600"
                              flex: "1"

    actions:
      - event: "filter:change"
        target: "message_filters"
        handler: "refresh:messages"
      - event: "search:change"
        target: "search_input"
        debounce: "300ms"
        handler: "set_param:search:{{value}}"
      - event: "page:change"
        target: "pagination_bar"
        handler: "set_param:page:{{value}}"
